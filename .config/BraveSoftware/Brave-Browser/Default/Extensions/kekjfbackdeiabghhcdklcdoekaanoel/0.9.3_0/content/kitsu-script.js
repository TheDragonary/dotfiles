/*! For license information please see kitsu-script.js.LICENSE.txt */
(()=>{var t={72176:(t,e,n)=>{"use strict";function i(){return!("undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&__SENTRY_BROWSER_BUNDLE__)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function r(t,e){return t.require(e)}n.d(e,{l$:()=>r,KV:()=>i}),t=n.hmd(t)},21170:(t,e,n)=>{"use strict";n.d(e,{ph:()=>u,yW:()=>c});var i=n(72176),r=n(71235);t=n.hmd(t);const s=(0,r.Rf)(),a={nowSeconds:()=>Date.now()/1e3},o=(0,i.KV)()?function(){try{return(0,i.l$)(t,"perf_hooks").performance}catch(t){return}}():function(){const{performance:t}=s;if(t&&t.now)return{now:()=>t.now(),timeOrigin:Date.now()-t.now()}}(),l=void 0===o?a:{nowSeconds:()=>(o.timeOrigin+o.now())/1e3},c=a.nowSeconds.bind(a),u=l.nowSeconds.bind(l);let h;(()=>{const{performance:t}=s;if(!t||!t.now)return void(h="none");const e=36e5,n=t.now(),i=Date.now(),r=t.timeOrigin?Math.abs(t.timeOrigin+n-i):e,a=r<e,o=t.timing&&t.timing.navigationStart,l="number"==typeof o?Math.abs(o+n-i):e;a||l<e?r<=l?(h="timeOrigin",t.timeOrigin):h="navigationStart":h="dateNow"})()},71235:(t,e,n)=>{"use strict";function i(t){return t&&t.Math==Math?t:void 0}n.d(e,{Rf:()=>s,YO:()=>a,n2:()=>r});const r="object"==typeof globalThis&&i(globalThis)||"object"==typeof window&&i(window)||"object"==typeof self&&i(self)||"object"==typeof n.g&&i(n.g)||function(){return this}()||{};function s(){return r}function a(t,e,n){const i=n||r,s=i.__SENTRY__=i.__SENTRY__||{};return s[t]||(s[t]=e())}},2262:(t,e,n)=>{"use strict";n.d(e,{iH:()=>ht,qj:()=>nt});var i=n(3577);const r=t=>{const e=new Set(t);return e.w=0,e.n=0,e},s=t=>(t.w&c)>0,a=t=>(t.n&c)>0,o=new WeakMap;let l=0,c=1;const u=30;let h;const d=Symbol(""),p=Symbol("");let m=!0;const f=[];function g(t,e,n){if(m&&h){let e=o.get(t);e||o.set(t,e=new Map);let i=e.get(n);i||e.set(n,i=r()),_(i)}}function _(t,e){let n=!1;l<=u?a(t)||(t.n|=c,n=!s(t)):n=!t.has(h),n&&(t.add(h),h.deps.push(t))}function y(t,e,n,s,a,l){const c=o.get(t);if(!c)return;let u=[];if("clear"===e)u=[...c.values()];else if("length"===n&&(0,i.kJ)(t)){const t=Number(s);c.forEach(((e,n)=>{("length"===n||n>=t)&&u.push(e)}))}else switch(void 0!==n&&u.push(c.get(n)),e){case"add":(0,i.kJ)(t)?(0,i.S0)(n)&&u.push(c.get("length")):(u.push(c.get(d)),(0,i._N)(t)&&u.push(c.get(p)));break;case"delete":(0,i.kJ)(t)||(u.push(c.get(d)),(0,i._N)(t)&&u.push(c.get(p)));break;case"set":(0,i._N)(t)&&u.push(c.get(d))}if(1===u.length)u[0]&&v(u[0]);else{const t=[];for(const e of u)e&&t.push(...e);v(r(t))}}function v(t,e){const n=(0,i.kJ)(t)?t:[...t];for(const t of n)t.computed&&b(t);for(const t of n)t.computed||b(t)}function b(t,e){(t!==h||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const w=(0,i.fY)("__proto__,__v_isRef,__isVue"),E=new Set(Object.getOwnPropertyNames(Symbol).filter((t=>"arguments"!==t&&"caller"!==t)).map((t=>Symbol[t])).filter(i.yk)),S=N(),x=N(!0),k=T();function T(){const t={};return["includes","indexOf","lastIndexOf"].forEach((e=>{t[e]=function(...t){const n=ot(this);for(let t=0,e=this.length;t<e;t++)g(n,0,t+"");const i=n[e](...t);return-1===i||!1===i?n[e](...t.map(ot)):i}})),["push","pop","shift","unshift","splice"].forEach((e=>{t[e]=function(...t){f.push(m),m=!1;const n=ot(this)[e].apply(this,t);return function(){const t=f.pop();m=void 0===t||t}(),n}})),t}function $(t){const e=ot(this);return g(e,0,t),e.hasOwnProperty(t)}function N(t=!1,e=!1){return function(n,r,s){if("__v_isReactive"===r)return!t;if("__v_isReadonly"===r)return t;if("__v_isShallow"===r)return e;if("__v_raw"===r&&s===(t?e?et:tt:e?Q:Z).get(n))return n;const a=(0,i.kJ)(n);if(!t){if(a&&(0,i.RI)(k,r))return Reflect.get(k,r,s);if("hasOwnProperty"===r)return $}const o=Reflect.get(n,r,s);return((0,i.yk)(r)?E.has(r):w(r))?o:(t||g(n,0,r),e?o:ut(o)?a&&(0,i.S0)(r)?o:o.value:(0,i.Kn)(o)?t?it(o):nt(o):o)}}function I(t=!1){return function(e,n,r,s){let a=e[n];if(st(a)&&ut(a)&&!ut(r))return!1;if(!t&&(at(r)||st(r)||(a=ot(a),r=ot(r)),!(0,i.kJ)(e)&&ut(a)&&!ut(r)))return a.value=r,!0;const o=(0,i.kJ)(e)&&(0,i.S0)(n)?Number(n)<e.length:(0,i.RI)(e,n),l=Reflect.set(e,n,r,s);return e===ot(s)&&(o?(0,i.aU)(r,a)&&y(e,"set",n,r):y(e,"add",n,r)),l}}const R={get:S,set:I(),deleteProperty:function(t,e){const n=(0,i.RI)(t,e),r=(t[e],Reflect.deleteProperty(t,e));return r&&n&&y(t,"delete",e,void 0),r},has:function(t,e){const n=Reflect.has(t,e);return(0,i.yk)(e)&&E.has(e)||g(t,0,e),n},ownKeys:function(t){return g(t,0,(0,i.kJ)(t)?"length":d),Reflect.ownKeys(t)}},A={get:x,set:(t,e)=>!0,deleteProperty:(t,e)=>!0},C=t=>t,P=t=>Reflect.getPrototypeOf(t);function O(t,e,n=!1,i=!1){const r=ot(t=t.__v_raw),s=ot(e);n||(e!==s&&g(r,0,e),g(r,0,s));const{has:a}=P(r),o=i?C:n?ct:lt;return a.call(r,e)?o(t.get(e)):a.call(r,s)?o(t.get(s)):void(t!==r&&t.get(e))}function L(t,e=!1){const n=this.__v_raw,i=ot(n),r=ot(t);return e||(t!==r&&g(i,0,t),g(i,0,r)),t===r?n.has(t):n.has(t)||n.has(r)}function D(t,e=!1){return t=t.__v_raw,!e&&g(ot(t),0,d),Reflect.get(t,"size",t)}function U(t){t=ot(t);const e=ot(this);return P(e).has.call(e,t)||(e.add(t),y(e,"add",t,t)),this}function M(t,e){e=ot(e);const n=ot(this),{has:r,get:s}=P(n);let a=r.call(n,t);a||(t=ot(t),a=r.call(n,t));const o=s.call(n,t);return n.set(t,e),a?(0,i.aU)(e,o)&&y(n,"set",t,e):y(n,"add",t,e),this}function j(t){const e=ot(this),{has:n,get:i}=P(e);let r=n.call(e,t);r||(t=ot(t),r=n.call(e,t)),i&&i.call(e,t);const s=e.delete(t);return r&&y(e,"delete",t,void 0),s}function B(){const t=ot(this),e=0!==t.size,n=t.clear();return e&&y(t,"clear",void 0,void 0),n}function G(t,e){return function(n,i){const r=this,s=r.__v_raw,a=ot(s),o=e?C:t?ct:lt;return!t&&g(a,0,d),s.forEach(((t,e)=>n.call(i,o(t),o(e),r)))}}function F(t,e,n){return function(...r){const s=this.__v_raw,a=ot(s),o=(0,i._N)(a),l="entries"===t||t===Symbol.iterator&&o,c="keys"===t&&o,u=s[t](...r),h=n?C:e?ct:lt;return!e&&g(a,0,c?p:d),{next(){const{value:t,done:e}=u.next();return e?{value:t,done:e}:{value:l?[h(t[0]),h(t[1])]:h(t),done:e}},[Symbol.iterator](){return this}}}}function Y(t){return function(...e){return"delete"!==t&&this}}function W(){const t={get(t){return O(this,t)},get size(){return D(this)},has:L,add:U,set:M,delete:j,clear:B,forEach:G(!1,!1)},e={get(t){return O(this,t,!1,!0)},get size(){return D(this)},has:L,add:U,set:M,delete:j,clear:B,forEach:G(!1,!0)},n={get(t){return O(this,t,!0)},get size(){return D(this,!0)},has(t){return L.call(this,t,!0)},add:Y("add"),set:Y("set"),delete:Y("delete"),clear:Y("clear"),forEach:G(!0,!1)},i={get(t){return O(this,t,!0,!0)},get size(){return D(this,!0)},has(t){return L.call(this,t,!0)},add:Y("add"),set:Y("set"),delete:Y("delete"),clear:Y("clear"),forEach:G(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((r=>{t[r]=F(r,!1,!1),n[r]=F(r,!0,!1),e[r]=F(r,!1,!0),i[r]=F(r,!0,!0)})),[t,n,e,i]}const[q,H,z,K]=W();function V(t,e){const n=e?t?K:z:t?H:q;return(e,r,s)=>"__v_isReactive"===r?!t:"__v_isReadonly"===r?t:"__v_raw"===r?e:Reflect.get((0,i.RI)(n,r)&&r in e?n:e,r,s)}const J={get:V(!1,!1)},X={get:V(!0,!1)},Z=new WeakMap,Q=new WeakMap,tt=new WeakMap,et=new WeakMap;function nt(t){return st(t)?t:rt(t,!1,R,J,Z)}function it(t){return rt(t,!0,A,X,tt)}function rt(t,e,n,r,s){if(!(0,i.Kn)(t))return t;if(t.__v_raw&&(!e||!t.__v_isReactive))return t;const a=s.get(t);if(a)return a;const o=function(t){return t.__v_skip||!Object.isExtensible(t)?0:function(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((0,i.W7)(t))}(t);if(0===o)return t;const l=new Proxy(t,2===o?r:n);return s.set(t,l),l}function st(t){return!(!t||!t.__v_isReadonly)}function at(t){return!(!t||!t.__v_isShallow)}function ot(t){const e=t&&t.__v_raw;return e?ot(e):t}const lt=t=>(0,i.Kn)(t)?nt(t):t,ct=t=>(0,i.Kn)(t)?it(t):t;function ut(t){return!(!t||!0!==t.__v_isRef)}function ht(t){return n=!1,ut(e=t)?e:new dt(e,n);var e,n}class dt{constructor(t,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?t:ot(t),this._value=e?t:lt(t)}get value(){return function(t){m&&h&&_((t=ot(t)).dep||(t.dep=r()))}(this),this._value}set value(t){const e=this.__v_isShallow||at(t)||st(t);t=e?t:ot(t),(0,i.aU)(t,this._rawValue)&&(this._rawValue=t,this._value=e?t:lt(t),function(t,e){const n=(t=ot(t)).dep;n&&v(n)}(this))}}},3577:(t,e,n)=>{"use strict";function i(t,e){const n=Object.create(null),i=t.split(",");for(let t=0;t<i.length;t++)n[i[t]]=!0;return e?t=>!!n[t.toLowerCase()]:t=>!!n[t]}n.d(e,{Kn:()=>u,RI:()=>a,S0:()=>m,W7:()=>p,_N:()=>l,aU:()=>v,fY:()=>i,kJ:()=>o,l7:()=>r,yk:()=>c});const r=Object.assign,s=Object.prototype.hasOwnProperty,a=(t,e)=>s.call(t,e),o=Array.isArray,l=t=>"[object Map]"===d(t),c=t=>"symbol"==typeof t,u=t=>null!==t&&"object"==typeof t,h=Object.prototype.toString,d=t=>h.call(t),p=t=>d(t).slice(8,-1),m=t=>"string"==typeof t&&"NaN"!==t&&"-"!==t[0]&&""+parseInt(t,10)===t,f=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},g=/-(\w)/g,_=(f((t=>t.replace(g,((t,e)=>e?e.toUpperCase():"")))),/\B([A-Z])/g),y=(f((t=>t.replace(_,"-$1").toLowerCase())),f((t=>t.charAt(0).toUpperCase()+t.slice(1)))),v=(f((t=>t?`on${y(t)}`:"")),(t,e)=>!Object.is(t,e))},77414:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>o});var i=n(87537),r=n.n(i),s=n(23645),a=n.n(s)()(r());a.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const o=a},23645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(i)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(a[l]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);i&&a[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},87537:t=>{"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),s="/*# ".concat(r," */");return[e].concat([s]).join("\n")}return[e].join("\n")}},27856:function(t){t.exports=function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,n){return e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e(t,n)}function n(t,i,r){return n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct:function(t,n,i){var r=[null];r.push.apply(r,n);var s=new(Function.bind.apply(t,r));return i&&e(s,i.prototype),s},n.apply(null,arguments)}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s=[],a=!0,o=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(s.push(i.value),!e||s.length!==e);a=!0);}catch(t){o=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(o)throw r}}return s}}(t,e)||s(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var o=Object.entries,l=Object.setPrototypeOf,c=Object.isFrozen,u=Object.getPrototypeOf,h=Object.getOwnPropertyDescriptor,d=Object.freeze,p=Object.seal,m=Object.create,f="undefined"!=typeof Reflect&&Reflect,g=f.apply,_=f.construct;g||(g=function(t,e,n){return t.apply(e,n)}),d||(d=function(t){return t}),p||(p=function(t){return t}),_||(_=function(t,e){return n(t,r(e))});var y,v=R(Array.prototype.forEach),b=R(Array.prototype.pop),w=R(Array.prototype.push),E=R(String.prototype.toLowerCase),S=R(String.prototype.toString),x=R(String.prototype.match),k=R(String.prototype.replace),T=R(String.prototype.indexOf),$=R(String.prototype.trim),N=R(RegExp.prototype.test),I=(y=TypeError,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return _(y,e)});function R(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return g(t,e,i)}}function A(t,e,n){n=n||E,l&&l(t,null);for(var i=e.length;i--;){var r=e[i];if("string"==typeof r){var s=n(r);s!==r&&(c(e)||(e[i]=s),r=s)}t[r]=!0}return t}function C(t){var e,n=m(null),r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=s(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}(o(t));try{for(r.s();!(e=r.n()).done;){var a=i(e.value,2),l=a[0],c=a[1];n[l]=c}}catch(t){r.e(t)}finally{r.f()}return n}function P(t,e){for(;null!==t;){var n=h(t,e);if(n){if(n.get)return R(n.get);if("function"==typeof n.value)return R(n.value)}t=u(t)}return function(t){return console.warn("fallback value for",t),null}}var O=d(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),L=d(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),D=d(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),U=d(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),M=d(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),j=d(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),B=d(["#text"]),G=d(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),F=d(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Y=d(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),W=d(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),q=p(/\{\{[\w\W]*|[\w\W]*\}\}/gm),H=p(/<%[\w\W]*|[\w\W]*%>/gm),z=p(/\${[\w\W]*}/gm),K=p(/^data-[\-\w.\u00B7-\uFFFF]/),V=p(/^aria-[\-\w]+$/),J=p(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),X=p(/^(?:\w+script|data):/i),Z=p(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Q=p(/^html$/i),tt=function(){return"undefined"==typeof window?null:window},et=function(e,n){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var i=null,r="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(r)&&(i=n.currentScript.getAttribute(r));var s="dompurify"+(i?"#"+i:"");try{return e.createPolicy(s,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+s+" could not be created."),null}};return function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt(),i=function(t){return e(t)};if(i.version="3.0.1",i.removed=[],!n||!n.document||9!==n.document.nodeType)return i.isSupported=!1,i;var s=n.document,a=n.document,l=n.DocumentFragment,c=n.HTMLTemplateElement,u=n.Node,h=n.Element,p=n.NodeFilter,m=n.NamedNodeMap,f=void 0===m?n.NamedNodeMap||n.MozNamedAttrMap:m,g=n.HTMLFormElement,_=n.DOMParser,y=n.trustedTypes,R=h.prototype,nt=P(R,"cloneNode"),it=P(R,"nextSibling"),rt=P(R,"childNodes"),st=P(R,"parentNode");if("function"==typeof c){var at=a.createElement("template");at.content&&at.content.ownerDocument&&(a=at.content.ownerDocument)}var ot=et(y,s),lt=ot?ot.createHTML(""):"",ct=a,ut=ct.implementation,ht=ct.createNodeIterator,dt=ct.createDocumentFragment,pt=ct.getElementsByTagName,mt=s.importNode,ft={};i.isSupported="function"==typeof o&&"function"==typeof st&&ut&&void 0!==ut.createHTMLDocument;var gt,_t,yt=q,vt=H,bt=z,wt=K,Et=V,St=X,xt=Z,kt=J,Tt=null,$t=A({},[].concat(r(O),r(L),r(D),r(M),r(B))),Nt=null,It=A({},[].concat(r(G),r(F),r(Y),r(W))),Rt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),At=null,Ct=null,Pt=!0,Ot=!0,Lt=!1,Dt=!0,Ut=!1,Mt=!1,jt=!1,Bt=!1,Gt=!1,Ft=!1,Yt=!1,Wt=!0,qt=!1,Ht=!0,zt=!1,Kt={},Vt=null,Jt=A({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Xt=null,Zt=A({},["audio","video","img","source","image","track"]),Qt=null,te=A({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ee="http://www.w3.org/1998/Math/MathML",ne="http://www.w3.org/2000/svg",ie="http://www.w3.org/1999/xhtml",re=ie,se=!1,ae=null,oe=A({},[ee,ne,ie],S),le=["application/xhtml+xml","text/html"],ce=null,ue=a.createElement("form"),he=function(t){return t instanceof RegExp||t instanceof Function},de=function(e){ce&&ce===e||(e&&"object"===t(e)||(e={}),e=C(e),gt=gt=-1===le.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,_t="application/xhtml+xml"===gt?S:E,Tt="ALLOWED_TAGS"in e?A({},e.ALLOWED_TAGS,_t):$t,Nt="ALLOWED_ATTR"in e?A({},e.ALLOWED_ATTR,_t):It,ae="ALLOWED_NAMESPACES"in e?A({},e.ALLOWED_NAMESPACES,S):oe,Qt="ADD_URI_SAFE_ATTR"in e?A(C(te),e.ADD_URI_SAFE_ATTR,_t):te,Xt="ADD_DATA_URI_TAGS"in e?A(C(Zt),e.ADD_DATA_URI_TAGS,_t):Zt,Vt="FORBID_CONTENTS"in e?A({},e.FORBID_CONTENTS,_t):Jt,At="FORBID_TAGS"in e?A({},e.FORBID_TAGS,_t):{},Ct="FORBID_ATTR"in e?A({},e.FORBID_ATTR,_t):{},Kt="USE_PROFILES"in e&&e.USE_PROFILES,Pt=!1!==e.ALLOW_ARIA_ATTR,Ot=!1!==e.ALLOW_DATA_ATTR,Lt=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Dt=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ut=e.SAFE_FOR_TEMPLATES||!1,Mt=e.WHOLE_DOCUMENT||!1,Gt=e.RETURN_DOM||!1,Ft=e.RETURN_DOM_FRAGMENT||!1,Yt=e.RETURN_TRUSTED_TYPE||!1,Bt=e.FORCE_BODY||!1,Wt=!1!==e.SANITIZE_DOM,qt=e.SANITIZE_NAMED_PROPS||!1,Ht=!1!==e.KEEP_CONTENT,zt=e.IN_PLACE||!1,kt=e.ALLOWED_URI_REGEXP||kt,re=e.NAMESPACE||ie,Rt=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&he(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Rt.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&he(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Rt.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Rt.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ut&&(Ot=!1),Ft&&(Gt=!0),Kt&&(Tt=A({},r(B)),Nt=[],!0===Kt.html&&(A(Tt,O),A(Nt,G)),!0===Kt.svg&&(A(Tt,L),A(Nt,F),A(Nt,W)),!0===Kt.svgFilters&&(A(Tt,D),A(Nt,F),A(Nt,W)),!0===Kt.mathMl&&(A(Tt,M),A(Nt,Y),A(Nt,W))),e.ADD_TAGS&&(Tt===$t&&(Tt=C(Tt)),A(Tt,e.ADD_TAGS,_t)),e.ADD_ATTR&&(Nt===It&&(Nt=C(Nt)),A(Nt,e.ADD_ATTR,_t)),e.ADD_URI_SAFE_ATTR&&A(Qt,e.ADD_URI_SAFE_ATTR,_t),e.FORBID_CONTENTS&&(Vt===Jt&&(Vt=C(Vt)),A(Vt,e.FORBID_CONTENTS,_t)),Ht&&(Tt["#text"]=!0),Mt&&A(Tt,["html","head","body"]),Tt.table&&(A(Tt,["tbody"]),delete At.tbody),d&&d(e),ce=e)},pe=A({},["mi","mo","mn","ms","mtext"]),me=A({},["foreignobject","desc","title","annotation-xml"]),fe=A({},["title","style","font","a","script"]),ge=A({},L);A(ge,D),A(ge,U);var _e=A({},M);A(_e,j);var ye=function(t){w(i.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){t.remove()}},ve=function(t,e){try{w(i.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){w(i.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!Nt[t])if(Gt||Ft)try{ye(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},be=function(t){var e,n;if(Bt)t="<remove></remove>"+t;else{var i=x(t,/^[\r\n\t ]+/);n=i&&i[0]}"application/xhtml+xml"===gt&&re===ie&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var r=ot?ot.createHTML(t):t;if(re===ie)try{e=(new _).parseFromString(r,gt)}catch(t){}if(!e||!e.documentElement){e=ut.createDocument(re,"template",null);try{e.documentElement.innerHTML=se?lt:r}catch(t){}}var s=e.body||e.documentElement;return t&&n&&s.insertBefore(a.createTextNode(n),s.childNodes[0]||null),re===ie?pt.call(e,Mt?"html":"body")[0]:Mt?e.documentElement:s},we=function(t){return ht.call(t.ownerDocument||t,t,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT,null,!1)},Ee=function(e){return"object"===t(u)?e instanceof u:e&&"object"===t(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},Se=function(t,e,n){ft[t]&&v(ft[t],(function(t){t.call(i,e,n,ce)}))},xe=function(t){var e,n;if(Se("beforeSanitizeElements",t,null),(n=t)instanceof g&&("string"!=typeof n.nodeName||"string"!=typeof n.textContent||"function"!=typeof n.removeChild||!(n.attributes instanceof f)||"function"!=typeof n.removeAttribute||"function"!=typeof n.setAttribute||"string"!=typeof n.namespaceURI||"function"!=typeof n.insertBefore||"function"!=typeof n.hasChildNodes))return ye(t),!0;var r=_t(t.nodeName);if(Se("uponSanitizeElement",t,{tagName:r,allowedTags:Tt}),t.hasChildNodes()&&!Ee(t.firstElementChild)&&(!Ee(t.content)||!Ee(t.content.firstElementChild))&&N(/<[/\w]/g,t.innerHTML)&&N(/<[/\w]/g,t.textContent))return ye(t),!0;if(!Tt[r]||At[r]){if(!At[r]&&Te(r)){if(Rt.tagNameCheck instanceof RegExp&&N(Rt.tagNameCheck,r))return!1;if(Rt.tagNameCheck instanceof Function&&Rt.tagNameCheck(r))return!1}if(Ht&&!Vt[r]){var s=st(t)||t.parentNode,a=rt(t)||t.childNodes;if(a&&s)for(var o=a.length-1;o>=0;--o)s.insertBefore(nt(a[o],!0),it(t))}return ye(t),!0}return t instanceof h&&!function(t){var e=st(t);e&&e.tagName||(e={namespaceURI:re,tagName:"template"});var n=E(t.tagName),i=E(e.tagName);return!!ae[t.namespaceURI]&&(t.namespaceURI===ne?e.namespaceURI===ie?"svg"===n:e.namespaceURI===ee?"svg"===n&&("annotation-xml"===i||pe[i]):Boolean(ge[n]):t.namespaceURI===ee?e.namespaceURI===ie?"math"===n:e.namespaceURI===ne?"math"===n&&me[i]:Boolean(_e[n]):t.namespaceURI===ie?!(e.namespaceURI===ne&&!me[i])&&!(e.namespaceURI===ee&&!pe[i])&&!_e[n]&&(fe[n]||!ge[n]):!("application/xhtml+xml"!==gt||!ae[t.namespaceURI]))}(t)?(ye(t),!0):"noscript"!==r&&"noembed"!==r||!N(/<\/no(script|embed)/i,t.innerHTML)?(Ut&&3===t.nodeType&&(e=t.textContent,e=k(e,yt," "),e=k(e,vt," "),e=k(e,bt," "),t.textContent!==e&&(w(i.removed,{element:t.cloneNode()}),t.textContent=e)),Se("afterSanitizeElements",t,null),!1):(ye(t),!0)},ke=function(t,e,n){if(Wt&&("id"===e||"name"===e)&&(n in a||n in ue))return!1;if(Ot&&!Ct[e]&&N(wt,e));else if(Pt&&N(Et,e));else if(!Nt[e]||Ct[e]){if(!(Te(t)&&(Rt.tagNameCheck instanceof RegExp&&N(Rt.tagNameCheck,t)||Rt.tagNameCheck instanceof Function&&Rt.tagNameCheck(t))&&(Rt.attributeNameCheck instanceof RegExp&&N(Rt.attributeNameCheck,e)||Rt.attributeNameCheck instanceof Function&&Rt.attributeNameCheck(e))||"is"===e&&Rt.allowCustomizedBuiltInElements&&(Rt.tagNameCheck instanceof RegExp&&N(Rt.tagNameCheck,n)||Rt.tagNameCheck instanceof Function&&Rt.tagNameCheck(n))))return!1}else if(Qt[e]);else if(N(kt,k(n,xt,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==T(n,"data:")||!Xt[t])if(Lt&&!N(St,k(n,xt,"")));else if(n)return!1;return!0},Te=function(t){return t.indexOf("-")>0},$e=function(e){var n,r,s,a;Se("beforeSanitizeAttributes",e,null);var o=e.attributes;if(o){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Nt};for(a=o.length;a--;){var c=n=o[a],u=c.name,h=c.namespaceURI;if(r="value"===u?n.value:$(n.value),s=_t(u),l.attrName=s,l.attrValue=r,l.keepAttr=!0,l.forceKeepAttr=void 0,Se("uponSanitizeAttribute",e,l),r=l.attrValue,!l.forceKeepAttr&&(ve(u,e),l.keepAttr))if(Dt||!N(/\/>/i,r)){Ut&&(r=k(r,yt," "),r=k(r,vt," "),r=k(r,bt," "));var d=_t(e.nodeName);if(ke(d,s,r)){if(!qt||"id"!==s&&"name"!==s||(ve(u,e),r="user-content-"+r),ot&&"object"===t(y)&&"function"==typeof y.getAttributeType)if(h);else switch(y.getAttributeType(d,s)){case"TrustedHTML":r=ot.createHTML(r);break;case"TrustedScriptURL":r=ot.createScriptURL(r)}try{h?e.setAttributeNS(h,u,r):e.setAttribute(u,r),b(i.removed)}catch(t){}}}else ve(u,e)}Se("afterSanitizeAttributes",e,null)}},Ne=function t(e){var n,i=we(e);for(Se("beforeSanitizeShadowDOM",e,null);n=i.nextNode();)Se("uponSanitizeShadowNode",n,null),xe(n)||(n.content instanceof l&&t(n.content),$e(n));Se("afterSanitizeShadowDOM",e,null)};return i.sanitize=function(t){var e,n,r,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((se=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!Ee(t)){if("function"!=typeof t.toString)throw I("toString is not a function");if("string"!=typeof(t=t.toString()))throw I("dirty is not a string, aborting")}if(!i.isSupported)return t;if(jt||de(o),i.removed=[],"string"==typeof t&&(zt=!1),zt){if(t.nodeName){var c=_t(t.nodeName);if(!Tt[c]||At[c])throw I("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof u)1===(n=(e=be("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===n.nodeName||"HTML"===n.nodeName?e=n:e.appendChild(n);else{if(!Gt&&!Ut&&!Mt&&-1===t.indexOf("<"))return ot&&Yt?ot.createHTML(t):t;if(!(e=be(t)))return Gt?null:Yt?lt:""}e&&Bt&&ye(e.firstChild);for(var h=we(zt?t:e);r=h.nextNode();)xe(r)||(r.content instanceof l&&Ne(r.content),$e(r));if(zt)return t;if(Gt){if(Ft)for(a=dt.call(e.ownerDocument);e.firstChild;)a.appendChild(e.firstChild);else a=e;return(Nt.shadowroot||Nt.shadowrootmod)&&(a=mt.call(s,a,!0)),a}var d=Mt?e.outerHTML:e.innerHTML;return Mt&&Tt["!doctype"]&&e.ownerDocument&&e.ownerDocument.doctype&&e.ownerDocument.doctype.name&&N(Q,e.ownerDocument.doctype.name)&&(d="<!DOCTYPE "+e.ownerDocument.doctype.name+">\n"+d),Ut&&(d=k(d,yt," "),d=k(d,vt," "),d=k(d,bt," ")),ot&&Yt?ot.createHTML(d):d},i.setConfig=function(t){de(t),jt=!0},i.clearConfig=function(){ce=null,jt=!1},i.isValidAttribute=function(t,e,n){ce||de({});var i=_t(t),r=_t(e);return ke(i,r,n)},i.addHook=function(t,e){"function"==typeof e&&(ft[t]=ft[t]||[],w(ft[t],e))},i.removeHook=function(t){if(ft[t])return b(ft[t])},i.removeHooks=function(t){ft[t]&&(ft[t]=[])},i.removeAllHooks=function(){ft={}},i}()}()},56387:(t,e,n)=>{var i;!function(r){var s=Object.hasOwnProperty,a=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o="object"==typeof process&&"function"==typeof process.nextTick,l="function"==typeof Symbol,c="object"==typeof Reflect,u="function"==typeof setImmediate?setImmediate:setTimeout,h=l?c&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(t){var e=Object.getOwnPropertyNames(t);return e.push.apply(e,Object.getOwnPropertySymbols(t)),e}:Object.keys;function d(){this._events={},this._conf&&p.call(this,this._conf)}function p(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),t.maxListeners!==r&&(this._maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this._newListener=t.newListener),t.removeListener&&(this._removeListener=t.removeListener),t.verboseMemoryLeak&&(this.verboseMemoryLeak=t.verboseMemoryLeak),t.ignoreErrors&&(this.ignoreErrors=t.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function m(t,e){var n="(node) warning: possible EventEmitter memory leak detected. "+t+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+e+"."),"undefined"!=typeof process&&process.emitWarning){var i=new Error(n);i.name="MaxListenersExceededWarning",i.emitter=this,i.count=t,process.emitWarning(i)}else console.error(n),console.trace&&console.trace()}var f=function(t,e,n){var i=arguments.length;switch(i){case 0:return[];case 1:return[t];case 2:return[t,e];case 3:return[t,e,n];default:for(var r=new Array(i);i--;)r[i]=arguments[i];return r}};function g(t,e){for(var n={},i=t.length,s=e?value.length:0,a=0;a<i;a++)n[t[a]]=a<s?e[a]:r;return n}function _(t,e,n){var i,r;if(this._emitter=t,this._target=e,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(i=n.on,r=n.off),e.addEventListener?(i=e.addEventListener,r=e.removeEventListener):e.addListener?(i=e.addListener,r=e.removeListener):e.on&&(i=e.on,r=e.off),!i&&!r)throw Error("target does not implement any known event API");if("function"!=typeof i)throw TypeError("on method must be a function");if("function"!=typeof r)throw TypeError("off method must be a function");this._on=i,this._off=r;var s=t._observers;s?s.push(this):t._observers=[this]}function y(t,e,n,i){var a=Object.assign({},e);if(!t)return a;if("object"!=typeof t)throw TypeError("options must be an object");var o,l,c,u=Object.keys(t),h=u.length;function d(t){throw Error('Invalid "'+o+'" option value'+(t?". Reason: "+t:""))}for(var p=0;p<h;p++){if(o=u[p],!i&&!s.call(e,o))throw Error('Unknown "'+o+'" option');(l=t[o])!==r&&(c=n[o],a[o]=c?c(l,d):l)}return a}function v(t,e){return"function"==typeof t&&t.hasOwnProperty("prototype")||e("value must be a constructor"),t}function b(t){var e="value must be type of "+t.join("|"),n=t.length,i=t[0],r=t[1];return 1===n?function(t,n){if(typeof t===i)return t;n(e)}:2===n?function(t,n){var s=typeof t;if(s===i||s===r)return t;n(e)}:function(i,r){for(var s=typeof i,a=n;a-- >0;)if(s===t[a])return i;r(e)}}Object.assign(_.prototype,{subscribe:function(t,e,n){var i=this,r=this._target,s=this._emitter,a=this._listeners,o=function(){var i=f.apply(null,arguments),a={data:i,name:e,original:t};n?!1!==n.call(r,a)&&s.emit.apply(s,[a.name].concat(i)):s.emit.apply(s,[e].concat(i))};if(a[t])throw Error("Event '"+t+"' is already listening");this._listenersCount++,s._newListener&&s._removeListener&&!i._onNewListener?(this._onNewListener=function(n){n===e&&null===a[t]&&(a[t]=o,i._on.call(r,t,o))},s.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===e&&!s.hasListeners(n)&&a[t]&&(a[t]=null,i._off.call(r,t,o))},a[t]=null,s.on("removeListener",this._onRemoveListener)):(a[t]=o,i._on.call(r,t,o))},unsubscribe:function(t){var e,n,i,r=this,s=this._listeners,a=this._emitter,o=this._off,l=this._target;if(t&&"string"!=typeof t)throw TypeError("event must be a string");function c(){r._onNewListener&&(a.off("newListener",r._onNewListener),a.off("removeListener",r._onRemoveListener),r._onNewListener=null,r._onRemoveListener=null);var t=x.call(a,r);a._observers.splice(t,1)}if(t){if(!(e=s[t]))return;o.call(l,t,e),delete s[t],--this._listenersCount||c()}else{for(i=(n=h(s)).length;i-- >0;)t=n[i],o.call(l,t,s[t]);this._listeners={},this._listenersCount=0,c()}}});var w=b(["function"]),E=b(["object","function"]);function S(t,e,n){var i,r,s,a=0,o=new t((function(l,c,u){function h(){r&&(r=null),a&&(clearTimeout(a),a=0)}n=y(n,{timeout:0,overload:!1},{timeout:function(t,e){return("number"!=typeof(t*=1)||t<0||!Number.isFinite(t))&&e("timeout must be a positive number"),t}}),i=!n.overload&&"function"==typeof t.prototype.cancel&&"function"==typeof u;var d=function(t){h(),l(t)},p=function(t){h(),c(t)};i?e(d,p,u):(r=[function(t){p(t||Error("canceled"))}],e(d,p,(function(t){if(s)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof t)throw TypeError("onCancel callback must be a function");r.push(t)})),s=!0),n.timeout>0&&(a=setTimeout((function(){var t=Error("timeout");t.code="ETIMEDOUT",a=0,o.cancel(t),c(t)}),n.timeout))}));return i||(o.cancel=function(t){if(r){for(var e=r.length,n=1;n<e;n++)r[n](t);r[0](t),r=null}}),o}function x(t){var e=this._observers;if(!e)return-1;for(var n=e.length,i=0;i<n;i++)if(e[i]._target===t)return i;return-1}function k(t,e,n,i,r){if(!n)return null;if(0===i){var s=typeof e;if("string"===s){var a,o,l=0,c=0,u=this.delimiter,d=u.length;if(-1!==(o=e.indexOf(u))){a=new Array(5);do{a[l++]=e.slice(c,o),c=o+d}while(-1!==(o=e.indexOf(u,c)));a[l++]=e.slice(c),e=a,r=l}else e=[e],r=1}else"object"===s?r=e.length:(e=[e],r=1)}var p,m,f,g,_,y,v,b=null,w=e[i],E=e[i+1];if(i===r)n._listeners&&("function"==typeof n._listeners?(t&&t.push(n._listeners),b=[n]):(t&&t.push.apply(t,n._listeners),b=[n]));else{if("*"===w){for(o=(y=h(n)).length;o-- >0;)"_listeners"!==(p=y[o])&&(v=k(t,e,n[p],i+1,r))&&(b?b.push.apply(b,v):b=v);return b}if("**"===w){for((_=i+1===r||i+2===r&&"*"===E)&&n._listeners&&(b=k(t,e,n,r,r)),o=(y=h(n)).length;o-- >0;)"_listeners"!==(p=y[o])&&("*"===p||"**"===p?(n[p]._listeners&&!_&&(v=k(t,e,n[p],r,r))&&(b?b.push.apply(b,v):b=v),v=k(t,e,n[p],i,r)):v=k(t,e,n[p],p===E?i+2:i,r),v&&(b?b.push.apply(b,v):b=v));return b}n[w]&&(b=k(t,e,n[w],i+1,r))}if((m=n["*"])&&k(t,e,m,i+1,r),f=n["**"])if(i<r)for(f._listeners&&k(t,e,f,r,r),o=(y=h(f)).length;o-- >0;)"_listeners"!==(p=y[o])&&(p===E?k(t,e,f[p],i+2,r):p===w?k(t,e,f[p],i+1,r):((g={})[p]=f[p],k(t,e,{"**":g},i+1,r)));else f._listeners?k(t,e,f,r,r):f["*"]&&f["*"]._listeners&&k(t,e,f["*"],r,r);return b}function T(t,e,n){var i,r,s=0,a=0,o=this.delimiter,l=o.length;if("string"==typeof t)if(-1!==(i=t.indexOf(o))){r=new Array(5);do{r[s++]=t.slice(a,i),a=i+l}while(-1!==(i=t.indexOf(o,a)));r[s++]=t.slice(a)}else r=[t],s=1;else r=t,s=t.length;if(s>1)for(i=0;i+1<s;i++)if("**"===r[i]&&"**"===r[i+1])return;var c,u=this.listenerTree;for(i=0;i<s;i++)if(u=u[c=r[i]]||(u[c]={}),i===s-1)return u._listeners?("function"==typeof u._listeners&&(u._listeners=[u._listeners]),n?u._listeners.unshift(e):u._listeners.push(e),!u._listeners.warned&&this._maxListeners>0&&u._listeners.length>this._maxListeners&&(u._listeners.warned=!0,m.call(this,u._listeners.length,c))):u._listeners=e,!0;return!0}function $(t,e,n,i){for(var r,s,a,o,l=h(t),c=l.length,u=t._listeners;c-- >0;)r=t[s=l[c]],a="_listeners"===s?n:n?n.concat(s):[s],o=i||"symbol"==typeof s,u&&e.push(o?a:a.join(this.delimiter)),"object"==typeof r&&$.call(this,r,e,a,o);return e}function N(t){for(var e,n,i,r=h(t),s=r.length;s-- >0;)(e=t[n=r[s]])&&(i=!0,"_listeners"===n||N(e)||delete t[n]);return i}function I(t,e,n){this.emitter=t,this.event=e,this.listener=n}function R(t,e,n){if(!0===n)s=!0;else if(!1===n)i=!0;else{if(!n||"object"!=typeof n)throw TypeError("options should be an object or true");var i=n.async,s=n.promisify,a=n.nextTick,l=n.objectify}if(i||a||s){var c=e,h=e._origin||e;if(a&&!o)throw Error("process.nextTick is not supported");s===r&&(s="AsyncFunction"===e.constructor.name),e=function(){var t=arguments,e=this,n=this.event;return s?a?Promise.resolve():new Promise((function(t){u(t)})).then((function(){return e.event=n,c.apply(e,t)})):(a?process.nextTick:u)((function(){e.event=n,c.apply(e,t)}))},e._async=!0,e._origin=h}return[e,l?new I(this,t,e):this]}function A(t){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,p.call(this,t)}I.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},A.EventEmitter2=A,A.prototype.listenTo=function(t,e,n){if("object"!=typeof t)throw TypeError("target musts be an object");var i=this;function s(e){if("object"!=typeof e)throw TypeError("events must be an object");var r,s=n.reducers,a=x.call(i,t);r=-1===a?new _(i,t,n):i._observers[a];for(var o,l=h(e),c=l.length,u="function"==typeof s,d=0;d<c;d++)o=l[d],r.subscribe(o,e[o]||o,u?s:s&&s[o])}return n=y(n,{on:r,off:r,reducers:r},{on:w,off:w,reducers:E}),a(e)?s(g(e)):s("string"==typeof e?g(e.split(/\s+/)):e),this},A.prototype.stopListeningTo=function(t,e){var n=this._observers;if(!n)return!1;var i,r=n.length,s=!1;if(t&&"object"!=typeof t)throw TypeError("target should be an object");for(;r-- >0;)i=n[r],t&&i._target!==t||(i.unsubscribe(e),s=!0);return s},A.prototype.delimiter=".",A.prototype.setMaxListeners=function(t){t!==r&&(this._maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t)},A.prototype.getMaxListeners=function(){return this._maxListeners},A.prototype.event="",A.prototype.once=function(t,e,n){return this._once(t,e,!1,n)},A.prototype.prependOnceListener=function(t,e,n){return this._once(t,e,!0,n)},A.prototype._once=function(t,e,n,i){return this._many(t,1,e,n,i)},A.prototype.many=function(t,e,n,i){return this._many(t,e,n,!1,i)},A.prototype.prependMany=function(t,e,n,i){return this._many(t,e,n,!0,i)},A.prototype._many=function(t,e,n,i,r){var s=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function a(){return 0==--e&&s.off(t,a),n.apply(this,arguments)}return a._origin=n,this._on(t,a,i,r)},A.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||d.call(this);var t,e,n,i,r,s,a=arguments[0],o=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return!1;if(o&&(t=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(n=a.length,l)for(i=0;i<n;i++)if("symbol"==typeof a[i]){s=!0;break}s||(a=a.join(this.delimiter))}var c,u=arguments.length;if(this._all&&this._all.length)for(i=0,n=(c=this._all.slice()).length;i<n;i++)switch(this.event=a,u){case 1:c[i].call(this,a);break;case 2:c[i].call(this,a,arguments[1]);break;case 3:c[i].call(this,a,arguments[1],arguments[2]);break;default:c[i].apply(this,arguments)}if(o)c=[],k.call(this,c,t,this.listenerTree,0,n);else{if("function"==typeof(c=this._events[a])){switch(this.event=a,u){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=new Array(u-1),r=1;r<u;r++)e[r-1]=arguments[r];c.apply(this,e)}return!0}c&&(c=c.slice())}if(c&&c.length){if(u>3)for(e=new Array(u-1),r=1;r<u;r++)e[r-1]=arguments[r];for(i=0,n=c.length;i<n;i++)switch(this.event=a,u){case 1:c[i].call(this);break;case 2:c[i].call(this,arguments[1]);break;case 3:c[i].call(this,arguments[1],arguments[2]);break;default:c[i].apply(this,e)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===a)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},A.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||d.call(this);var t,e,n,i,r,s,a=arguments[0],o=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(o&&(t=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(i=a.length,l)for(r=0;r<i;r++)if("symbol"==typeof a[r]){e=!0;break}e||(a=a.join(this.delimiter))}var c,u=[],h=arguments.length;if(this._all)for(r=0,i=this._all.length;r<i;r++)switch(this.event=a,h){case 1:u.push(this._all[r].call(this,a));break;case 2:u.push(this._all[r].call(this,a,arguments[1]));break;case 3:u.push(this._all[r].call(this,a,arguments[1],arguments[2]));break;default:u.push(this._all[r].apply(this,arguments))}if(o?(c=[],k.call(this,c,t,this.listenerTree,0)):c=this._events[a],"function"==typeof c)switch(this.event=a,h){case 1:u.push(c.call(this));break;case 2:u.push(c.call(this,arguments[1]));break;case 3:u.push(c.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(h-1),s=1;s<h;s++)n[s-1]=arguments[s];u.push(c.apply(this,n))}else if(c&&c.length){if(c=c.slice(),h>3)for(n=new Array(h-1),s=1;s<h;s++)n[s-1]=arguments[s];for(r=0,i=c.length;r<i;r++)switch(this.event=a,h){case 1:u.push(c[r].call(this));break;case 2:u.push(c[r].call(this,arguments[1]));break;case 3:u.push(c[r].call(this,arguments[1],arguments[2]));break;default:u.push(c[r].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===a)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(u)},A.prototype.on=function(t,e,n){return this._on(t,e,!1,n)},A.prototype.prependListener=function(t,e,n){return this._on(t,e,!0,n)},A.prototype.onAny=function(t){return this._onAny(t,!1)},A.prototype.prependAny=function(t){return this._onAny(t,!0)},A.prototype.addListener=A.prototype.on,A.prototype._onAny=function(t,e){if("function"!=typeof t)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),e?this._all.unshift(t):this._all.push(t),this},A.prototype._on=function(t,e,n,i){if("function"==typeof t)return this._onAny(t,e),this;if("function"!=typeof e)throw new Error("on only accepts instances of Function");this._events||d.call(this);var s,a=this;return i!==r&&(e=(s=R.call(this,t,e,i))[0],a=s[1]),this._newListener&&this.emit("newListener",t,e),this.wildcard?(T.call(this,t,e,n),a):(this._events[t]?("function"==typeof this._events[t]&&(this._events[t]=[this._events[t]]),n?this._events[t].unshift(e):this._events[t].push(e),!this._events[t].warned&&this._maxListeners>0&&this._events[t].length>this._maxListeners&&(this._events[t].warned=!0,m.call(this,this._events[t].length,t))):this._events[t]=e,a)},A.prototype.off=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");var n,i=[];if(this.wildcard){var r="string"==typeof t?t.split(this.delimiter):t.slice();if(!(i=k.call(this,null,r,this.listenerTree,0)))return this}else{if(!this._events[t])return this;n=this._events[t],i.push({_listeners:n})}for(var s=0;s<i.length;s++){var o=i[s];if(n=o._listeners,a(n)){for(var l=-1,c=0,u=n.length;c<u;c++)if(n[c]===e||n[c].listener&&n[c].listener===e||n[c]._origin&&n[c]._origin===e){l=c;break}if(l<0)continue;return this.wildcard?o._listeners.splice(l,1):this._events[t].splice(l,1),0===n.length&&(this.wildcard?delete o._listeners:delete this._events[t]),this._removeListener&&this.emit("removeListener",t,e),this}(n===e||n.listener&&n.listener===e||n._origin&&n._origin===e)&&(this.wildcard?delete o._listeners:delete this._events[t],this._removeListener&&this.emit("removeListener",t,e))}return this.listenerTree&&N(this.listenerTree),this},A.prototype.offAny=function(t){var e,n=0,i=0;if(t&&this._all&&this._all.length>0){for(n=0,i=(e=this._all).length;n<i;n++)if(t===e[n])return e.splice(n,1),this._removeListener&&this.emit("removeListenerAny",t),this}else{if(e=this._all,this._removeListener)for(n=0,i=e.length;n<i;n++)this.emit("removeListenerAny",e[n]);this._all=[]}return this},A.prototype.removeListener=A.prototype.off,A.prototype.removeAllListeners=function(t){if(t===r)return!this._events||d.call(this),this;if(this.wildcard){var e,n=k.call(this,null,t,this.listenerTree,0);if(!n)return this;for(e=0;e<n.length;e++)n[e]._listeners=null;this.listenerTree&&N(this.listenerTree)}else this._events&&(this._events[t]=null);return this},A.prototype.listeners=function(t){var e,n,i,s,a,o=this._events;if(t===r){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!o)return[];for(s=(e=h(o)).length,i=[];s-- >0;)"function"==typeof(n=o[e[s]])?i.push(n):i.push.apply(i,n);return i}if(this.wildcard){if(!(a=this.listenerTree))return[];var l=[],c="string"==typeof t?t.split(this.delimiter):t.slice();return k.call(this,l,c,a,0),l}return o&&(n=o[t])?"function"==typeof n?[n]:n:[]},A.prototype.eventNames=function(t){var e=this._events;return this.wildcard?$.call(this,this.listenerTree,[],null,t):e?h(e):[]},A.prototype.listenerCount=function(t){return this.listeners(t).length},A.prototype.hasListeners=function(t){if(this.wildcard){var e=[],n="string"==typeof t?t.split(this.delimiter):t.slice();return k.call(this,e,n,this.listenerTree,0),e.length>0}var i=this._events,s=this._all;return!!(s&&s.length||i&&(t===r?h(i).length:i[t]))},A.prototype.listenersAny=function(){return this._all?this._all:[]},A.prototype.waitFor=function(t,e){var n=this,i=typeof e;return"number"===i?e={timeout:e}:"function"===i&&(e={filter:e}),S((e=y(e,{timeout:0,filter:r,handleError:!1,Promise,overload:!1},{filter:w,Promise:v})).Promise,(function(i,r,s){function a(){var s=e.filter;if(!s||s.apply(n,arguments))if(n.off(t,a),e.handleError){var o=arguments[0];o?r(o):i(f.apply(null,arguments).slice(1))}else i(f.apply(null,arguments))}s((function(){n.off(t,a)})),n._on(t,a,!1)}),{timeout:e.timeout,overload:e.overload})};var C=A.prototype;Object.defineProperties(A,{defaultMaxListeners:{get:function(){return C._maxListeners},set:function(t){if("number"!=typeof t||t<0||Number.isNaN(t))throw TypeError("n must be a non-negative number");C._maxListeners=t},enumerable:!0},once:{value:function(t,e,n){return S((n=y(n,{Promise,timeout:0,overload:!1},{Promise:v})).Promise,(function(n,i,r){var s;if("function"==typeof t.addEventListener)return s=function(){n(f.apply(null,arguments))},r((function(){t.removeEventListener(e,s)})),void t.addEventListener(e,s,{once:!0});var a,o=function(){a&&t.removeListener("error",a),n(f.apply(null,arguments))};"error"!==e&&(a=function(n){t.removeListener(e,o),i(n)},t.once("error",a)),r((function(){a&&t.removeListener("error",a),t.removeListener(e,o)})),t.once(e,o)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(C,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),(i=function(){return A}.call(e,n,e,t))===r||(t.exports=i)}()},18527:(t,e,n)=>{var i=n(77414);i&&i.__esModule&&(i=i.default),t.exports="string"==typeof i?i:i.toString()},58339:(t,e,n)=>{"use strict";n.r(e),n.d(e,{request:()=>_,settings:()=>y,storage:()=>g,type:()=>v});var i=n(58339),r=n(9375),s=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};const a={set(t,e){return s(this,void 0,void 0,(function*(){const n={};return n[t]=e,new Promise(((e,i)=>{o(t).set(n,(function(){chrome.runtime.lastError?i(chrome.runtime.lastError):e()}))}))}))},get(t){return s(this,void 0,void 0,(function*(){return new Promise(((e,n)=>{o(t).get(t,(function(i){chrome.runtime.lastError?n(chrome.runtime.lastError):e(i[t])}))}))}))},remove(t){return s(this,void 0,void 0,(function*(){return new Promise(((e,n)=>{o(t).remove(t,(function(){chrome.runtime.lastError?n(chrome.runtime.lastError):e()}))}))}))},list(t="local"){return s(this,void 0,void 0,(function*(){return new Promise(((e,n)=>{"local"===t?chrome.storage.local.get(null,(function(t){e(t)})):chrome.storage.sync.get(null,(function(t){e(t)}))}))}))},addStyle(t){return s(this,void 0,void 0,(function*(){try{const e=document.createElement("style");e.textContent=t,(document.head||document.body||document.documentElement||document).appendChild(e)}catch(t){console.log(`Could not add css:${t}`)}}))},version:()=>chrome.runtime.getManifest().version,lang(t,e){if(i.settings.get("forceEn")&&"undefined"!=typeof i18n){let n=i18n[t];if(void 0!==e)for(let t=0;t<e.length;t++)n=n.replace(`$${t+1}`,e[t]);return n}return chrome.i18n.getMessage(t,e)},assetUrl:t=>chrome.extension.getURL(`assets/${t}`),injectCssResource(t,e){alert("injectCssResource not supported in webextension")},injectjsResource(t,e){const n=document.createElement("script");n.src=chrome.extension.getURL(`vendor/${t}`),n.onload=function(){this.remove()},e.get(0).appendChild(n)},updateDom(t){const e=document.createElement("script");e.text="\n        document.getElementsByTagName('head')[0].onclick = function(e){\n          try{\n            componentHandler.upgradeDom();\n          }catch(e){\n            console.log(e);\n            setTimeout(function(){\n              componentHandler.upgradeDom();\n            },500);\n          }\n        }",e.onload=function(){this.remove()},t.get(0).appendChild(e)},storageOnChanged(t){chrome.storage.onChanged.addListener(t)}};function o(t){return r.syncRegex.test(t)?chrome.storage.sync:chrome.storage.local}var l=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};const c={xhr(t,e){return l(this,void 0,void 0,(function*(){if(void 0!==c.sendMessage)return c.sendMessage({name:"xhr",method:t,url:e}).then((t=>{if(429===t.status)throw"Rate limit Timeout";return t}));throw"Could not send xhr"}))},sendMessage(t){return l(this,void 0,void 0,(function*(){return new Promise(((e,n)=>{chrome.runtime.sendMessage(t,(function(t){e(t)}))}))}))},notification(t){this.sendMessage({name:"notification",options:t})},database(t,e){return this.sendMessage({name:"database",options:{call:t,param:e}})}};var u=n(2262),h=n(58339),d=n(9e4),p=n(9375),m=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};const f={options:(0,u.qj)({autoTrackingModeanime:"video",readerTracking:!0,autoTrackingModemanga:"instant",enablePages:{},forceEn:!1,rpc:!0,presenceLargeImage:"cover",presenceShowButtons:!0,presenceShowMalsync:!1,userscriptModeButton:!1,syncMode:"MAL",syncModeSimkl:"MAL",localSync:!0,delay:0,videoDuration:85,malTags:!1,malContinue:!0,malResume:!0,usedPage:!0,epPredictions:!0,theme:"auto",themeSidebars:!0,themeColor:"#000000",themeOpacity:100,themeImage:"",minimalWindow:!1,posLeft:"left",miniMALonMal:!1,floatButtonStealth:!1,minimizeBigPopup:!1,floatButtonCorrection:!0,floatButtonHide:!1,autoCloseMinimal:!1,outWay:!0,miniMalWidth:"550px",miniMalHeight:"90%",malThumbnail:100,friendScore:!0,loadPTWForProgress:!1,quicklinks:["9anime","Crunchyroll","Gogoanime","Twistmoe","Mangadex","MangaNato","MangaFox","MangaSee","MangaFire","YugenAnime","Zoro","Funimation","Hulu","Netflix","Hidive","Vrv","VIZ","MangaPlus","MangaReader","marin","ComicK"],quicklinksPosition:"default",autofull:!1,autoresume:!1,autoNextEp:!1,highlightAllEp:!1,checkForFiller:!0,crashReport:!0,introSkip:85,introSkipFwd:[17,39],introSkipBwd:[17,37],nextEpShort:[],correctionShort:[67],syncShort:[],progressInterval:120,progressIntervalDefaultAnime:"en/sub",progressIntervalDefaultManga:"en/sub",progressNotificationsAnime:!0,progressNotificationsManga:!0,bookMarksList:!1,customDomains:[],anilistUpdateUi:!0,anilistToken:"",anilistOptions:{displayAdultContent:!0,scoreFormat:"POINT_10"},kitsuToken:"",kitsuOptions:{titleLanguagePreference:"canonical",sfwFilter:!1,ratingSystem:"regular"},simklToken:"",malToken:"",malRefresh:"",shikiToken:"",shikiOptions:{locale:"ru"}}),debounceArray:{},isInit:(0,u.iH)(!1),init(){return m(this,void 0,void 0,(function*(){const t=[];for(const e in this.options){const n=yield h.storage.get(`settings/${e}`);void 0!==n&&(this.options[e]=n,t[e]=/(token|refresh)/i.test(e)&&n?"********":n)}let e;return d.log("Settings",t),h.storage.storageOnChanged(((t,n)=>{if("sync"===n)for(const e in t){const n=t[e];/^settings\//i.test(e)&&(this.options[e.replace("settings/","")]=n.newValue,d.info(`Update ${e} option to ${n.newValue}`))}if("local"===n&&t.rateLimit)try{clearTimeout(e),t.rateLimit.newValue?(d.log("Rate limited"),$(".type-rate").length||p.flashm("Rate limited. Retrying in a moment",{error:!0,type:"rate",permanent:!0})):e=setTimeout((()=>{d.log("No Rate limited"),$(".type-rate").remove()}),5e3)}catch(t){d.error(t)}})),this.isInit.value=!0,this}))},get(t){if(!this.isInit.value)throw"Settings not initialized";return this.options[t]},set(t,e){if(!Object.prototype.hasOwnProperty.call(this.options,t)){const e=Error(`${t} is not a defined option`);throw d.error(e),e}return this.options[t]=e,h.storage.set(`settings/${t}`,e)},setDebounce(t,e){this.options[t]=e,clearTimeout(this.debounceArray[t]),this.debounceArray[t]=setTimeout((()=>{this.set(t,e),delete this.debounceArray[t]}),1e3)},getAsync(t){return m(this,void 0,void 0,(function*(){const e=yield h.storage.get(`settings/${t}`);return void 0===e&&void 0!==this.options[t]?this.options[t]:e}))}},g=a,_=c,y=f,v="webextension"},9e4:(t,e,n)=>{"use strict";n.r(e),n.d(e,{debug:()=>a,error:()=>r,info:()=>s,log:()=>i,m:()=>o});const i=Function.prototype.bind.call(console.log,console,"%cMAL-Sync","background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;"),r=Function.prototype.bind.call(console.error,console,"%cMAL-Sync","background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;"),s=Function.prototype.bind.call(console.info,console,"%cMAL-Sync","background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;"),a=Function.prototype.bind.call(console.debug,console,"%cMAL-Sync","background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;"),o=(t,e="",n=[])=>{let i="white";e||(e=function(t){if(!t)return"#ffffff";t=String(t);let e=0;for(let n=0;n<t.length;n++)e=t.charCodeAt(n)+((e<<5)-e);let n="#";for(let t=0;t<3;t++)n+=`00${(e>>8*t&255).toString(16)}`.substr(-2);return n}(t)),"#"===e[0]&&(i=parseInt(e.replace("#",""),16)>8388607.5?"#000":"#fff");const r=`background-color: ${e}; color: ${i}; padding: 2px 10px; border-radius: 3px; margin-left: -5px; border-left: 1px solid white;`;n.push({name:t,style:r});const s={m:(t,e="")=>o(t,e,[...n])},a=n.reduce(((t,e)=>`${t}%c${e.name}`),""),l=n.map((t=>t.style));return s.log=Function.prototype.bind.call(console.log,console,`%cM ${a}`,"background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;",...l),s.error=Function.prototype.bind.call(console.error,console,`%cM ${a}`,"background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;",...l),s.info=Function.prototype.bind.call(console.info,console,`%cM ${a}`,"background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;",...l),s.debug=Function.prototype.bind.call(console.debug,console,`%cM ${a}`,"background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;",...l),s}},9375:(t,e,n)=>{"use strict";n.r(e),n.d(e,{absoluteLink:()=>w,canHideTabs:()=>F,changeDetect:()=>k,checkDoubleExecution:()=>R,clearCache:()=>at,elementInViewport:()=>Z,episode:()=>g,favicon:()=>p,flashConfirm:()=>K,flashm:()=>z,fullUrlChangeDetect:()=>x,generateUniqueID:()=>d,getAsyncWaitUntilTrue:()=>N,getBaseText:()=>h,getContinueWaching:()=>D,getEntrySettings:()=>M,getResumeWaching:()=>O,getStatusText:()=>W,getTooltip:()=>B,getUrlFromTags:()=>A,getselect:()=>b,handleMalImages:()=>j,htmlDecode:()=>nt,isDomainMatching:()=>lt,isFirefox:()=>it,lazyload:()=>X,makeDomainCompatible:()=>st,notifications:()=>q,pageUrl:()=>tt,parseHtml:()=>E,planTo:()=>f,rateLimitExclude:()=>y,returnYYYYMMDD:()=>et,setContinueWaching:()=>L,setEntrySettings:()=>U,setResumeWaching:()=>P,setUrlInTags:()=>C,sortAlphabetically:()=>ot,status:()=>v,statusTag:()=>Y,syncRegex:()=>_,timeCache:()=>H,timeDiffToText:()=>G,upperCaseFirstLetter:()=>ct,urlChangeDetect:()=>S,urlParam:()=>u,urlPart:()=>l,urlStrip:()=>c,wait:()=>Q,waitForPageToBeVisible:()=>rt,waitUntilTrue:()=>T,watching:()=>m});var i=n(19947),r=n(58339),s=n(9e4),a=n(9375),o=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};function l(t,e){if(!t)return"";const n=t.split("/");return n[e]?n[e].replace(/[#?].*/,""):""}function c(t){return t.replace(/[#?].*/,"")}function u(t,e){const n=new RegExp(`[?&]${e}=([^&#]*)`).exec(t);return null===n?null:decodeURI(n[1])||0}function h(t){let e=t.text();return t.children().each((function(){e=e.replace(i.$(this).text(),"")})),e}function d(t=10){const e=new Uint32Array(t);return window.crypto.getRandomValues(e),Array.from(e,(t=>t.toString(16))).join("")}function p(t){if(!t)return"";const e=t.match(/^(https?:\/\/)?[^/]+/);return e&&(t=e[0]),`https://favicon.malsync.moe/?domain=${t}`}function m(t){return"manga"===t?"Reading":"Watching"}function f(t){return"manga"===t?"Plan to Read":"Plan to Watch"}function g(t){return"manga"===t?r.storage.lang("UI_Chapter"):r.storage.lang("UI_Episode")}const _=/(^settings\/.*|^updateCheckTime$|^tempVersion$|^local:\/\/|^list-tagSettings$)/,y=/^https:\/\/api.malsync.moe\/(shark|mal\/|nc\/mal\/.*\/progress$)/i;var v;function b(t,e){let n=t.split(`name="${e}"`)[1].split("</select>")[0];if(n.indexOf('selected="selected"')>-1){n=n.split("<option");for(let t=0;t<n.length;++t)if(n[t].indexOf('selected="selected"')>-1)return n[t].split('value="')[1].split('"')[0]}return""}function w(t,e){return void 0===t||t.startsWith("http")||("/"!==t.charAt(0)&&(t=`/${t}`),t=e+t),t}function E(t){return(new DOMParser).parseFromString(`<!doctype html><body>${t}`,"text/html").body.textContent}function S(t){let e=window.location.href;return setInterval((function(){e!==window.location.href&&(e=window.location.href,t())}),100)}function x(t,e=!1){let n="";const i=setInterval((function(){const i=e?c(window.location.href):window.location.href;n!==i&&(n=i,t())}),100);return Number(i)}function k(t,e,n=!1){let i=e();const r=setInterval((function(){const n=e();void 0!==n&&i!==n&&(i=e(),t())}),500);return n&&t(),Number(r)}function T(t,e,n=100){const i=setInterval((function(){t()&&(clearInterval(i),e())}),n);return i}function N(t,e=100){let n,i;const r=()=>{clearTimeout(n),i&&i("AsyncWait stopped")};return{asyncWaitUntilTrue:()=>(r(),new Promise(((r,s)=>{i=s,n=T(t,(()=>r()),e)}))),reset:r}}!function(t){t[t.watching=1]="watching",t[t.completed=2]="completed",t[t.onhold=3]="onhold",t[t.dropped=4]="dropped",t[t.planToWatch=6]="planToWatch"}(v||(v={}));const I=Math.random();function R(){$(".mal-sync-double-detect").length&&$(".mal-sync-double-detect").each((function(t){$(this).text()!==I.toString()&&alert("Double execution detected! Please run MAL-Sync once only.")})),$("body").after(i.html(`<div class="mal-sync-double-detect" style="display: none;">${I.toString()}</div>`))}function A(t){return/malSync::[\d\D]+::/.test(t)?e(t.split("malSync::")[1].split("::")[0]):/last::[\d\D]+::/.test(t)?e(t.split("last::")[1].split("::")[0]):void 0;function e(t){try{return atob(t)}catch(e){return t}}}function C(t,e){if(""===t)return e.replace(/,?(malSync|last)::[^ \n]+?::/,"");if(!r.settings.get("malTags"))return e;const n=`malSync::${btoa(t)}::`;return/(last|malSync)::[\d\D]+::/.test(e)?e.replace(/(last|malSync)::[^^]*?::/,n):`${e},${n}`}function P(t,e,n,i){return o(this,void 0,void 0,(function*(){return r.storage.set(`resume/${n}/${i}`,{url:t,ep:e})}))}function O(t,e){return o(this,void 0,void 0,(function*(){if(r.settings.get("malResume"))return r.storage.get(`resume/${t}/${e}`)}))}function L(t,e,n,i){return o(this,void 0,void 0,(function*(){return r.storage.set(`continue/${n}/${i}`,{url:t,ep:e})}))}function D(t,e){return o(this,void 0,void 0,(function*(){if(r.settings.get("malContinue"))return r.storage.get(`continue/${t}/${e}`)}))}function U(t,e,n,i=""){return o(this,void 0,void 0,(function*(){const s={};if(n){for(const t in n)switch(t){case"u":case"p":s[t]=n[t]}r.settings.get("malTags")?i=C(JSON.stringify(s),i):yield r.storage.set(`tagSettings/${t}/${e}`,JSON.stringify(s))}return Object.values(s).find((t=>Boolean(t)))||(i=C("",i),r.settings.get("malTags")||(yield r.storage.remove(`tagSettings/${t}/${e}`))),i}))}function M(t,e,n=""){return o(this,void 0,void 0,(function*(){const i={u:null,c:null,r:null,p:""};if(r.settings.get("malTags")){const t=A(n);if(t)if("{"===t[0])try{const e=JSON.parse(t);for(const t in i)e[t]&&(i[t]=e[t])}catch(t){s.error(t)}else i.u=t}else{let n=yield r.storage.get(`tagSettings/${t}/${e}`);if(n){n=JSON.parse(n);for(const t in i)n[t]&&(i[t]=n[t])}}const a=yield D(t,e);a&&(i.c=a);const o=yield O(t,e);return o&&(i.r=o),r.settings.get("usedPage")||(i.u=null),i}))}function j(t){return-1!==t.indexOf("questionmark")?r.storage.assetUrl("questionmark.gif"):t}function B(t,e="",n="top"){const i=Math.floor(1e3*Math.random()+1);return`<div id="tt${i}" class="icon material-icons" style="font-size:16px; line-height: 0; color: #7f7f7f; padding-bottom: 20px; padding-left: 3px; ${e}">contact_support</div>  <div class="mdl-tooltip mdl-tooltip--${n} mdl-tooltip--large" for="tt${i}">${t}</div>`}function G(t){let e="";t/=1e3;const n=Math.floor(t/31536e3);t-=31536e3*n,n&&(e+=`${n}y `);const i=Math.floor(t/86400);t-=86400*i,i&&(e+=`${i}d `);const r=Math.floor(t/3600)%24;t-=3600*r,r&&i<2&&(e+=`${r}h `);const s=Math.floor(t/60)%60;return t-=60*s,s&&!i&&r<3&&(e+=`${s}min `),e}function F(){return"undefined"!=typeof browser&&void 0!==browser.tabs.hide}function Y(t,e,n){const i={anime:{1:{class:"watching",text:"CW",title:r.storage.lang(`UI_Status_watching_${e}`)},2:{class:"completed",text:"CMPL",title:r.storage.lang("UI_Status_Completed")},3:{class:"on-hold",text:"HOLD",title:r.storage.lang("UI_Status_OnHold")},4:{class:"dropped",text:"DROP",title:r.storage.lang("UI_Status_Dropped")},6:{class:"plantowatch",text:"PTW",title:r.storage.lang(`UI_Status_planTo_${e}`)},23:{class:"rewatching",text:"RE",title:r.storage.lang(`UI_Status_Rewatching_${e}`)}},manga:{1:{class:"reading",text:"CR",title:r.storage.lang(`UI_Status_watching_${e}`)},2:{class:"completed",text:"CMPL",title:r.storage.lang("UI_Status_Completed")},3:{class:"on-hold",text:"HOLD",title:r.storage.lang("UI_Status_OnHold")},4:{class:"dropped",text:"DROP",title:r.storage.lang("UI_Status_Dropped")},6:{class:"plantoread",text:"PTR",title:r.storage.lang(`UI_Status_planTo_${e}`)},23:{class:"rewatching",text:"RE",title:r.storage.lang(`UI_Status_Rewatching_${e}`)}}};if($.each([1,2,3,4,6,23],(function(t,e){i.anime[i.anime[e].title]=i.anime[e],i.manga[i.manga[e].title]=i.manga[e]})),t&&i[e][t]){const r=i[e][t];return` <a href="https://myanimelist.net/ownlist/${e}/${n}/edit?hideLayout=1" title="${r.title}" class="Lightbox_AddEdit button_edit ${r.class}">${r.text}</a>`}return!1}function W(t,e){switch(e){case 1:return r.storage.lang(`UI_Status_watching_${t}`);case 2:return r.storage.lang("UI_Status_Completed");case 3:return r.storage.lang("UI_Status_OnHold");case 4:return r.storage.lang("UI_Status_Dropped");case 6:return r.storage.lang(`UI_Status_planTo_${t}`);case 7:return r.storage.lang("UI_Status_All");case 23:return r.storage.lang(`UI_Status_Rewatching_${t}`);default:return""}}function q(t,e,n,i=""){const a={type:"basic",title:e,message:n,iconUrl:i};s.log("Notification",t,a),r.storage.get("notificationHistory").then((e=>{void 0===e&&(e=[]),"object"==typeof e&&(e.length>=10&&e.shift(),e.push({url:t,title:a.title,message:a.message,iconUrl:a.iconUrl,timestamp:Date.now()}),r.storage.set("notificationHistory",e))}));try{return chrome.notifications.create(t,a)}catch(t){s.error(t)}}function H(t,e,n){return o(this,void 0,void 0,(function*(){const i=yield r.storage.get(t);if("object"==typeof i&&(new Date).getTime()<i.timestamp)return i.data;const s=yield e();return r.storage.set(t,{data:s,timestamp:(new Date).getTime()+n}).then((()=>s))}))}function z(t,e){i.$("#flash-div-top").length||function(){r.storage.addStyle('.flashinfo{\n                    transition: max-height 2s, opacity 2s 2s;\n                 }\n                 .mini-stealth .flashinfo{\n                    opacity: 0;\n                 }\n                  #flashinfo-div.hover.mini-stealth .flashinfo.type-update{\n                    opacity: 0.7;\n                 }\n                 #flashinfo-div.hover .flashinfo{\n                    opacity: 1;\n                 }\n                 .flashinfo:hover{\n                    max-height:5000px !important;\n                    z-index: 2147483647;\n                    opacity: 1;\n                    transition: max-height 2s;\n                 }\n                 .flashinfo .synopsis{\n                    transition: max-height 2s, max-width 2s ease 2s;\n                 }\n                 .flashinfo:hover .synopsis{\n                    max-height:9999px !important;\n                    max-width: 500px !important;\n                    transition: max-height 2s;\n                 }\n                 #flashinfo-div{\n                  z-index: 2;\n                  transition: 2s;\n                 }\n                 #flashinfo-div:hover, #flashinfo-div.hover{\n                  z-index: 2147483647;\n                 }\n                 #flashinfo-div.player-error {\n                   z-index: 2147483647;\n                 }\n                 #flashinfo-div.player-error .type-update{\n                  overflow: visible !important;\n                  opacity: 1 !important;\n                 }\n                 #flashinfo-div.player-error .player-error{\n                  display: block !important\n                 }\n                 #flashinfo-div.player-error-missing-permissions .player-error-missing-permissions{\n                  display: block !important\n                 }\n                 #flashinfo-div.player-error-missing-permissions .player-error-default{\n                  display: none !important\n                 }\n\n                 #flash-div-top, #flash-div-bottom, #flashinfo-div{\n                    font-family: "Helvetica","Arial",sans-serif;\n                    color: white;\n                    font-size: 14px;\n                    font-weight: 400;\n                    line-height: 17px;\n                 }\n                 #flash-div-top h2, #flash-div-bottom h2, #flashinfo-div h2{\n                    font-family: "Helvetica","Arial",sans-serif;\n                    color: white;\n                    font-size: 14px;\n                    font-weight: 700;\n                    line-height: 17px;\n                    padding: 0;\n                    margin: 0;\n                 }\n                 #flash-div-top a, #flash-div-bottom a, #flashinfo-div a{\n                    color: #DF6300;\n                 }');let t="";r.settings.get("floatButtonStealth")&&(t="mini-stealth"),i.$("body").after(i.html(`<div id="flash-div-top" style="text-align: center;pointer-events: none;position: fixed;top:-5px;width:100%;z-index: 2147483647;left: 0;"></div>        <div id="flash-div-bottom" style="text-align: center;pointer-events: none;position: fixed;bottom:0px;width:100%;z-index: 2147483647;left: 0;"><div id="flash" style="display:none;  background-color: red;padding: 20px; margin: 0 auto;max-width: 60%;          -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 20px;background:rgba(227,0,0,0.6);"></div></div>        <div id="flashinfo-div" class="${t}" style="text-align: center;pointer-events: none;position: fixed;bottom:0px;width:100%;left: 0;">`))}(),s.log("[Flash] Message:",t);let n="#323232";void 0!==e&&void 0!==e.error&&e.error&&(n="#3e0808");let a="#flash-div-bottom";void 0!==e&&void 0!==e.position&&e.position&&(a=`#flash-div-${e.position}`);let o="flash";if(void 0!==e&&void 0!==e.type&&e.type){const t=`type-${e.type}`;i.$(`${a} .${t}, #flashinfo-div .${t}`).removeClass(t).fadeOut({duration:1e3,queue:!1,complete(){i.$(this).remove()}}),o+=` ${t}`}let l,c=`<div class="${o}" style="display:none;">        <div style="display:table; pointer-events: all; padding: 14px 24px 14px 24px; margin: 0 auto; margin-top: 5px; max-width: 60%; -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 2px;color: white;background:${n}; ">          ${t}        </div>      </div>`;return void 0!==e&&void 0!==e.hoverInfo&&e.hoverInfo?(o+=" flashinfo",c=`<div class="${o}" style="display:none; max-height: 5000px; overflow: hidden;"><div style="display:table; pointer-events: all; margin: 0 auto; margin-top: -2px; max-width: 60%; -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 2px;color: white;background:${n}; position: relative;"><div style="max-height: 60vh; overflow-y: auto; padding: 14px 24px 14px 24px;">${t}</div></div></div>`,i.$("#flashinfo-div").addClass("hover"),l=i.$(i.html(c)).appendTo("#flashinfo-div"),void 0!==e&&void 0!==e.minimized&&e.minimized&&l.css("max-height","8px")):l=i.$(i.html(c)).appendTo(a),void 0!==e&&void 0!==e.permanent&&e.permanent?l.slideDown(800):void 0!==e&&void 0!==e.hoverInfo&&e.hoverInfo?l.slideDown(800).delay(4e3).queue((function(){i.$("#flashinfo-div").removeClass("hover"),l.css("max-height","8px")})):l.slideDown(800).delay(4e3).slideUp(800,(()=>{i.$(this).remove()})),l}function K(t,e,n=(()=>{}),s=(()=>{}),a=!1){return o(this,void 0,void 0,(function*(){return new Promise((function(o,l){let c=r.storage.lang("Ok"),u=r.storage.lang("Cancel");a&&(c=r.storage.lang("Yes"),u=r.storage.lang("No"));const h=z(t=`<div style="text-align: center;">${t}</div><div style="display: flex; justify-content: space-around;"><button class="Yes" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px; cursor:pointer;">${c}</button><button class="Cancel" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px; cursor:pointer;">${u}</button></div>`,{permanent:!0,position:"top",type:e});h.find(".Yes").click((function(t){o(!0),i.$(t.target).parentsUntil(".flash").fadeOut(300,(function(){i.$(this).remove()})),n()})),h.find(".Cancel").click((function(t){o(!1),i.$(t.target).parentsUntil(".flash").fadeOut(300,(function(){i.$(this).remove()})),s()}))}))}))}let V=!1,J=[];function X(t,e=".mdl-layout__content"){function n(t,e){if(!i.$(t).is(":visible"))return!1;if(i.$(t).hasClass("lazyBack"))i.$(t).css("background-image",`url(${t.getAttribute("data-src")})`).removeClass("lazyBack");else{const n=new Image,i=t.getAttribute("data-src");n.onload=function(){t.parent?t.parent.replaceChild(n,t):t.src=i,e&&e()},n.src=i}}for(let t=0;t<J.length;t++)$(J[t]).addClass("init");J=[];const r=t.find("img.lazy.init, .lazyBack.init"),s=function(){for(let t=0;t<J.length;t++)a.elementInViewport(J[t],600)&&n(J[t],(function(){J.splice(t,t)})),$(J[t]).length||J.splice(t,t)};for(let t=0;t<r.length;t++)J.push(r[t]),$(r[t]).removeClass("init");s(),V||(V=!0,t.find(e).scroll((function(){s()})))}function Z(t,e=0){const n=t.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.top-e<=(window.innerHeight||document.documentElement.clientHeight)}function Q(t){return new Promise((e=>{setTimeout(e,t)}))}function tt(t,e,n){switch(t){case"mal":return`https://myanimelist.net/${e}/${n}`;case"anilist":return`https://anilist.co/${e}/${n}`;case"kitsu":return`https://kitsu.io/${e}/${n}`;case"simkl":return`https://simkl.com/${e}/${n}`;default:throw`${t} not a valid page`}}function et(t=0){const e=new Date;e.setDate(e.getDate()+t);const n=e.getMonth()<9?`0${e.getMonth()+1}`:e.getMonth()+1,i=e.getDate()<10?`0${e.getDate()}`:e.getDate();return`${e.getFullYear()}-${n}-${i}`}function nt(t){return $("<textarea/>").html(i.html(t)).text()}function it(){return Boolean("undefined"!=typeof browser&&"undefined"!=typeof chrome)}function rt(){const t=()=>Boolean(!document.visibilityState||"visible"===document.visibilityState);if(t())return Promise.resolve();s.log("Page in background");const{asyncWaitUntilTrue:e}=N((()=>t()));return e().then((()=>{s.log("Page is visible")}))}function st(t){return t.split("/").length<4&&(t+="/"),t.replace(/\?.*/,"?")}function at(){return o(this,void 0,void 0,(function*(){const t=yield r.storage.list();let e=0;i.$.each(t,(function(t,n){a.syncRegex.test(String(t))||/(^tagSettings\/.*)/.test(String(t))||(r.storage.remove(String(t)),e++)})),a.flashm(`Cache Cleared [${e}]`)}))}function ot(t,e){return t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}function lt(t,e){const n=new URL(t),{host:i}=n;return i===e||i.endsWith(`.${e}`)}function ct(t){return!t||t.length<2?t:t.charAt(0).toUpperCase()+t.slice(1)}},19947:(t,e,n)=>{"use strict";n.r(e),n.d(e,{$:()=>r,html:()=>s});var i=n(27856);const r=jQuery;function s(t){return i.sanitize(t,{SAFE_FOR_JQUERY:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ADD_ATTR:["target"]})}},16245:t=>{"use strict";t.exports=JSON.parse('[{"name":"9anime","domain":"https://9anime.to","database":"9anime","search":{"anime":"https://9anime.to/filter?keyword={searchtermPlus}","manga":null}},{"name":"Crunchyroll","domain":"https://www.crunchyroll.com","database":"Crunchyroll","search":{"anime":"https://www.crunchyroll.com/search?q={searchtermPlus}","manga":null}},{"name":"Vrv","domain":"https://vrv.co","database":"Vrv","search":{"anime":"https://vrv.co/?q={searchterm}","manga":null}},{"name":"Mangadex","domain":"https://www.mangadex.org","database":"Mangadex","search":{"anime":null,"manga":"https://mangadex.org/titles?q={searchterm}"}},{"name":"Gogoanime","domain":"https://gogoanime.tv","database":"Gogoanime","search":{"anime":"https://www1.gogoanime.ai/search.html?keyword={searchterm}","manga":null}},{"name":"Twistmoe","domain":"https://twist.moe","database":"Twistmoe","search":{"anime":"home","manga":null}},{"name":"TurkAnime","domain":"https://www.turkanime.co","database":null,"search":{"anime":"home","manga":null}},{"name":"animepahe","domain":"https://animepahe.com","database":"animepahe","search":{"anime":"home","manga":null}},{"name":"Netflix","domain":"https://www.netflix.com","database":"Netflix","search":{"anime":"https://www.netflix.com/search?q={searchterm}","manga":null}},{"name":"Animeflv","domain":"https://animeflv.net","database":null,"search":{"anime":"https://www3.animeflv.net/browse?q={searchtermPlus}","manga":null}},{"name":"Jkanime","domain":"https://jkanime.net","database":null,"search":{"anime":"https://jkanime.net/buscar/{searchterm}","manga":null}},{"name":"Proxer","domain":"https://proxer.me","database":null,"search":{"anime":"https://proxer.me/search?s=search&name={searchterm}&typ=all-anime&tags=&notags=#top","manga":"https://proxer.me/search?s=search&name={searchterm}&typ=all-manga&tags=&notags=#top"}},{"name":"Wakanim","domain":"https://www.wakanim.tv","database":null,"search":{"anime":"https://www.wakanim.tv/de/v2/catalogue/search?search={searchterm}","manga":null}},{"name":"Emby","domain":"http://app.emby.media","database":null,"search":{"anime":"home","manga":null}},{"name":"Plex","domain":"http://app.plex.tv","database":null,"search":{"anime":"home","manga":null}},{"name":"Aniflix","domain":"https://www1.aniflix.tv","database":null,"search":{"anime":"home","manga":null}},{"name":"KickAssAnime","domain":"https://kaas.am","database":null,"search":{"anime":"home","manga":null}},{"name":"Shinden","domain":"https://shinden.pl","database":null,"search":{"anime":"home","manga":null}},{"name":"Voiranime","domain":"https://voiranime.com","database":null,"search":{"anime":"https://voiranime.com/?s={searchtermPlus}","manga":null}},{"name":"MangaNato","domain":"https://manganato.com","database":"MangaNato","search":{"anime":null,"manga":"https://manganato.com/search/story/{searchterm(_)[noSpecial]}"}},{"name":"VIZ","domain":"https://www.viz.com","database":"VIZ","search":{"anime":null,"manga":"https://www.viz.com/search?search={searchtermPlus}"}},{"name":"NekoSama","domain":"https://neko-sama.fr","database":null,"search":{"anime":"home","manga":null}},{"name":"AnimeOdcinki","domain":"https://anime-odcinki.pl","database":null,"search":{"anime":"https://anime-odcinki.pl/szukaj/{searchtermPlus}","manga":null}},{"name":"AnimeZone","domain":"https://www.animezone.pl","database":null,"search":{"anime":"home","manga":null}},{"name":"serimanga","domain":"https://serimanga.com","database":null,"search":{"anime":null,"manga":"https://serimanga.com/mangalar?search={searchtermPlus}"}},{"name":"mangadenizi","domain":"https://mangadenizi.com","database":null,"search":{"anime":null,"manga":"home"}},{"name":"moeclip","domain":"https://moeclip.com","database":null,"search":{"anime":"https://moeclip.com/search/{searchtermPlus}","manga":null}},{"name":"mangalivre","domain":"https://mangalivre.net","database":null,"search":{"anime":null,"manga":"home"}},{"name":"tmofans","domain":"https://lectortmo.com","database":null,"search":{"anime":null,"manga":"https://lectortmo.com/library?_pg=1&title={searchtermPlus}"}},{"name":"unionmangas","domain":"https://unionleitor.top","database":null,"search":{"anime":null,"manga":"home"}},{"name":"MangaPlus","domain":"https://mangaplus.shueisha.co.jp","database":"MangaPlus","search":{"anime":null,"manga":"https://mangaplus.shueisha.co.jp/search_result?keyword={searchterm}"}},{"name":"JapScan","domain":"https://www.japscan.ws","database":null,"search":{"anime":null,"manga":"home"}},{"name":"AnimesVision","domain":"https://animes.vision","database":null,"search":{"anime":"home","manga":null}},{"name":"Hulu","domain":"https://www.hulu.com","database":"Hulu","search":{"anime":"home","manga":null}},{"name":"Hidive","domain":"https://www.hidive.com","database":"Hidive","search":{"anime":"https://www.hidive.com/search?q={searchtermPlus}","manga":null}},{"name":"FallenAngels","domain":"https://manga.fascans.com","database":null,"search":{"anime":null,"manga":"home"}},{"name":"Amazon Prime Video","domain":"https://www.primevideo.com","database":null,"search":{"anime":"home","manga":null}},{"name":"MangaKatana","domain":"http://mangakatana.com","database":null,"search":{"anime":null,"manga":"http://mangakatana.com/?search={searchtermPlus}&search_by=book_name"}},{"name":"manga4life","domain":"https://manga4life.com","database":null,"search":{"anime":null,"manga":"https://manga4life.com/search/?name={searchterm}"}},{"name":"bato","domain":"https://bato.to","database":null,"search":{"anime":null,"manga":"https://bato.to/search?word={searchtermPlus}"}},{"name":"MangaPark","domain":"https://mangapark.net","database":null,"search":{"anime":null,"manga":"https://mangapark.net/search?word={searchterm}"}},{"name":"AnimesHouse","domain":"https://animeshouse.net","database":null,"search":{"anime":"home","manga":null}},{"name":"AnimeXin","domain":"https://animexinax.com","database":null,"search":{"anime":"https://animexinax.com/?s={searchtermPlus}","manga":null}},{"name":"MonosChinos","domain":"https://monoschinos2.com","database":null,"search":{"anime":"https://monoschinos2.com/buscar?q={searchtermPlus}","manga":null}},{"name":"AnimeFire","domain":"https://animefire.net","database":null,"search":{"anime":"home","manga":null}},{"name":"OtakuFR","domain":"https://otakufr.co","database":null,"search":{"anime":"https://otakufr.co/toute-la-liste-affiches/?q={searchtermPlus}","manga":null}},{"name":"Samehadaku","domain":"https://samehadaku.vip","database":null,"search":{"anime":"https://samehadaku.vip/?s={searchtermPlus}","manga":null}},{"name":"Tsuki Mangs","domain":"https://www.tsukimangas.com","database":null,"search":{"anime":null,"manga":"home"}},{"name":"mangatx","domain":"https://mangatx.com","database":null,"search":{"anime":null,"manga":"https://mangatx.com/?s={searchtermPlus}&post_type=wp-manga&post_type=wp-manga"}},{"name":"manhuafast","domain":"https://manhuafast.com","database":null,"search":{"anime":null,"manga":"https://manhuafast.com/?s={searchtermPlus}&post_type=wp-manga&post_type=wp-manga"}},{"name":"TRanimeizle","domain":"https://www.tranimeizle.net/","database":null,"search":{"anime":"home","manga":null}},{"name":"Anihub","domain":"https://anihub.tv","database":null,"search":{"anime":"home","manga":null}},{"name":"AnimeStreamingFR","domain":"https://beta.animestreamingfr.fr","database":null,"search":{"anime":"https://beta.animestreamingfr.fr/catalogue/search?query={searchtermPlus}","manga":null}},{"name":"Furyosquad","domain":"https://furyosquad.com/","database":null,"search":{"anime":null,"manga":"home"}},{"name":"AnimeId","domain":"https://www.animeid.tv","database":null,"search":{"anime":"home","manga":null}},{"name":"MyAnimeList","domain":"https://myanimelist.net","database":null,"search":{"anime":"https://myanimelist.net/anime.php?q={searchterm}","manga":"https://myanimelist.net/manga.php?q={searchterm}"}},{"name":"AnimeUnity","domain":"https://animeunity.it","database":null,"search":{"anime":"home","manga":null}},{"name":"MangaHere","domain":"http://www.mangahere.cc","database":null,"search":{"anime":null,"manga":"http://www.mangahere.cc/search?title={searchtermPlus}"}},{"name":"MangaFox","domain":"http://fanfox.net","database":"MangaFox","search":{"anime":null,"manga":"http://fanfox.net/search?title={searchtermPlus}"}},{"name":"YayAnimes","domain":"https://yayanimes.net","database":null,"search":{"anime":"https://yayanimes.net/?s={searchtermPlus}","manga":null}},{"name":"DesuOnline","domain":"https://desu-online.pl","database":null,"search":{"anime":"https://desu-online.pl/?s={searchtermPlus}","manga":null}},{"name":"WuxiaWorld","domain":"https://wuxiaworld.site","database":null,"search":{"anime":null,"manga":"https://wuxiaworld.site/?s={searchtermPlus}&post_type=wp-manga"}},{"name":"LeviatanScans","domain":"https://en.leviatanscans.com","database":null,"search":{"anime":null,"manga":"https://en.leviatanscans.com/?s={searchtermPlus}"}},{"name":"ReaperScans","domain":"https://reaperscans.com","database":null,"search":{"anime":null,"manga":"home"}},{"name":"LynxScans","domain":"https://lynxscans.com","database":null,"search":{"anime":null,"manga":"https://lynxscans.com/comics?query={searchtermPlus}"}},{"name":"SKScans","domain":"https://skscans.com","database":null,"search":{"anime":null,"manga":"https://skscans.com/?s={searchtermPlus}"}},{"name":"ZeroScans","domain":"https://zeroscans.com","database":null,"search":{"anime":null,"manga":"home"}},{"name":"DeathTollScans","domain":"https://reader.deathtollscans.net","database":null,"search":{"anime":null,"manga":"home"}},{"name":"SenseScans","domain":"https://sensescans.com","database":null,"search":{"anime":null,"manga":"home"}},{"name":"ManhuaPlus","domain":"https://manhuaplus.com","database":null,"search":{"anime":null,"manga":"https://manhuaplus.com/?s={searchtermPlus}&post_type=wp-manga"}},{"name":"Readm","domain":"https://readm.org","database":null,"search":{"anime":null,"manga":"home"}},{"name":"tioanime","domain":"https://tioanime.com","database":null,"search":{"anime":"https://tioanime.com/directorio?q={searchtermPlus}","manga":null}},{"name":"YugenAnime","domain":"https://yugen.to","database":"YugenAnime","search":{"anime":"https://yugenanime.ro/search/?q={searchtermPlus}","manga":null}},{"name":"MangaSee","domain":"https://mangasee123.com","database":"MangaSee","search":{"anime":null,"manga":"https://mangasee123.com/search/?name={searchterm}"}},{"name":"AnimeTribes","domain":"https://animetribes.ru","database":null,"search":{"anime":"home","manga":null}},{"name":"Okanime","domain":"https://okanime.tv","database":null,"search":{"anime":"https://okanime.tv/search?search={searchtermPlus}","manga":null}},{"name":"bs.to","domain":"https://bs.to","database":null,"search":{"anime":"home","manga":null}},{"name":"AsuraScans","domain":"https://asura.gg","database":null,"search":{"anime":null,"manga":"https://www.asurascans.com/?s={searchtermPlus}"}},{"name":"NaniScans","domain":"https://naniscans.com","database":null,"search":{"anime":null,"manga":"home"}},{"name":"Jellyfin","domain":"https://jellyfin.org/","database":null,"search":{"anime":"home","manga":null}},{"name":"An1me","domain":"https://an1me.nl","database":null,"search":{"anime":"https://an1me.nl/?s={searchtermPlus}&post_type=wp-manga","manga":null}},{"name":"MangaJar","domain":"https://mangajar.com","database":null,"search":{"anime":null,"manga":"https://mangajar.com/search?q={searchtermPlus}"}},{"name":"AnimeDao","domain":"https://animedao.to","database":null,"search":{"anime":"https://animedao.to/search/?search={searchtermPlus}","manga":null}},{"name":"Otakustv","domain":"https://www.otakustv.com","database":null,"search":{"anime":"https://www.otakustv.com/buscador.php?buscador={searchterm}","manga":null}},{"name":"Komga","domain":"https://komga.org","database":null,"search":{"anime":null,"manga":"home"}},{"name":"AnimeWho","domain":"https://animewho.com","database":null,"search":{"anime":"home","manga":null}},{"name":"AnimeSuge","domain":"https://animesuge.to","database":null,"search":{"anime":"home","manga":null}},{"name":"Toonily","domain":"https://toonily.net","database":null,"search":{"anime":null,"manga":"https://toonily.net/?s={searchtermPlus}&post_type=wp-manga"}},{"name":"Fumetsu","domain":"https://fumetsu.pl","database":null,"search":{"anime":"home","manga":null}},{"name":"NonstopScans","domain":"https://www.nonstopscans.com","database":null,"search":{"anime":null,"manga":"https://www.nonstopscans.com/?s={searchtermPlus}"}},{"name":"FrixySubs","domain":"https://frixysubs.pl","database":null,"search":{"anime":"home","manga":null}},{"name":"Guya & Cubari","domain":"https://guya.moe","database":null,"search":{"anime":null,"manga":"home"}},{"name":"MangaHub","domain":"https://mangahub.io","database":null,"search":{"anime":null,"manga":"https://mangahub.io/search?q={searchterm}"}},{"name":"ComicK","domain":"https://comick.app","database":"Comick","search":{"anime":null,"manga":"https://comick.app/search?q={searchterm}"}},{"name":"Japanread","domain":"https://www.japanread.cc/","database":null,"search":{"anime":null,"manga":"https://www.japanread.cc/manga-list?q={searchterm}"}},{"name":"Bentomanga","domain":"https://www.bentomanga.com","database":null,"search":{"anime":null,"manga":"https://www.bentomanga.com/manga_list?search={searchterm}"}},{"name":"MangaSushi","domain":"https://mangasushi.net","database":null,"search":{"anime":null,"manga":"https://mangasushi.net/?s={searchtermPlus}&post_type=wp-manga"}},{"name":"HunlightScans","domain":"https://hunlight-scans.info/","database":null,"search":{"anime":null,"manga":"https://hunlight-scans.info/comics?query={searchtermPlus}"}},{"name":"TritiniaScans","domain":"https://tritinia.com","database":null,"search":{"anime":null,"manga":"https://tritinia.com/?s={searchtermPlus}&post_type=wp-manga"}},{"name":"ReadManhua","domain":"https://readmanhua.net","database":null,"search":{"anime":null,"manga":"https://readmanhua.net/?s={searchtermPlus}&post_type=wp-manga"}},{"name":"FlameScans","domain":"https://flamescans.org","database":null,"search":{"anime":null,"manga":"https://flamescans.org/?s={searchtermPlus}"}},{"name":"ImmortalUpdates","domain":"https://immortalupdates.com","database":null,"search":{"anime":null,"manga":"https://immortalupdates.com/?s={searchtermPlus}&post_type=wp-manga"}},{"name":"Zoro","domain":"https://zoro.to","database":"Zoro","search":{"anime":"https://zoro.to/search?keyword={searchtermPlus}","manga":null}},{"name":"Funimation","domain":"https://www.funimation.com","database":"Funimation","search":{"anime":"https://www.funimation.com/search/?q={searchterm}","manga":null}},{"name":"Kitsune","domain":"https://beta.kitsune.tv","database":null,"search":{"anime":"https://kitsune.tv/shows?q={searchterm}","manga":null}},{"name":"AnimesOnline","domain":"https://animesonline.org","database":null,"search":{"anime":"https://animesonline.org/?s={searchtermPlus}","manga":null}},{"name":"LHTranslation","domain":"https://lhtranslation.net","database":null,"search":{"anime":null,"manga":"https://lhtranslation.net/?s={searchtermPlus}&post_type=wp-manga"}},{"name":"MangasOrigines","domain":"https://mangas-origines.fr/","database":null,"search":{"anime":null,"manga":"https://mangas-origines.fr/?s={searchtermPlus}&post_type=wp-manga"}},{"name":"shiro","domain":"https://shiro.is","database":null,"search":{"anime":"https://shiro.is/browse/?title={searchterm}","manga":null}},{"name":"BlueSolo","domain":"https://www.bluesolo.org","database":null,"search":{"anime":null,"manga":"home"}},{"name":"DisasterScans","domain":"https://disasterscans.com","database":null,"search":{"anime":null,"manga":"https://disasterscans.com/?s={searchtermPlus}&post_type=wp-manga"}},{"name":"DynastyScans","domain":"https://dynasty-scans.com","database":null,"search":{"anime":null,"manga":"https://dynasty-scans.com/search?q={searchtermPlus}"}},{"name":"SugarBabies","domain":"https://sugarbbscan.com/","database":null,"search":{"anime":null,"manga":"https://sugarbbscan.com/?s={searchtermPlus}&post_type=wp-manga"}},{"name":"Aniworld","domain":"https://aniworld.to","database":null,"search":{"anime":"https://aniworld.to/search?q={searchterm}","manga":null}},{"name":"BetterAnime","domain":"https://betteranime.net","database":null,"search":{"anime":"https://betteranime.net/pesquisa?titulo={searchtermPlus}","manga":null}},{"name":"BilibiliComics","domain":"https://www.bilibilicomics.com","database":null,"search":{"anime":null,"manga":"https://www.bilibilicomics.com/search?keyword={searchterm( )[noLowercase]}"}},{"name":"MangaReader","domain":"https://mangareader.to","database":"MangaReader","search":{"anime":null,"manga":"https://mangareader.to/search?keyword={searchtermPlus}"}},{"name":"AnimeOnsen","domain":"https://animeonsen.xyz","database":null,"search":{"anime":"https://www.animeonsen.xyz/search/{searchterm}","manga":null}},{"name":"Puray","domain":"https://puray.moe","database":null,"search":{"anime":"home","manga":null}},{"name":"Animetoast","domain":"https://www.animetoast.cc","database":null,"search":{"anime":"https://www.animetoast.cc/?s={searchterm}","manga":null}},{"name":"MuitoMang","domain":"https://muitomanga.com","database":null,"search":{"anime":null,"manga":"https://muitomanga.com/buscar?q={searchtermPlus}"}},{"name":"RealmScans","domain":"https://realmscans.com","database":null,"search":{"anime":null,"manga":"https://realmscans.com/?s={searchtermPlus}"}},{"name":"LuminousScans","domain":"https://luminousscans.com","database":null,"search":{"anime":null,"manga":"https://luminousscans.com/?s={searchtermPlus}"}},{"name":"Animeworld","domain":"https://www.animeworld.tv","database":null,"search":{"anime":"home","manga":null}},{"name":"MangaBuddy","domain":"https://mangabuddy.com","database":null,"search":{"anime":null,"manga":"https://mangabuddy.com/search?q={searchtermPlus}"}},{"name":"Vostfree","domain":"https://vostfree.cx","database":null,"search":{"anime":"https://vostfree.tv/index.php?do=search&subaction=search&story={searchterm}","manga":null}},{"name":"VoidScans","domain":"https://void-scans.com","database":null,"search":{"anime":null,"manga":"https://void-scans.com/?s={searchtermPlus}"}},{"name":"ToonAnime","domain":"https://vvww.toonanime.cc","database":null,"search":{"anime":"https://vvww.toonanime.cc/?story={searchtermPlus}&do=search&subaction=search","manga":null}},{"name":"ADKami","domain":"https://www.adkami.com/","database":null,"search":{"anime":"https://www.adkami.com/video?search={searchtermPlus}","manga":null}},{"name":"Kaguya","domain":"https://kaguya.live","database":null,"search":{"anime":"https://kaguya.live/browse?keyword={searchtermPlus}","manga":null}},{"name":"Hdrezka","domain":"https://hdrezka.ag","database":null,"search":{"anime":"https://hdrezka.ag/search/?do=search&subaction=search&q={searchterm}","manga":null}},{"name":"ADN","domain":"https://animationdigitalnetwork.fr","database":null,"search":{"anime":"https://animationdigitalnetwork.fr/video?search={searchterm}","manga":null}},{"name":"Aniyan","domain":"https://aniyan.net","database":"Aniyan","search":{"anime":"https://aniyan.net/?s={searchtermPlus}","manga":null}},{"name":"marin","domain":"https://marin.moe","database":"Marin","search":{"anime":"https://marin.moe/anime?search={searchterm}","manga":null}},{"name":"Isekaiscan","domain":"https://isekaiscan.com","database":null,"search":{"anime":null,"manga":"https://isekaiscan.com/?s={searchtermPlus}&post_type=wp-manga"}},{"name":"FRAnime","domain":"https://franime.fr","database":null,"search":{"anime":"https://franime.fr/recherche?search={searchtermPlus}","manga":null}},{"name":"FMTeam","domain":"https://fmteam.fr/","database":null,"search":{"anime":null,"manga":"home"}},{"name":"Animelon","domain":"https://www.animelon.com","database":null,"search":{"anime":"https://www.animelon.com/search?searchTerm={searchTerm}","manga":null}},{"name":"MangaFire","domain":"https://mangafire.to","database":"MangaFire","search":{"anime":null,"manga":"https://mangafire.to/filter?keyword={searchtermPlus}"}},{"name":"Pactedanime","domain":"https://pactedanime.com","database":null,"search":{"anime":"https://pactedanime.com/?s={searchtermPlus}","manga":null}},{"name":"projectsuki","domain":"https://projectsuki.com","database":null,"search":{"anime":null,"manga":"https://projectsuki.com/search?q={searchtermPlus}"}}]')}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};n.r(t),n.d(t,{FunctionToString:()=>Un,InboundFilters:()=>On});var e,i,r,s={};n.r(s),n.d(s,{Breadcrumbs:()=>yi,Dedupe:()=>zi,GlobalHandlers:()=>ji,HttpContext:()=>Zi,LinkedErrors:()=>qi,TryCatch:()=>Oi}),(i=e||(e={}))[i.NoState=0]="NoState",i[i.Watching=1]="Watching",i[i.Completed=2]="Completed",i[i.Onhold=3]="Onhold",i[i.Dropped=4]="Dropped",i[i.PlanToWatch=6]="PlanToWatch",i[i.All=7]="All",i[i.Rewatching=23]="Rewatching",function(t){t[t.NoScore=0]="NoScore",t[t.R1=1]="R1",t[t.R2=2]="R2",t[t.R3=3]="R3",t[t.R4=4]="R4",t[t.R5=5]="R5",t[t.R6=6]="R6",t[t.R7=7]="R7",t[t.R8=8]="R8",t[t.R9=9]="R9",t[t.R10=10]="R10"}(r||(r={}));var a=n(9e4);let o;if(function(){try{return localStorage.getItem("x"),!0}catch(t){return a.info("Local storage is not available",t),!1}}())o=localStorage;else{let t={};o={getItem:e=>e in t?t[e]:null,setItem(e,n){t[e]=n},removeItem(e){e in t&&delete t[e]},clear(){t={}}}}const l=o;var c=n(58339),u=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};class h{constructor(t,e,n=!0,i=0){return this.key=t,this.ttl=e,this.localStorage=n,this.refetchTtl=i,this}containsValue(t){return null!=t}valueValid(t,e){return!(!t||!t.timestamp)&&(new Date).getTime()<t.timestamp+e}ttlValid(t){return this.valueValid(t,this.ttl)}refetchTtlValid(t){return this.valueValid(t,this.refetchTtl)}hasValue(){return u(this,void 0,void 0,(function*(){const t=yield this.getStorage();return!(!this.containsValue(t)||!this.ttlValid(t))}))}hasValueAndIsNotEmpty(){return u(this,void 0,void 0,(function*(){const t=yield this.getStorage();return!!(this.containsValue(t)&&void 0!==t.data&&null!==t.data&&Object.keys(t.data).length&&this.ttlValid(t))}))}fullState(){return u(this,void 0,void 0,(function*(){const t=yield this.getStorage(),e=this.containsValue(t)&&this.refetchTtlValid(t),n=this.ttlValid(t);return{value:t,hasValue:e,isValid:n,refetch:e&&!n}}))}getValue(){return u(this,void 0,void 0,(function*(){return(yield this.getStorage()).data}))}setValue(t){return u(this,void 0,void 0,(function*(){const e={data:t,timestamp:(new Date).getTime()};return this.localStorage?l.setItem(this.key,JSON.stringify(e)):c.storage.set(this.key,e)}))}clearValue(){return u(this,void 0,void 0,(function*(){return this.localStorage?l.removeItem(this.key):c.storage.remove(this.key)}))}getStorage(){return u(this,void 0,void 0,(function*(){return this.localStorage?JSON.parse(l.getItem(this.key)):c.storage.get(this.key)}))}}n(58339);var d=n(56387),p=n(9e4),m=n(58339);const f=Math.floor(1e9*Math.random()),g=new d.EventEmitter2({wildcard:!0});function _(t,...e){p.m("Global").m("Emit").debug(t,...e),g.emit(`${t}`,...e),void 0!==m&&m&&"webextension"===m.type&&chrome.runtime.sendMessage({name:"emitter",item:{event:t,params:e,id:f}})}void 0!==m&&m&&"webextension"===m.type&&chrome.runtime.onMessage.addListener(((t,e,n)=>{t.name&&"emitter"===t.name&&(p.m("Global").m("Event").debug(t.item.id,t.item.event,t.item.params),t.item.id!==f&&g.emit(t.item.event,...t.item.params))}));var y=n(58339);class v extends Error{constructor(t){super(t),this.name="NotAutenticatedError"}}class b extends Error{constructor(t){super(t),this.name="UrlNotSupportedError"}}class w extends Error{constructor(t){super(t),this.name="ServerOfflineError"}}class E extends Error{constructor(t){super(t),this.name="NotFoundError"}}class S extends Error{constructor(t){super(t),this.name="UnexpectedResponseError"}}function x(t,e){return t instanceof v?y.storage.lang("Error_Authenticate",[e]):t instanceof w?"Server Offline":t instanceof b?`Incorrect url provided [${t.message}]`:t instanceof E?"Could not find this entry":t.message}var k,T,N=n(58339),I=n(9e4),R=n(9375),A=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};Object.seal(g);class C{constructor(t=1,e="anime",n="default"){return this.status=t,this.listType=e,this.sort=n,this.done=!1,this.loading=!1,this.firstLoaded=!1,this.seperateRewatching=!1,this.modes={frontend:!1,sortAiring:!1,initProgress:!1,cached:!1},this.username="",this.offset=0,this.templist=[],this.api=N,this.cacheObj=void 0,this.status=Number(this.status),this.logger=I.m("[S]","#348fff"),this}setTemplist(t){return this.templist=t,this}getTemplist(){return this.templist}setSort(t){if(this.firstLoaded||this.loading)throw"To late to change sort";this.sort=t}isDone(){return this.done}isLoading(){return this.loading}isFirstLoaded(){return this.firstLoaded}getCompleteList(){return A(this,void 0,void 0,(function*(){do{yield this.getNext()}while(!this.done);return this.modes.sortAiring&&(yield this.sortAiringList()),this.modes.cached&&this.getCache().setValue(this.templist.slice(0,18)),this.firstLoaded=!0,this.templist}))}getNextPage(){return A(this,void 0,void 0,(function*(){return this.done?this.templist:!this.modes.frontend||1!==this.status||"default"!==this.sort&&"unread"!==this.sort?(yield this.getNext(),this.modes.cached&&this.getCache().setValue(this.templist.slice(0,24)),this.firstLoaded=!0,this.templist):(this.modes.sortAiring=!0,this.getCompleteList())}))}getNext(){return A(this,void 0,void 0,(function*(){this.loading=!0;const t=yield this.getPart();this.templist=this.templist.concat(t),this.loading=!1}))}getCached(){return A(this,void 0,void 0,(function*(){if(yield this.getCache().hasValue()){const t=yield this.getCache().getValue();return t.forEach((t=>{(t=this.fn(t)).watchedEp="",t.score=""})),t}return[]}))}initFrontendMode(){this.modes.frontend=!0,this.updateListener=g.on("update.*",(t=>{if(I.log("update",t),t.cacheKey){const e=this.templist.find((e=>e.cacheKey===t.cacheKey));I.log(e),e&&t.state&&(e.watchedEp=t.state.episode,e.score=t.state.score,e.status=t.state.status)}}),{objectify:!0})}destroy(){this.updateListener&&this.updateListener.off()}getUsername(){return this.getUserObject().then((t=>t.username))}getSortingOptions(t=!1){const e=[{icon:"filter_list",title:N.storage.lang("settings_progress_default"),value:"default"}];return 1===this.status&&"manga"===this.listType&&e.push({icon:"adjust",title:N.storage.lang("list_sorting_unread"),value:"unread"}),this._getSortingOptions().forEach((n=>{if(!t){if(n.asc){const t=Object.assign({},n);delete t.asc,t.value+="_asc",t.title+=" Ascending",e.push(t)}delete n.asc}e.push(n)})),e}flashmError(t){R.flashm(this.errorMessage(t),{error:!0,type:"error"})}errorMessage(t){return x(t,this.authenticationUrl)}fn(t,e=""){return A(this,void 0,void 0,(function*(){let n=null;return t.fn={continueUrl:()=>null!==n?n:R.getContinueWaching(t.type,t.cacheKey).then((e=>{const i=parseInt(t.watchedEp.toString());return void 0===e||e.ep!==i+1?"":(n=e.url,n)})),initProgress:()=>new it(t.cacheKey,t.type).init().then((e=>{t.fn.progress=e})),progress:!1},t.options=yield R.getEntrySettings(t.type,t.cacheKey,t.tags),e&&(t.options.u=e),(this.modes.sortAiring||this.modes.initProgress)&&(yield t.fn.initProgress()),t}))}initProgress(){return A(this,void 0,void 0,(function*(){const t=[];this.templist.forEach((e=>{t.push(e.fn.initProgress())})),yield Promise.all(t)}))}sortAiringList(){return A(this,void 0,void 0,(function*(){if("unread"===this.sort)return void this.sortUnread();const t=[];let e=[],n=[];function i(t,e){let n=t.fn.progress.getPredictionTimestamp(),i=e.fn.progress.getPredictionTimestamp();return n||(n=999999999999),i||(i=n),n-i}this.templist.forEach((i=>{const r=i.fn.progress;"anime"===this.listType?r&&r.isAiring()&&r.getPredictionTimestamp()?i.watchedEp<r.getCurrentEpisode()?e.push(i):n.push(i):t.push(i):r&&r.isAiring()&&r.getCurrentEpisode()&&i.watchedEp&&i.watchedEp<r.getCurrentEpisode()&&i.watchedEp+6>r.getCurrentEpisode()?e.push(i):t.push(i)})),e=e.sort(i).reverse(),n=n.sort(i),this.templist=e.concat(n,t)}))}sortUnread(){this.templist=this.templist.sort((function(t,e){let n=1e4,i=1e4;if(t.fn.progress&&t.fn.progress.getCurrentEpisode()){const e=t.fn.progress.getCurrentEpisode()-t.watchedEp;e>0&&(n=e)}if(e.fn.progress&&e.fn.progress.getCurrentEpisode()){const t=e.fn.progress.getCurrentEpisode()-e.watchedEp;t>0&&(i=t)}return n-i}))}getCache(){return this.cacheObj||(this.cacheObj=new h(`list/${this.name}/${this.listType}/${this.status}/${this.sort}`,1728e5)),this.cacheObj}}n(19947),n(9375),n(58339),n(58339),function(t){t[t.watching=e.Watching]="watching",t[t.completed=e.Completed]="completed",t[t.on_hold=e.Onhold]="on_hold",t[t.dropped=e.Dropped]="dropped",t[t.plan_to_watch=e.PlanToWatch]="plan_to_watch"}(k||(k={})),function(t){t[t.reading=e.Watching]="reading",t[t.completed=e.Completed]="completed",t[t.on_hold=e.Onhold]="on_hold",t[t.dropped=e.Dropped]="dropped",t[t.plan_to_read=e.PlanToWatch]="plan_to_read"}(T||(T={})),n(58339),n(9e4);var P,O=n(9e4);n(58339),O.m("anilist","#3db4f2"),function(t){t[t.CURRENT=e.Watching]="CURRENT",t[t.PLANNING=e.PlanToWatch]="PLANNING",t[t.COMPLETED=e.Completed]="COMPLETED",t[t.DROPPED=e.Dropped]="DROPPED",t[t.PAUSED=e.Onhold]="PAUSED",t[t.REPEATING=e.Rewatching]="REPEATING"}(P||(P={})),n(58339),n(9e4);var L=n(9e4),D=n(58339);const U=L.m("kitsu","#d65e43");function M(t,e=null){const n={current:1,planned:6,completed:2,dropped:4,on_hold:3};return null!==e?Object.keys(n).find((t=>n[t]===e)):n[t]}function j(t,e){let n;switch(D.settings.get("kitsuOptions").titleLanguagePreference){case"english":n=t.en;break;case"romanized":n=t.en_jp;break;default:n=e}if(void 0!==n&&n||(n=t.en),void 0!==n&&n||(n=t.en_jp),void 0!==n&&n||(n=t.ja_jp),void 0===n||!n){const e=Object.keys(t);if(!e.length)return"No Title";n=t[e[0]]}return n}function B(t,e){return Number.isNaN(t)||!t?`kitsu:${e}`:t}function G(t,e,n={},i=!0){const r={"Content-Type":"application/vnd.api+json",Accept:"application/vnd.api+json"};return i&&(r.Authorization=`Bearer ${D.settings.get("kitsuToken")}`),D.request.xhr(t,{url:e,headers:r,data:JSON.stringify(n)}).then((t=>{if(t.status>499&&t.status<600||0===t.status)throw new w(`Server Offline status: ${t.status}`);if(204===t.status)return{};const e=function(t){try{return JSON.parse(t)}catch(t){throw new S(t.message)}}(t.responseText);if(void 0!==e.errors&&e.errors.length){U.error("[SINGLE]","Error",e.errors);const t=e.errors[0];switch(parseInt(t.status)){case 401:case 403:throw new v(t.detail);case 404:throw new E(t.detail);default:throw new Error(t.detail)}}return e}))}var F,Y=n(58339),W=n(9e4),q=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};class H extends C{constructor(){super(...arguments),this.name="Kitsu",this.authenticationUrl="https://kitsu.io/404?mal-sync=authentication"}getUserObject(){var t;return q(this,void 0,void 0,(function*(){const e=yield this.userRequest(),n=Y.settings.get("kitsuOptions");return n.titleLanguagePreference=e.attributes.titleLanguagePreference,n.sfwFilter=e.attributes.sfwFilter,n.ratingSystem=e.attributes.ratingSystem,Y.settings.set("kitsuOptions",n),{username:e.attributes.name,picture:(null===(t=e.attributes.avatar)||void 0===t?void 0:t.large)||"",href:`https://kitsu.io/users/${e.attributes.slug}`}}))}getUserId(){return q(this,void 0,void 0,(function*(){const t=yield Y.storage.get("kitsuUserId");if(void 0!==t&&t)return t;const e=yield this.userRequest();return Y.storage.set("kitsuUserId",e.id),e.id}))}userRequest(){return G("GET","https://kitsu.io/api/edge/users?filter[self]=true").then((t=>{if(W.log(t),void 0===t.data[0])throw new v("Not Authenticated");return t.data[0]}))}deauth(){return Y.settings.set("kitsuToken","").then((()=>Y.storage.set("kitsuUserId","")))}accessToken(){return Y.settings.get("kitsuToken")}_getSortingOptions(){return[{icon:"sort_by_alpha",title:Y.storage.lang("list_sorting_alpha"),value:"alpha",asc:!0},{icon:"history",title:Y.storage.lang("list_sorting_history"),value:"updated",asc:!0},{icon:"score",title:Y.storage.lang("list_sorting_score"),value:"score",asc:!0}]}getOrder(t){let e="";switch(t.endsWith("_asc")||(e="-"),t.replace("_asc","")){case"alpha":return e=e?"":"-",`${e}${this.listType}.titles.en`;case"updated":return`${e}progressed_at`;case"score":return`${e}rating`;default:return 1===this.status||6===this.status?this.getOrder("updated"):this.getOrder("alpha")}}getPart(){return q(this,void 0,void 0,(function*(){const t=yield this.getUserId();let e="",n="";const i=this.getOrder(this.sort);return i&&(n=`&sort=${i}`),7!==this.status&&(e=`&filter[status]=${M(this.status,this.status)}`),W.log("[UserList][Kitsu]",`user: ${t}`,`status: ${this.status}`,`offset: ${this.offset}`),G("GET",`https://kitsu.io/api/edge/library-entries?filter[user_id]=${t}${e}&filter[kind]=${this.listType}&page[offset]=${this.offset}&page[limit]=50${n}&include=${this.listType},${this.listType}.mappings,${this.listType}.mappings.item&fields[${this.listType}]=slug,titles,canonicalTitle,averageRating,posterImage,coverImage,${"anime"===this.listType?"episodeCount":"chapterCount,volumeCount"}`).then((t=>(W.log(t),this.offset+=50,t.meta.count>this.offset||(this.done=!0),this.prepareData(t,this.listType))))}))}prepareData(t,e){return q(this,void 0,void 0,(function*(){const n=[];for(let i=0;i<t.data.length;i++){const r=t.data[i],s=t.included[i],a=j(s.attributes.titles,s.attributes.canonicalTitle);let o,l=NaN;for(let n=0;n<t.included.length;n++){const i=t.included[n];if("mappings"===i.type&&i.attributes.externalSite===`myanimelist/${e}`&&i.relationships.item.data.id===s.id){l=Number(i.attributes.externalId),t.included.splice(n,1);break}}o="anime"===e?yield this.fn({malId:l,apiCacheKey:l,uid:Number(s.id),cacheKey:B(l,s.id),kitsuSlug:s.attributes.slug,type:e,title:a,url:`https://kitsu.io/${e}/${s.attributes.slug}`,watchedEp:r.attributes.progress,totalEp:s.attributes.episodeCount,status:M(r.attributes.status),score:Math.round(r.attributes.ratingTwenty/2),image:s.attributes.posterImage&&s.attributes.posterImage.small?s.attributes.posterImage.small:"",imageLarge:s.attributes.posterImage&&s.attributes.posterImage.original?s.attributes.posterImage.original:"",imageBanner:s.attributes.coverImage&&s.attributes.coverImage.large?s.attributes.coverImage.large:"",tags:r.attributes.notes,airingState:s.anime_airing_status}):yield this.fn({malId:l,apiCacheKey:l,uid:Number(s.id),cacheKey:B(l,s.id),kitsuSlug:s.attributes.slug,type:e,title:a,url:`https://kitsu.io/${e}/${s.attributes.slug}`,watchedEp:r.attributes.progress,totalEp:s.attributes.chapterCount,status:M(r.attributes.status),score:Math.round(r.attributes.ratingTwenty/2),image:s.attributes.posterImage&&s.attributes.posterImage.small?s.attributes.posterImage.small:"",imageLarge:s.attributes.posterImage&&s.attributes.posterImage.original?s.attributes.posterImage.original:"",imageBanner:s.attributes.coverImage&&s.attributes.coverImage.large?s.attributes.coverImage.large:"",tags:r.attributes.notes,airingState:s.anime_airing_status}),null===o.totalEp&&(o.totalEp=0),n.push(o)}return n}))}}n(9e4),n(58339),n(58339),n(9e4),n(58339),function(t){t[t.watching=e.Watching]="watching",t[t.planned=e.PlanToWatch]="planned",t[t.completed=e.Completed]="completed",t[t.dropped=e.Dropped]="dropped",t[t.on_hold=e.Onhold]="on_hold",t[t.rewatching=e.Rewatching]="rewatching"}(F||(F={})),n(58339),n(9e4),n(58339),n(9e4),n(9375),n(58339);var z=n(58339),K=n(9e4),V=n(9375),J=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};function X(t,e){return J(this,void 0,void 0,(function*(){if(!e)return{};const n=yield z.request.xhr("GET",`https://api.malsync.moe/nc/mal/${t}/${e}/pr`);return JSON.parse(n.responseText)}))}var Z=n(58339);function Q(t,e=!0){if(!t)return"";const n=Date.now();let i,r;if(n>t?(r=!1,i=n-t):(r=!0,i=t-n),i<3e4)return Z.storage.lang("bookmarksItem_now");let s=function(t){let e="";return 1===t.y?e+=` ${t.y} ${Z.storage.lang("bookmarksItem_Year")}`:t.y>1&&(e+=` ${t.y} ${Z.storage.lang("bookmarksItem_Years")}`),1===t.d?e+=` ${t.d} ${Z.storage.lang("bookmarksItem_Day")}`:t.d>1&&(e+=` ${t.d} ${Z.storage.lang("bookmarksItem_Days")}`),1===t.h?e+=` ${t.h} ${Z.storage.lang("bookmarksItem_Hour")}`:t.h>1&&(e+=` ${t.h} ${Z.storage.lang("bookmarksItem_Hours")}`),1===t.m?e+=` ${t.m} ${Z.storage.lang("bookmarksItem_min")}`:t.m>1&&(e+=` ${t.m} ${Z.storage.lang("bookmarksItem_mins")}`),1===t.s?e+=` ${t.s} ${Z.storage.lang("bookmarksItem_sec")}`:t.s>1&&(e+=` ${t.s} ${Z.storage.lang("bookmarksItem_secs")}`),e.trim()}((a=function(t){let e,n,i,r;r=Math.floor(t/1e3),i=Math.floor(r/60),r%=60,n=Math.floor(i/60),i%=60,e=Math.floor(n/24),n%=24;const s=Math.floor(e/365);return e%=365,{y:s,d:e,h:n,m:i,s:r}}(i)).y>1?a.d>182?{y:a.y+1,d:0,h:0,m:0,s:0}:{y:a.y,d:0,h:0,m:0,s:0}:a.y?{y:a.y,d:a.d,h:0,m:0,s:0}:a.d>3?a.h>11?{y:0,d:a.d+1,h:0,m:0,s:0}:{y:0,d:a.d,h:0,m:0,s:0}:a.d?{y:0,d:a.d,h:a.h,m:0,s:0}:a.h>5?a.m>29?{y:0,d:0,h:a.h+1,m:0,s:0}:{y:0,d:0,h:a.h,m:0,s:0}:a.h?{y:0,d:0,h:a.h,m:a.m,s:0}:a.m>14?{y:0,d:0,h:0,m:a.m,s:0}:{y:0,d:0,h:0,m:a.m,s:a.s});var a;return!r&&e&&(s=Z.storage.lang("bookmarksItem_ago",[s])),s}var tt=n(9e4),et=n(58339),nt=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};class it{constructor(t,e){return this.cacheKey=t,this.type=e,this.releaseItem=void 0,this.logger=tt.m("progress").m(t.toString()),this}initReleaseProgress(t){return nt(this,void 0,void 0,(function*(){t&&(yield function(t,e,n="default",i=K.m("release")){return J(this,void 0,void 0,(function*(){if(n||(n="default"),(i=i.m(t.uid.toString())).log(t.title,t.cacheKey,t.apiCacheKey,`Mode: ${n}`),!t.apiCacheKey)return void i.log("No Api Cache Id");if(!z.settings.get("epPredictions"))return void i.log("epPredictions disabled");const r=yield z.storage.get(`release/${e}/${t.cacheKey}`);i.m("Load").log(r);let s,a=!1;if(r&&r.mode&&r.mode!==n&&(a=!0),r&&r.timestamp&&Date.now()-r.timestamp<12e4&&!a)return void i.log("Up to date");if(r&&r.finished&&r.timestamp&&Date.now()-r.timestamp<6048e5&&!a)return void i.log("Fininshed");if(r&&!r.value&&r.timestamp&&Date.now()-r.timestamp<864e5&&!a)return void i.log("Nulled");a&&i.log("Update forced"),"off"===n&&(i.log("Disabled"),t.xhr=[]),void 0!==t.xhr?s=t.xhr:(s=yield X(e,t.apiCacheKey),yield V.wait(500)),i.log(s);const o=function(t,e,n){const i={};if(!t.length)return null;let r;if("default"===e?(i.mainId="anime"===n?z.settings.get("progressIntervalDefaultAnime"):z.settings.get("progressIntervalDefaultManga"),i.fallback="en/sub"):i.mainId=e,i.fallbackPrediction="jp/dub",i.mainId){const e=t.find((t=>t.id===i.mainId));e&&(r=e)}if(i.fallback&&!r){const e=t.find((t=>t.id===i.fallback));e&&(r=e)}if(i.fallbackPrediction&&r&&!r.predicition&&r.lastEp&&r.lastEp.timestamp){const e=t.find((t=>t.id===i.fallbackPrediction)),n=r.lastEp.timestamp+6048e5;n&&e&&e.predicition&&(r.lastEp.total===e.lastEp.total?Math.abs(n-e.predicition.timestamp)<108e6&&(r.predicition={timestamp:n,probability:"medium"}):e.lastEp.total&&r.lastEp.total===e.lastEp.total-1&&Math.abs(n-(e.predicition.timestamp-6048e5))<108e6&&(r.predicition={timestamp:n,probability:"medium"}))}if(i.fallbackPrediction&&!r){const e=t.find((t=>t.id===i.fallbackPrediction));e&&e.lastEp&&e.predicition&&0===e.lastEp.total&&(r=e,r.predicition.probability="medium")}return r||null}(s,n,e);o||i.log("No value for the selected mode");let l=!1;o&&o.state&&"complete"===o.state&&(l=!0),i.m("Save").log(o),r&&r.value&&function(t,e,n,i){J(this,void 0,void 0,(function*(){try{if("anime"===i&&!z.settings.get("progressNotificationsAnime")||"manga"===i&&!z.settings.get("progressNotificationsManga"))return;if(t&&n&&n&&e.lastEp&&void 0!==e.lastEp.total&&n.lastEp&&n.lastEp.total&&e.lang===n.lang&&e.type===n.type&&e.lastEp.total<n.lastEp.total&&t.watchedEp+1===n.lastEp.total){let e;e=t.single?{title:t.title,text:z.storage.lang(`syncPage_malObj_nextEp_${i}`,[n.lastEp.total]),sticky:!0,image:yield t.single.getImage(),url:t.single.getStreamingUrl()?t.single.getStreamingUrl():t.single.getUrl()}:{title:t.title,text:z.storage.lang(`syncPage_malObj_nextEp_${i}`,[n.lastEp.total]),sticky:!0,image:t.image,url:t.options&&t.options.u?t.options.u:t.url},z.request.notification(e)}}catch(t){K.error("Could not check notification Progress",t)}}))}(t,r.value,o,e),yield z.storage.set(`release/${e}/${t.cacheKey}`,{timestamp:Date.now(),value:o,mode:n,finished:l})}))}(t,this.type,t.progressMode));const e=yield et.storage.get(`release/${this.type}/${this.cacheKey}`);this.logger.m("Init Release").log(e),e&&(function(t){if(t&&t.timestamp){const e=(new Date).getTime()-t.timestamp;if(t.finished&&e<6048e5)return!1;if(!t.value&&e<864e5)return!1;if(e<864e5)return!1}return!0}(e)?this.logger.log("Too old"):this.releaseItem=e)}))}getProgressCurrentEpisode(){const t=this.releaseItem;return t&&t.value&&t.value.lastEp&&t.value.lastEp.total?t.value.lastEp.total:null}isProgressFinished(){const t=this.releaseItem;return!(!t||!t.finished)}getProgressPrediction(){const t=this.releaseItem;return t&&t.value&&t.value.predicition&&t.value.predicition.timestamp?t.value.predicition.timestamp:null}getProgressLastTimestamp(){const t=this.releaseItem;return t&&t.value&&t.value.lastEp&&t.value.lastEp.timestamp?t.value.lastEp.timestamp:null}init(t=!1){return nt(this,void 0,void 0,(function*(){return yield Promise.all([this.initReleaseProgress(t)]),this}))}getCurrentEpisode(){return et.settings.get("epPredictions")?this.getProgressCurrentEpisode():null}isFinished(){return this.isProgressFinished()}isAiring(){return!this.isFinished()}getPredictionTimestamp(){return!this.getProgressPrediction()||(new Date).getTime()>this.getProgressPrediction()?NaN:this.getProgressPrediction()}getPrediction(){return Q(this.getPredictionTimestamp())}getPredictionText(){const t=this.getPrediction();return t?et.storage.lang(`prediction_Episode_${this.type}`,[t]):""}getLastTimestamp(){return this.getProgressLastTimestamp()}getLast(t=!0){return Q(this.getLastTimestamp(),t)}getLastText(){const t=this.getLast(!1);return t?et.storage.lang(`prediction_Last_${this.type}`,[t]):""}getAuto(){const t=this.getPrediction();if(t)return t;return this.getLast()||""}getAutoText(){const t=this.getPredictionText();if(t)return t;return this.getLastText()||""}getColor(){return"#f57c00"}getBars(t,e){const n=this.getCurrentEpisode(),i={totalWidth:100,epWidth:0,predWidth:0};if(!e)if(i.totalWidth=0,t&&(!n||t>=n))e=Math.ceil(1.2*t);else{if(!n||t&&!(t<n))return i;e=Math.ceil(1.2*n)}return t&&(i.epWidth=t/e*100,i.epWidth>100&&(i.epWidth=100)),n&&(i.predWidth=n/e*100,i.predWidth>100&&(i.predWidth=100)),i}}class rt extends Error{constructor(t){const e=t.split("/");let n=t;e.length>2&&e[2],super(n),this.url=t,this.name="MissingPlayerError"}}class st extends Error{constructor(t){super(t),this.name="SafeError"}}class at extends Error{constructor(t){super(t),this.name="MissingDataError"}}class ot extends Error{constructor(t){super(t),this.name="CustomDomainError"}}var lt=n(58339);const ct={ui:{module:"dropdown"},getOptions:()=>[{value:0,label:lt.storage.lang("UI_Score_Not_Rated")},{value:100,label:lt.storage.lang("UI_Score_Masterpiece")},{value:90,label:lt.storage.lang("UI_Score_Great")},{value:80,label:lt.storage.lang("UI_Score_VeryGood")},{value:70,label:lt.storage.lang("UI_Score_Good")},{value:60,label:lt.storage.lang("UI_Score_Fine")},{value:50,label:lt.storage.lang("UI_Score_Average")},{value:40,label:lt.storage.lang("UI_Score_Bad")},{value:30,label:lt.storage.lang("UI_Score_VeryBad")},{value:20,label:lt.storage.lang("UI_Score_Horrible")},{value:10,label:lt.storage.lang("UI_Score_Appalling")}],valueToOptionValue:t=>t?t<10?10:10*Math.round(t/10):0,optionValueToValue:t=>t?Number(t):0};var ut=n(9e4),ht=n(58339),dt=n(9375),pt=n(19947),mt=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};Object.seal(g);class ft{constructor(t){return this.url=t,this.type=null,this.rewatchingSupport=!0,this.ids={mal:NaN,ani:NaN,kitsu:{id:NaN,slug:""},simkl:NaN},this.options=null,this.progress=!1,this.updateProgress=!1,this._onList=!1,this._authenticated=!1,this.handleUrl(t),this.logger=ut.m("[S]","#348fff"),this}getType(){return this.type}getUrl(){return this.url}supportsRewatching(){return this.rewatchingSupport}getApiCacheKey(){return this.getKey(["ANILIST"])}getRulesCacheKey(){return this.getKey(["ANILIST","KITSU"],!1)}setStatus(t){return t=Number(t),this._setStatus(t),this}getStatus(){return this.isOnList()?this._getStatus():e.NoState}getScoreMode(){return ct}setScore(t){return(t=parseInt(`${t}`))||(t=0),this._setScore(t),this}getScore(){return this._getScore()||0}setAbsoluteScore(t){return t=parseInt(`${t}`),this._setAbsoluteScore(t),this}getAbsoluteScore(){return this._getAbsoluteScore()||0}setEpisode(t){return t=parseInt(`${t}`),this.getTotalEpisodes()&&t>this.getTotalEpisodes()&&(t=this.getTotalEpisodes()),this._setEpisode(t),this}getEpisode(){return this._getEpisode()}setVolume(t){return this._setVolume(t),this}getVolume(){return this._getVolume()}setStreamingUrl(t){return this.options&&(this.options.u=t),this}getStreamingUrl(){if(this.options&&this.options.u)return this.options.u}cleanTags(){this.options=null}initProgress(){return mt(this,void 0,void 0,(function*(){const t=yield X(this.getType(),this.getApiCacheKey());return new it(this.getCacheKey(),this.getType()).init({uid:this.getCacheKey(),apiCacheKey:this.getApiCacheKey(),title:this.getTitle(),cacheKey:this.getCacheKey(),progressMode:this.getProgressMode(),watchedEp:this.getEpisode(),single:this,xhr:t}).then((e=>{this.updateProgress=!1,this.progress=e,this.progressXhr=t}))}))}getProgress(){return!!this.progress&&this.progress}getProgressFormated(){const t=[],e=new Intl.DisplayNames("en",{type:"language"});return ut.log(this.progressXhr),this.progressXhr&&Object.keys(this.progressXhr).length&&this.progressXhr.forEach((n=>{t.push({type:n.type,key:n.id,state:n.state,label:e.of(n.lang.replace(/^jp$/,"ja"))||n.lang,dropped:"dropped"===n.state||"discontinued"===n.state,episode:n.lastEp&&n.lastEp.total?n.lastEp.total:0,lastEp:n.lastEp,predicition:n.prediction})})),t}getProgressOptions(){return this.getProgressFormated().filter((t=>"complete"!==t.state))}getProgressCompleted(){return this.getProgressFormated().filter((t=>"complete"===t.state))}getProgressMode(){return this.options&&this.options.p?this.options.p:""}setProgressMode(t){this.options&&(this.options.p=t,this.updateProgress=!0),ht.settings.get("malTags")||dt.setEntrySettings(this.type,this.getCacheKey(),this.options,this._getTags()).then((()=>this.initProgress()))}getProgressKey(){let t=this.getProgressMode();if(t||(t="anime"===this.getType()?ht.settings.get("progressIntervalDefaultAnime"):ht.settings.get("progressIntervalDefaultManga")),!t)return null;const e=/^([^/]*)\/(.*)$/.exec(t);return e?{key:t,lang:e[1],type:e[2]}:null}getPageRelations(){const t=this.shortName,e=[];return this.ids.mal&&"MAL"!==t&&e.push({name:"MAL",icon:"https://cdn.myanimelist.net/images/favicon.ico",link:`https://myanimelist.net/${this.type}/${this.ids.mal}`}),this.ids.ani&&"AniList"!==t&&e.push({name:"AniList",icon:"https://anilist.co/img/icons/favicon-32x32.png",link:`https://anilist.co/${this.type}/${this.ids.ani}`}),this.ids.kitsu.id&&"Kitsu"!==t&&e.push({name:"Kitsu",icon:"https://kitsu.io/favicon-32x32-3e0ecb6fc5a6ae681e65dcbc2bdf1f17.png",link:`https://kitsu.io/${this.type}/${this.ids.kitsu.id}`}),this.ids.simkl&&"Simkl"!==t&&e.push({name:"Simkl",icon:"https://eu.simkl.in/img_favicon/v2/favicon-32x32.png",link:`https://simkl.com/${this.type}/${this.ids.simkl}`}),e}fillRelations(){return Promise.resolve()}update(){return this.logger.log("[SINGLE]","Update info",this.ids),this.lastError=null,this._update().catch((t=>{throw this.lastError=t,t})).then((()=>(this.persistanceState=this.getStateEl(),dt.getEntrySettings(this.type,this.getCacheKey(),this._getTags())))).then((t=>{this.options=t,this.registerEvent(),this.emitUpdate("state")}))}sync(){return mt(this,void 0,void 0,(function*(){return this.logger.log("[SINGLE]","Sync",this.ids),this.lastError=null,this._setTags(yield dt.setEntrySettings(this.type,this.getCacheKey(),this.options,this._getTags())),this._sync().catch((t=>{throw this.lastError=t,t})).then((()=>{this.undoState=this.persistanceState,this.updateProgress&&this.initProgress(),this._onList=!0,this.emitUpdate()}))}))}emitUpdate(t="update"){_(`${t}.${this.getCacheKey()}`,{id:this.getPageId(),type:this.getType(),cacheKey:this.getCacheKey(),state:this.getStateEl(),meta:{title:this.getTitle(),image:this.getImage(),malId:this.getMalId(),totalEp:this.getTotalEpisodes(),url:this.getUrl()}})}delete(){return mt(this,void 0,void 0,(function*(){return this._delete().then((()=>{this._onList=!1,_(`delete.${this.getCacheKey()}`,{id:this.getPageId(),type:this.getType(),cacheKey:this.getCacheKey()})}))}))}registerEvent(){this.globalUpdateEvent||(this.globalUpdateEvent=g.on(`update.${this.getCacheKey()}`,(t=>this.updateEvent(t))))}updateEvent(t){this.isDirty()?this.logger.log("Ignore event"):t&&t.state&&(this.setStateEl(t.state),this.persistanceState=this.getStateEl(),g.emit("syncPage_fillUi"))}isDirty(){return JSON.stringify(this.persistanceState)!==JSON.stringify(this.getStateEl())||this.updateProgress}undo(){if(this.logger.log("[SINGLE]","Undo",this.undoState),!this.undoState)throw new st("No undo state found");if(!this.undoState.onList){if(void 0===this.delete)throw new Error("Deleting an entry is not supported");return this.delete().then((()=>{this.setStateEl(this.undoState),this.undoState=null}))}return this.setStateEl(this.undoState),this.sync().then((()=>{this.undoState=null}))}getTitle(t=!1){return this._getTitle(t)}getTotalEpisodes(){let t=this._getTotalEpisodes();return t||(t=0),t}getTotalVolumes(){return this._getTotalVolumes()}isOnList(){return this._onList}isAuthenticated(){return this._authenticated}getDisplayUrl(){return this._getDisplayUrl()}getMalUrl(){return Number.isNaN(this.ids.mal)?null:`https://myanimelist.net/${this.getType()}/${this.ids.mal}`}getMalId(){return Number.isNaN(this.ids.mal)?null:this.ids.mal}getIds(){return this.ids}getImage(){return this._getImage()}getRating(){return this._getRating().then((t=>t||"N/A"))}setResumeWatching(t,e){return dt.setResumeWaching(t,e,this.type,this.getCacheKey())}getResumeWatching(){return this.options&&this.options.r?this.options.r:null}setContinueWatching(t,e){return dt.setContinueWaching(t,e,this.type,this.getCacheKey())}getContinueWatching(){return this.options&&this.options.c?this.options.c:null}increaseRewatchCount(){}getStateEl(){return{onList:this.isOnList(),episode:this.getEpisode(),volume:this.getVolume(),status:this.getStatus(),score:this.getScore(),absoluteScore:this.getAbsoluteScore()}}setStateEl(t){this._onList=t.onList,this.setEpisode(t.episode),this.setVolume(t.volume),this.setStatus(t.status),this.setScore(t.score),t.absoluteScore&&this.setAbsoluteScore(t.absoluteScore)}getStateDiff(){const t=this.getStateEl();if(t&&this.undoState){const e={};for(const n in t)t[n]!==this.undoState[n]&&(e[n]=t[n]);return e}}checkSync(t,n){return mt(this,void 0,void 0,(function*(){const i=this.getEpisode(),r=this.getStatus(),s=this.getVolume();return r===e.Completed?1===t&&this.startRewatchingMessage():!(i>=t&&!(void 0!==n&&(s||n>1||!t)&&n>s))&&(t&&t===this.getTotalEpisodes()?(r===e.Rewatching?yield this.finishRewatchingMessage():yield this.finishWatchingMessage(),!0):r===e.Watching||r===e.Rewatching||this.startWatchingMessage())}))}startWatchingMessage(){return mt(this,void 0,void 0,(function*(){return dt.flashConfirm(ht.storage.lang(`syncPage_flashConfirm_start_${this.getType()}`),"add").then((t=>(t&&this.setStatus(e.Watching),t)))}))}finishWatchingMessage(){return mt(this,void 0,void 0,(function*(){const t=this.getScoreCheckboxValue();let n='<div><select id="finish_score" style="margin-top:5px; color:white; background-color:#4e4e4e; border: none;">';return this.getScoreCheckbox().forEach((e=>{n+=`<option value="${e.value}" ${t===e.value?"selected":""}>${e.label}</option>`})),n+="</select></div>",dt.flashConfirm(ht.storage.lang("syncPage_flashConfirm_complete")+n,"complete").then((t=>(t&&(this.setStatus(e.Completed),Number(pt.$("#finish_score").val())>0&&(this.logger.log(`finish_score: ${pt.$("#finish_score :selected").val()}`),this.handleScoreCheckbox(pt.$("#finish_score :selected").val()))),t)))}))}startRewatchingMessage(){return mt(this,void 0,void 0,(function*(){return dt.flashConfirm(ht.storage.lang(`syncPage_flashConfirm_rewatch_start_${this.getType()}`),"add").then((t=>(t&&this.setStatus(e.Rewatching),t)))}))}finishRewatchingMessage(){return mt(this,void 0,void 0,(function*(){return dt.flashConfirm(ht.storage.lang(`syncPage_flashConfirm_rewatch_finish_${this.getType()}`),"complete").then((t=>(t&&(this.setStatus(e.Completed),this.increaseRewatchCount()),t)))}))}getScoreCheckbox(){return this.getScoreMode().getOptions()}getScoreCheckboxValue(){return this.getScoreMode().valueToOptionValue(this.getAbsoluteScore())}handleScoreCheckbox(t){this.setAbsoluteScore(this.getScoreMode().optionValueToValue(t))}getDisplayScoreCheckbox(){const t=this.getScoreCheckboxValue(),e=this.getScoreCheckbox().filter((e=>e.value===t));return e.length?e[0].label:""}getStatusCheckbox(){const t=[{value:"1",label:ht.storage.lang(`UI_Status_watching_${this.getType()}`)},{value:"2",label:ht.storage.lang("UI_Status_Completed")},{value:"3",label:ht.storage.lang("UI_Status_OnHold")},{value:"4",label:ht.storage.lang("UI_Status_Dropped")},{value:"6",label:ht.storage.lang(`UI_Status_planTo_${this.getType()}`)}];return this.rewatchingSupport&&t.push({value:"23",label:ht.storage.lang(`UI_Status_Rewatching_${this.getType()}`)}),t}handleStatusCheckbox(t){this.setStatus(t)}getStatusCheckboxValue(){return this.getStatus()}getKey(t,e=!0){return e&&this.ids.mal?this.ids.mal:this.ids.ani&&t.includes("ANILIST")?`anilist:${this.ids.ani}`:this.ids.kitsu.id&&t.includes("KITSU")?`kitsu:${this.ids.kitsu.id}`:this.ids.simkl&&t.includes("SIMKL")?`simkl:${this.ids.simkl}`:this.ids.mal}getLastError(){return this.lastError}getLastErrorMessage(){return this.errorMessage(this.getLastError())}flashmError(t){dt.flashm(this.errorMessage(t),{error:!0,type:"error"})}errorMessage(t){return x(t,this.authenticationUrl)}}var gt=n(58339);const _t={ui:{module:"dropdown"},getOptions(){const t=[{value:0,label:gt.storage.lang("UI_Score_Not_Rated")}];for(let e=2;e<21;e++)t.push({value:5*e,label:(e/2).toFixed(1).toString()});return t},valueToOptionValue:t=>t?t<10?10:5*Math.round(Number(t)/5):0,optionValueToValue:t=>t?Number(t):0};var yt=n(58339);const vt={ui:{module:"click",type:"smiley"},getOptions:()=>[{value:0,label:yt.storage.lang("UI_Score_Not_Rated")},{value:100,label:""},{value:70,label:""},{value:40,label:""},{value:10,label:""}],valueToOptionValue:t=>t?t<25?10:t<55?40:t<85?70:100:0,optionValueToValue:t=>t?Number(t):0};var bt=n(58339);const wt={ui:{module:"dropdown"},getOptions(){const t=[{value:0,label:bt.storage.lang("UI_Score_Not_Rated")}];for(let e=1;e<11;e++)t.push({value:10*e,label:(e/2).toFixed(1).toString()});return t},valueToOptionValue:t=>t?t<10?10:10*Math.round(t/10):0,optionValueToValue:t=>t?Number(t):0};var Et=n(9e4),St=n(9375),xt=n(58339),kt=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};class Tt extends ft{constructor(t){return super(t),this.url=t,this.shortName="Kitsu",this.authenticationUrl="https://kitsu.io/404?mal-sync=authentication",this.logger=Et.m(this.shortName,"#d65e43"),this}listI(){return this.animeInfo.data[0]}animeI(){return this.animeInfo.included[0]}handleUrl(t){if(t.match(/kitsu\.io\/(anime|manga)\/.*/i))return this.type="anime"===St.urlPart(t,3)?"anime":"manga",void(this.ids.kitsu.slug=St.urlPart(t,4));if(t.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===St.urlPart(t,3)?"anime":"manga",void(this.ids.mal=Number(St.urlPart(t,4)));throw new b(t)}getCacheKey(){return this.getKey(["KITSU"])}getPageId(){return this.ids.kitsu.id}_getStatus(){return this.listI().attributes.reconsuming&&"current"===this.listI().attributes.status?23:parseInt(M(this.listI().attributes.status))}_setStatus(t){23===t?(t=1,this.listI().attributes.reconsuming=!0):this.listI().attributes.reconsuming=!1,this.listI().attributes.status=M(t,parseInt(t.toString()))}_getScore(){if(!this.listI().attributes.ratingHundred)return 0;const t=Math.round(this.listI().attributes.ratingHundred/10);return 0===t?1:t}_setScore(t){this.listI().attributes.ratingHundred=t?10*t:null}_getAbsoluteScore(){return Number(this.listI().attributes.ratingHundred)}_setAbsoluteScore(t){this.listI().attributes.ratingHundred=Number(t)}_getTwentyScore(){const t=this.listI().attributes.ratingHundred;return t?t<5?1:Math.round(t/5):null}_getEpisode(){return this.listI().attributes.progress}_setEpisode(t){this.listI().attributes.progress=parseInt(`${t}`)}_getVolume(){return this.listI().attributes.volumesOwned}_setVolume(t){this.listI().attributes.volumesOwned=t}_getTags(){let t=this.listI().attributes.notes;return null!==t&&"null"!==t||(t=""),t}_setTags(t){this.listI().attributes.notes=t}_getTitle(){try{return j(this.animeI().attributes.titles,this.animeI().attributes.canonicalTitle)}catch(t){return console.error("title",t),"Failed"}}_getTotalEpisodes(){const t=this.animeI().attributes.episodeCount?this.animeI().attributes.episodeCount:this.animeI().attributes.chapterCount;return null===t?0:t}_getTotalVolumes(){return this.animeI().attributes.volumeCount||0}_getDisplayUrl(){return`https://kitsu.io/${this.getType()}/${this.animeI().attributes.slug}`}_getImage(){return this.animeI().attributes.posterImage&&this.animeI().attributes.posterImage.large?this.animeI().attributes.posterImage.large:""}_getRating(){return null===this.animeI().attributes.averageRating?Promise.resolve(""):Promise.resolve(`${this.animeI().attributes.averageRating}%`)}_update(){return kt(this,void 0,void 0,(function*(){if(Number.isNaN(this.ids.mal)){var t=yield this.kitsuSlugtoKitsu(this.ids.kitsu.slug,this.getType());try{this.ids.kitsu.id=Number(t.res.data[0].id),this.ids.mal=Number(t.malId)}catch(t){throw this._authenticated=!0,new E("Not found")}}if(Number.isNaN(this.ids.kitsu.id)){var e=yield this.malToKitsu(this.ids.mal,this.getType());try{this.ids.kitsu.id=Number(e.data[0].relationships.item.data.id)}catch(t){throw this._authenticated=!0,new E("Not found")}}return this._authenticated=!0,this.userId().then((t=>this.apiCall("GET",`https://kitsu.io/api/edge/library-entries?filter[user_id]=${t}&filter[kind]=${this.getType()}&filter[${this.getType()}_id]=${this.ids.kitsu.id}&page[limit]=1&page[limit]=1&include=${this.getType()}&fields[${this.getType()}]=slug,titles,canonicalTitle,averageRating,posterImage,${"anime"===this.getType()?"episodeCount":"chapterCount,volumeCount"}`))).catch((t=>{if(t instanceof v)return this._authenticated=!1,{data:[],included:[]};throw t})).then((n=>kt(this,void 0,void 0,(function*(){const i=n;this._onList=!0,n.data.length||(this._onList=!1,i.data[0]={attributes:{notes:"",progress:0,volumesOwned:0,reconsuming:!1,reconsumeCount:!1,ratingTwenty:null,status:"planned"}},void 0!==e?i.included=e.included:t?i.included=t.res.data:(e=yield this.malToKitsu(this.ids.mal,this.getType()),i.included=e.included)),i.data[0].attributes.ratingHundred?i.data[0].attributes.ratingHundred=0:i.data[0].attributes.ratingHundred=Number(5*i.data[0].attributes.ratingTwenty),this.animeInfo=i;try{this.animeI()}catch(t){throw this.logger.error(t),new E("Not found")}if(!this._authenticated)throw new v("Not Authenticated")}))))}))}_sync(){return kt(this,void 0,void 0,(function*(){const t={data:{attributes:{notes:this.listI().attributes.notes,progress:this.listI().attributes.progress,volumesOwned:this.listI().attributes.volumesOwned,reconsuming:this.listI().attributes.reconsuming,reconsumeCount:this.listI().attributes.reconsumeCount,ratingTwenty:this._getTwentyScore(),status:this.listI().attributes.status},type:"library-entries"}},e=this.getType();if(!e)return Promise.resolve();let n,i;return this.isOnList()?(n=`https://kitsu.io/api/edge/library-entries/${this.listI().id}`,t.data.id=this.listI().id,i="PATCH"):(n="https://kitsu.io/api/edge/library-entries/",t.data.relationships={[e]:{data:{type:e,id:this.ids.kitsu.id}},user:{data:{type:"users",id:yield this.userId()}}},i="POST"),this.logger.log(i,t),this.apiCall(i,n,t).then((t=>(t&&t.data&&t.data.id&&(this.listI().id=t.data.id),t)))}))}apiCall(t,e,n={},i=!0){return G(t,e,n,i).catch((t=>{if(t instanceof v)throw new v(t.message);throw t}))}kitsuSlugtoKitsu(t,e){return this.apiCall("Get",`https://kitsu.io/api/edge/${e}?filter[slug]=${t}&page[limit]=1&include=mappings`,{}).catch((n=>{if(n instanceof v)return this._authenticated=!1,this.apiCall("Get",`https://kitsu.io/api/edge/${e}?filter[slug]=${t}&page[limit]=1&include=mappings`,{},!1);throw n})).then((t=>{let n=NaN;if(void 0!==t&&void 0!==t.included)for(let i=0;i<t.included.length;i++){const r=t.included[i];if("mappings"===r.type){if(r.attributes.externalSite===`myanimelist/${e}`){n=Number(r.attributes.externalId),t.included.splice(i,1);break}r.attributes.externalSite===`anilist/${e}`&&(this.ids.ani=Number(r.attributes.externalId))}}return{res:t,malId:n}}))}malToKitsu(t,e){return this.apiCall("Get",`https://kitsu.io/api/edge/mappings?filter[externalSite]=myanimelist/${e}&filter[externalId]=${t}&include=item&fields[item]=id`,{}).catch((n=>{if(n instanceof v)return this._authenticated=!1,this.apiCall("Get",`https://kitsu.io/api/edge/mappings?filter[externalSite]=myanimelist/${e}&filter[externalId]=${t}&include=item&fields[item]=id`,{},!1);throw n})).then((t=>t))}userId(){return kt(this,void 0,void 0,(function*(){const t=yield xt.storage.get("kitsuUserId");return void 0!==t&&t?t:this.apiCall("Get","https://kitsu.io/api/edge/users?filter[self]=true").then((t=>{if(void 0===t.data||!t.data.length||void 0===t.data[0])throw new v("Not Authenticated");return xt.storage.set("kitsuUserId",t.data[0].id),t.data[0].id}))}))}getScoreMode(){switch(xt.settings.get("kitsuOptions").ratingSystem){case"simple":return vt;case"regular":return wt;case"advanced":return _t;default:return ct}}_delete(){return this.apiCall("DELETE",`https://kitsu.io/api/edge/library-entries/${this.listI().id}`)}}var $t=n(58339),Nt=n(9e4),It=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};const Rt=n(16245);function At(t,e,n){return function(t,e){let n=e.trim(),i=[];const r=t.match(/{searchterm(\(.\))?(\[[^[\]]*\])?}/);if(!r)return t;const[s,a,o]=r;return o&&(i=o.substring(1,o.length-1).split(",")),i.includes("noLowercase")||(n=n.toLowerCase()),i.includes("noSpecial")?n=n.replace(/[^a-zA-Z\d ]/g,"").replace(/ +/g," ").trim():i.includes("specialReplace")&&(n=n.replace(/[^a-zA-Z\d ]/g," ").replace(/ +/g," ").trim()),n=i.includes("noEncode")?n.replace(/\//g," "):encodeURIComponent(n),a&&(n=n.replace(/(%20| )/g,a[1])),t.replace(s,n)}(t.replace("{searchtermPlus}","{searchterm(+)}").replace("{searchtermMinus}","{searchterm(-)}").replace("{searchtermUnderscore}","{searchterm(_)}").replace("{searchtermRaw}","{searchterm[noEncode,noLowercase]}").replace("{cacheId}",n),e)}function Ct(t,e,n){return It(this,void 0,void 0,(function*(){let i=function(){const t=$t.settings.get("quicklinks").map((t=>{return(e=t)?e.custom?e:Rt.find((t=>t.name===e)):null;var e})).filter((t=>t));return JSON.parse(JSON.stringify(t))}();if(e)try{i=yield function(t,e,n){return It(this,void 0,void 0,(function*(){const i=yield function(t,e){return It(this,void 0,void 0,(function*(){const n=`https://api.malsync.moe/mal/${t}/${e}`;return $t.request.xhr("GET",n).then((t=>It(this,void 0,void 0,(function*(){if(Nt.log("malSync response",t),400===t.status)return{};if(200===t.status){const e=JSON.parse(t.responseText);return e&&e.Sites?e.Sites:{}}throw new Error("malsync offline")}))))}))}(e,n);return t.map((t=>(t.database&&i[t.database]&&(t.databaseLinks=i[t.database]),t)))}))}(i,t,e)}catch(t){Nt.m("API Problem").error(t)}return function(t,e,n,i){return t.filter((t=>t.search&&t.search[e])).map((t=>{const r=[];let s;return t.databaseLinks?(s="link",Object.values(t.databaseLinks).forEach((t=>{r.push({name:t.title,url:t.url})}))):"home"===t.search[e]?(s="home",r.push({name:"Homepage",url:t.domain})):(s="search",r.push({name:"Quicksearch",url:At(t.search[e],n,i),fn:n=>At(t.search[e],n,i)})),{name:t.name,domain:t.domain,group:s,links:r}}))}(i,t,n,e)}))}var Pt=n(9375),Ot=n(9375),Lt=n(58339),Dt=n(9e4),Ut=n(19947),Mt=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};class jt{constructor(t){this.url=t,this.page=null,this.same=!1,this.authError=!1,this.tempAnimelist=null,this.tempMangalist=null;let e=window.location.href.split("/").slice(0,5).join("/");Ot.changeDetect((()=>{if(this.same=!1,null!==this.page&&"detail"===this.page.page){const t=window.location.href.split("/").slice(0,5).join("/");t===e&&(this.same=!0),e=t}this.url=window.location.href,this.init()}),(()=>null!==this.page&&"bookmarks"===this.page.page&&$(".library-content").length?$(".library-content").first().height():window.location.href)),$(document).ready((()=>{Ot.waitUntilTrue((function(){return $(".global-container").length}),(()=>{this.init()}))})),Lt.storage.addStyle(n(18527).toString())}init(){return Mt(this,void 0,void 0,(function*(){yield(0,Pt.waitForPageToBeVisible)(),this.url.indexOf("?mal-sync=authentication")>-1&&this.authentication();const t=Ot.urlPart(this.url,3);if(("anime"===t||"manga"===t)&&Ot.urlPart(this.url,4)){if(this.same&&void 0!==this.page&&"undefined"!==this.page.malObj)return this.streamingUI(),this.malToKiss(),void this.pageRelation();const e=new Tt(this.url);yield e.update(),this.page={page:"detail",id:e.getIds().kitsu.id,malid:e.getIds().mal,apiCacheKey:e.getApiCacheKey(),type:t,malObj:e},Dt.log("page",this.page),this.streamingUI(),this.malToKiss(),this.pageRelation()}if("library"===Ot.urlPart(this.url,5)){let t="anime";"manga"===Ot.urlParam(this.url,"media")&&(t="manga"),this.page={page:"bookmarks",type:t},Dt.log("page",this.page),this.bookmarks()}}))}authentication(){try{Ot.checkDoubleExecution()}catch(t){Dt.error(t)}$(document).ready((function(){$("body").after(Ut.html(`\n        <div id="mal-sync-login" style="text-align: center; margin-top: 50px; background-color: white; border: 1px solid lightgrey; padding: 10px; max-width: 600px; margin-left: auto; margin-right: auto;">\n          <h1>MAL-Sync</h1>\n          <br>\n          <p style="text-align: left;">\n            ${Lt.storage.lang("kitsuClass_authentication_text")}\n          </p>\n          <div class="modal-content">\n            <input type="email" id="email" placeholder="Email" required>\n            <input type="password" id="pass" name="password" placeholder="${Lt.storage.lang("kitsuClass_authentication_Password")}" required>\n          </div>\n          <div class="form-cta" style="margin-top: 30px;">\n            <button class="btn button--primary" type="submit" id="mal-sync-button">\n              ${Lt.storage.lang("kitsuClass_authentication_Login")}\n            </button>\n          </div>\n        </div>\n      `)),$("#mal-sync-login #mal-sync-button").click((function(){$("#mal-sync-login #mal-sync-button").attr("disabled","disabled"),$.ajax({type:"POST",url:"https://kitsu.io/api/oauth/token",data:`grant_type=password&username=${encodeURIComponent(String($("#mal-sync-login #email").val()))}&password=${encodeURIComponent(String($("#mal-sync-login #pass").val()))}`,success(t){return Mt(this,void 0,void 0,(function*(){const e=t.access_token;e&&(Dt.info("token",e),yield Lt.settings.set("kitsuToken",e),$("#mal-sync-login").html(Ut.html(`<h1>MAL-Sync</h1><br>${Lt.storage.lang("kitsuClass_authentication_Success")}`)))}))},error(t){try{if(Dt.error(t),$("#mal-sync-login #mal-sync-button").prop("disabled",!1),"invalid_grant"===t.responseJSON.error)return void Ot.flashm(Lt.storage.lang("kitsuClass_authentication_Wrong"));Ot.flashm(t.responseJSON.error_description)}catch(e){Dt.error(e),Ot.flashm(t.responseText)}}})})),Ot.waitUntilTrue((function(){return $("body h1").length}),(()=>{$("body h1").remove()}))}))}getMalUrl(){return Mt(this,void 0,void 0,(function*(){return null!==this.page&&"detail"===this.page.page&&this.page.malid?`https://myanimelist.net/${this.page.type}/${this.page.malid}/${Ot.urlPart(this.url,5)}`:""}))}streamingUI(){return Mt(this,void 0,void 0,(function*(){Dt.log("Streaming UI"),$("#mal-sync-stream-div").remove();const{malObj:t}=this.page,e=t.getStreamingUrl();e&&$(document).ready((function(){return Mt(this,void 0,void 0,(function*(){$(".media--title h3").first().after(Ut.html(`\n        <div class="data title progress" id="mal-sync-stream-div" style="display: inline-block; position: relative; top: -4px; display: inline;">\n          <a class="mal-sync-stream" title="${e.split("/")[2]}" target="_blank" style="margin: 0 0;" href="${e}">\n            <img src="${Ot.favicon(e.split("/")[2])}">\n          </a>\n        </div>`));const n=t.getResumeWatching(),i=t.getContinueWatching();Dt.log("Resume",n,"Continue",i),i&&i.ep===t.getEpisode()+1?$("#mal-sync-stream-div").append(Ut.html(`<a class="nextStream" title="${Lt.storage.lang(`overview_Continue_${t.getType()}`)}" target="_blank" style="margin: 0 5px 0 0; color: #BABABA;" href="${i.url}">\n              <img src="${Lt.storage.assetUrl("double-arrow-16px.png")}" width="16" height="16">\n            </a>`)):n&&n.ep===t.getEpisode()&&$("#mal-sync-stream-div").append(Ut.html(`<a class="resumeStream" title="${Lt.storage.lang(`overview_Resume_Episode_${t.getType()}`)}" target="_blank" style="margin: 0 5px 0 0; color: #BABABA;" href="${n.url}">\n              <img src="${Lt.storage.assetUrl("arrow-16px.png")}" width="16" height="16">\n            </a>`))}))}))}))}getImage(){return Ut.$(".media-poster img").attr("src")||""}getTitle(){return $('meta[property="og:title"]').attr("content")||""}malToKiss(){$(document).ready((()=>{Dt.log("malToKiss"),$(".mal_links").remove();const t=this.getTitle();Ct(this.page.type,this.page.apiCacheKey,t).then((t=>{let e="";t.forEach((t=>{let n="";t.links.forEach((t=>{n+=`\n              <div class="mal_links" style="margin-top: 5px;">\n                <a target="_blank" href="${t.url}">\n                  ${t.name}\n                </a>\n              </div>`})),e+=`\n            <div id="${t.name}Links" class="mal_links library-state with-header" style="\n              background: white;\n              margin-bottom: 15px;\n              border-radius: 3px;\n              display: block;\n              padding: 8px 12px;\n              width: 100%;\n              font-size: 12px;\n              word-break: break-all;\n            ">\n              <img src="${Ot.favicon(t.domain)}">\n              <span style="font-weight: 500; line-height: 16px; vertical-align: middle;">${t.name}</span>\n              <span title="${t.name}" class="remove-mal-sync" style="float: right; cursor: pointer;">x</span>\n              ${n}\n            </div>`})),$("#mal-sync-search-links").length?$("#mal-sync-search-links").first().after(Ut.html(e)):$(".media-summary").first().after(Ut.html(e)),$(".remove-mal-sync").click((function(){const t=$(this).attr("title");!function(t){const e=$t.settings.get("quicklinks");$t.settings.set("quicklinks",function(t,e){return e?t.filter((t=>!(!t||t===e||"object"==typeof t&&t.name===e))):t}(e,t))}(String(t)),window.location.reload()}))}))}))}pageRelation(){return Mt(this,void 0,void 0,(function*(){$(".malsync-rel-link").remove(),yield this.page.malObj.fillRelations(),$(".media-summary h5").first().append(Ut.html('<div class="malsync-rel-link" style="display: inline-block; margin: 0 5px; vertical-align: bottom;"></div>')),this.page.malObj.getPageRelations().forEach((t=>{$(".malsync-rel-link").append(Ut.html(`\n          <a href="${t.link}" target="_blank" title="${t.name}" class="link">\n            <img src="${t.icon}" width="16" height="16">\n          </a>\n\n        `))}))}))}bookmarks(){if(this.authError)return;const t=this;$(document).ready((()=>{if("anime"===this.page.type){if(null!==this.tempAnimelist)return void n(this.tempAnimelist)}else if(null!==this.tempMangalist)return void n(this.tempMangalist);const e=new H(1,this.page.type);function n(e){let n=!0;$(".library-list tbody tr").length&&(n=!1),Dt.log(e),$.each(e,((e,i)=>Mt(this,void 0,void 0,(function*(){if(Dt.log("en",i),void 0!==i.malId&&null!==i.malId&&i.malId){const e=$(`.library-grid-popover:not(.malSyncDone2) a[href^="/${t.page.type}/${i.kitsuSlug}"], .library-list tbody tr:not(.malSyncDone2) a[href^="/${t.page.type}/${i.kitsuSlug}"]`).first().parent().parent().parent();Dt.log(e),e.addClass("malSyncDone2"),i.options&&i.options.u&&(Dt.log(i.options.u),n?e.prepend(Ut.html(`\n                  <a class="mal-sync-stream mal-rem" title="${i.options.u.split("/")[2]}" target="_blank" style="margin: 0 0; z-index: 22; position:absolute; left: 0px; top: 0px; background-color: #ffffff5c; padding: 0 5px 3px 5px;" href="${i.options.u}">\n                    <img src="${Ot.favicon(i.options.u.split("/")[2])}">\n                  </a>`)):e.find(".title-wrapper").append(Ut.html(`\n                  <a class="mal-sync-stream mal-rem" title="${i.options.u.split("/")[2]}" target="_blank" style="padding: 0 5px;" href="${i.options.u}">\n                    <img src="${Ot.favicon(i.options.u.split("/")[2])}">\n                  </a>`)));const r=i.options.r,s=i.options.c,a=i.watchedEp;Dt.log("Resume",r,"Continue",s),s&&s.ep===a+1?n?e.prepend(Ut.html(`<a class="nextStream mal-rem" title="Continue watching" target="_blank" style="color: #BABABA; z-index: 22; position:absolute; top: 0px; left: 26px; background-color: #ffffff5c; padding: 0 5px 3px 5px;" href="${s.url}">\n                    <img src="${Lt.storage.assetUrl("double-arrow-16px.png")}" width="16" height="16">\n                  </a>`)):e.find(".title-wrapper").append(Ut.html(`<a class="nextStream mal-rem" title="Continue watching" target="_blank" style="padding: 0;" href="${s.url}">\n                    <img src="${Lt.storage.assetUrl("double-arrow-16px.png")}" width="16" height="16">\n                  </a>`)):r&&r.ep===a&&(n?e.prepend(Ut.html(`<a class="resumeStream mal-rem" title="Resume watching" target="_blank" style="color: #BABABA; z-index: 22; position:absolute; top: 0px; left: 26px; background-color: #ffffff5c; padding: 0 5px 3px 5px;" href="${r.url}">\n                    <img src="${Lt.storage.assetUrl("arrow-16px.png")}" width="16" height="16">\n                  </a>`)):e.find(".title-wrapper").append(Ut.html(`<a class="resumeStream mal-rem" title="Resume watching" target="_blank" style="padding: 0;" href="${r.url}">\n                    <img src="${Lt.storage.assetUrl("arrow-16px.png")}" width="16" height="16">\n                  </a>`))),yield i.fn.initProgress(),i.fn.progress&&i.fn.progress.isAiring()&&i.fn.progress.getCurrentEpisode()&&e.parent().find(".entry-unit, .progress-cell > span:last-of-type").first().append(Ut.html(` <span class="mal-sync-ep-pre" title="${i.fn.progress.getAutoText()}">[<span style="border-bottom: 1px dotted ${i.fn.progress.getColor()};">${i.fn.progress.getCurrentEpisode()}</span>]</span>`))}}))))}e.getCompleteList().then((t=>{"anime"===this.page.type?this.tempAnimelist=t:this.tempMangalist=t,n(t)})).catch((t=>{t instanceof v&&(this.authError=!0),Dt.error(t),e.flashmError(t)}))}))}}var Bt=n(58339),Gt=n(19947),Ft=n(9e4),Yt=n(9375),Wt=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};function qt(){return Wt(this,void 0,void 0,(function*(){const t=yield Bt.storage.get("timestampUpdate/firebaseNotification");(void 0===t||Gt.$.now()-t>6e5)&&(yield Ht(),Bt.storage.set("timestampUpdate/firebaseNotification",Gt.$.now()))}))}function Ht(){return Wt(this,void 0,void 0,(function*(){Ft.log("checkNotifications");const t=yield Bt.request.xhr("GET","https://kissanimelist.firebaseio.com/Data2/Notification/Current.json"),e=parseInt(JSON.parse(t.responseText));Number.isNaN(e)&&Ft.error("Could not read current Notification number"),Ft.log("Current Notification",e);const n=parseInt(yield Bt.storage.get("firebaseNotification")),i=n+1;if(void 0===n||Number.isNaN(n))return void Bt.storage.set("firebaseNotification",e);if(e<i)return void Ft.log("No new notifications");const r=`https://kissanimelist.firebaseio.com/Data2/Notification/list/N${i}.json`,s=yield Bt.request.xhr("GET",r);if(!s)return;const a=JSON.parse(s.responseText);if(!a)return Ft.info("Notification empty",s.responseText),void Bt.storage.set("firebaseNotification",i).then((function(){Ht()}));Gt.$(document).ready((function(){const t=Yt.flashm(`<div style="text-align: left;">${a}</div><button class="okChangelog" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">Close</button>`,{permanent:!0,position:"top"});t.find(".okChangelog").click((function(){t.remove(),Bt.storage.set("firebaseNotification",i).then((function(){Ht()}))}))}))}))}class zt extends Error{constructor(t,e="warn"){super(t),this.message=t,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=e}}const Kt=Object.prototype.toString;function Vt(t){switch(Kt.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return re(t,Error)}}function Jt(t,e){return Kt.call(t)===`[object ${e}]`}function Xt(t){return Jt(t,"ErrorEvent")}function Zt(t){return Jt(t,"DOMError")}function Qt(t){return Jt(t,"String")}function te(t){return null===t||"object"!=typeof t&&"function"!=typeof t}function ee(t){return Jt(t,"Object")}function ne(t){return"undefined"!=typeof Event&&re(t,Event)}function ie(t){return Boolean(t&&t.then&&"function"==typeof t.then)}function re(t,e){try{return t instanceof e}catch(t){return!1}}var se;function ae(t){return new le((e=>{e(t)}))}function oe(t){return new le(((e,n)=>{n(t)}))}!function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"}(se||(se={}));class le{__init(){this._state=se.PENDING}__init2(){this._handlers=[]}constructor(t){le.prototype.__init.call(this),le.prototype.__init2.call(this),le.prototype.__init3.call(this),le.prototype.__init4.call(this),le.prototype.__init5.call(this),le.prototype.__init6.call(this);try{t(this._resolve,this._reject)}catch(t){this._reject(t)}}then(t,e){return new le(((n,i)=>{this._handlers.push([!1,e=>{if(t)try{n(t(e))}catch(t){i(t)}else n(e)},t=>{if(e)try{n(e(t))}catch(t){i(t)}else i(t)}]),this._executeHandlers()}))}catch(t){return this.then((t=>t),t)}finally(t){return new le(((e,n)=>{let i,r;return this.then((e=>{r=!1,i=e,t&&t()}),(e=>{r=!0,i=e,t&&t()})).then((()=>{r?n(i):e(i)}))}))}__init3(){this._resolve=t=>{this._setResult(se.RESOLVED,t)}}__init4(){this._reject=t=>{this._setResult(se.REJECTED,t)}}__init5(){this._setResult=(t,e)=>{this._state===se.PENDING&&(ie(e)?e.then(this._resolve,this._reject):(this._state=t,this._value=e,this._executeHandlers()))}}__init6(){this._executeHandlers=()=>{if(this._state===se.PENDING)return;const t=this._handlers.slice();this._handlers=[],t.forEach((t=>{t[0]||(this._state===se.RESOLVED&&t[1](this._value),this._state===se.REJECTED&&t[2](this._value),t[0]=!0)}))}}}const ce=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function ue(t,e=!1){const{host:n,path:i,pass:r,port:s,projectId:a,protocol:o,publicKey:l}=t;return`${o}://${l}${e&&r?`:${r}`:""}@${n}${s?`:${s}`:""}/${i?`${i}/`:i}${a}`}function he(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}var de=n(71235);const pe=(0,de.Rf)(),me=80;function fe(t,e={}){try{let n=t;const i=5,r=[];let s=0,a=0;const o=" > ",l=o.length;let c;const u=Array.isArray(e)?e:e.keyAttrs,h=!Array.isArray(e)&&e.maxStringLength||me;for(;n&&s++<i&&(c=ge(n,u),!("html"===c||s>1&&a+r.length*l+c.length>=h));)r.push(c),a+=c.length,n=n.parentNode;return r.reverse().join(o)}catch(t){return"<unknown>"}}function ge(t,e){const n=t,i=[];let r,s,a,o,l;if(!n||!n.tagName)return"";i.push(n.tagName.toLowerCase());const c=e&&e.length?e.filter((t=>n.getAttribute(t))).map((t=>[t,n.getAttribute(t)])):null;if(c&&c.length)c.forEach((t=>{i.push(`[${t[0]}="${t[1]}"]`)}));else if(n.id&&i.push(`#${n.id}`),r=n.className,r&&Qt(r))for(s=r.split(/\s+/),l=0;l<s.length;l++)i.push(`.${s[l]}`);const u=["type","name","title","alt"];for(l=0;l<u.length;l++)a=u[l],o=n.getAttribute(a),o&&i.push(`[${a}="${o}"]`);return i.join("")}function _e(t,e=0){return"string"!=typeof t||0===e||t.length<=e?t:`${t.substr(0,e)}...`}function ye(t,e){if(!Array.isArray(t))return"";const n=[];for(let e=0;e<t.length;e++){const i=t[e];try{n.push(String(i))}catch(t){n.push("[value cannot be serialized]")}}return n.join(e)}function ve(t,e=[],n=!1){return e.some((e=>function(t,e,n=!1){return!!Qt(t)&&(Jt(e,"RegExp")?e.test(t):!!Qt(e)&&(n?t===e:t.includes(e)))}(t,e,n)))}function be(t,e,n){if(!(e in t))return;const i=t[e],r=n(i);if("function"==typeof r)try{Ee(r,i)}catch(t){}t[e]=r}function we(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}function Ee(t,e){const n=e.prototype||{};t.prototype=e.prototype=n,we(t,"__sentry_original__",e)}function Se(t){return t.__sentry_original__}function xe(t){if(Vt(t))return{message:t.message,name:t.name,stack:t.stack,...Te(t)};if(ne(t)){const e={type:t.type,target:ke(t.target),currentTarget:ke(t.currentTarget),...Te(t)};return"undefined"!=typeof CustomEvent&&re(t,CustomEvent)&&(e.detail=t.detail),e}return t}function ke(t){try{return"undefined"!=typeof Element&&re(t,Element)?fe(t):Object.prototype.toString.call(t)}catch(t){return"<unknown>"}}function Te(t){if("object"==typeof t&&null!==t){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}return{}}function $e(t,e=40){const n=Object.keys(xe(t));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=e)return _e(n[0],e);for(let t=n.length;t>0;t--){const i=n.slice(0,t).join(", ");if(!(i.length>e))return t===n.length?i:_e(i,e)}return""}function Ne(t){return Ie(t,new Map)}function Ie(t,e){if(ee(t)){const n=e.get(t);if(void 0!==n)return n;const i={};e.set(t,i);for(const n of Object.keys(t))void 0!==t[n]&&(i[n]=Ie(t[n],e));return i}if(Array.isArray(t)){const n=e.get(t);if(void 0!==n)return n;const i=[];return e.set(t,i),t.forEach((t=>{i.push(Ie(t,e))})),i}return t}const Re=50;function Ae(...t){const e=t.sort(((t,e)=>t[0]-e[0])).map((t=>t[1]));return(t,n=0)=>{const i=[];for(const r of t.split("\n").slice(n)){const t=r.replace(/\(error: (.*)\)/,"$1");for(const n of e){const e=n(t);if(e){i.push(e);break}}}return function(t){if(!t.length)return[];let e=t;const n=e[0].function||"",i=e[e.length-1].function||"";return-1===n.indexOf("captureMessage")&&-1===n.indexOf("captureException")||(e=e.slice(1)),-1!==i.indexOf("sentryWrapped")&&(e=e.slice(0,-1)),e.slice(0,Re).map((t=>({...t,filename:t.filename||e[0].filename,function:t.function||"?"}))).reverse()}(i)}}const Ce="<anonymous>";function Pe(t){try{return t&&"function"==typeof t&&t.name||Ce}catch(t){return Ce}}function Oe(t,e=1/0,n=1/0){try{return De("",t,e,n)}catch(t){return{ERROR:`**non-serializable** (${t})`}}}function Le(t,e=3,n=102400){const i=Oe(t,e);return function(t){return function(t){return~-encodeURI(t).split(/%..|./).length}(JSON.stringify(t))}(i)>n?Le(t,e-1,n):i}function De(t,e,i=1/0,r=1/0,s=function(){const t="function"==typeof WeakSet,e=t?new WeakSet:[];return[function(n){if(t)return!!e.has(n)||(e.add(n),!1);for(let t=0;t<e.length;t++)if(e[t]===n)return!0;return e.push(n),!1},function(n){if(t)e.delete(n);else for(let t=0;t<e.length;t++)if(e[t]===n){e.splice(t,1);break}}]}()){const[a,o]=s;if(null===e||["number","boolean","string"].includes(typeof e)&&("number"!=typeof(l=e)||l==l))return e;var l;const c=function(t,e){try{return"domain"===t&&e&&"object"==typeof e&&e._events?"[Domain]":"domainEmitter"===t?"[DomainEmitter]":void 0!==n.g&&e===n.g?"[Global]":"undefined"!=typeof window&&e===window?"[Window]":"undefined"!=typeof document&&e===document?"[Document]":function(t){return ee(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}(e)?"[SyntheticEvent]":"number"==typeof e&&e!=e?"[NaN]":void 0===e?"[undefined]":"function"==typeof e?`[Function: ${Pe(e)}]`:"symbol"==typeof e?`[${String(e)}]`:"bigint"==typeof e?`[BigInt: ${String(e)}]`:`[object ${Object.getPrototypeOf(e).constructor.name}]`}catch(t){return`**non-serializable** (${t})`}}(t,e);if(!c.startsWith("[object "))return c;if(e.__sentry_skip_normalization__)return e;if(0===i)return c.replace("object ","");if(a(e))return"[Circular ~]";const u=e;if(u&&"function"==typeof u.toJSON)try{return De("",u.toJSON(),i-1,r,s)}catch(t){}const h=Array.isArray(e)?[]:{};let d=0;const p=xe(e);for(const t in p){if(!Object.prototype.hasOwnProperty.call(p,t))continue;if(d>=r){h[t]="[MaxProperties ~]";break}const e=p[t];h[t]=De(t,e,i-1,r,s),d++}return o(e),h}function Ue(t,e=[]){return[t,e]}function Me(t,e){const[n,i]=t;return[n,[...i,e]]}function je(t,e){t[1].forEach((t=>{const n=t[0].type;e(t,n)}))}function Be(t,e){return(e||new TextEncoder).encode(t)}function Ge(t,e){const[n,i]=t;let r=JSON.stringify(n);function s(t){"string"==typeof r?r="string"==typeof t?r+t:[Be(r,e),t]:r.push("string"==typeof t?Be(t,e):t)}for(const t of i){const[e,n]=t;if(s(`\n${JSON.stringify(e)}\n`),"string"==typeof n||n instanceof Uint8Array)s(n);else{let t;try{t=JSON.stringify(n)}catch(e){t=JSON.stringify(Oe(n))}s(t)}}return"string"==typeof r?r:function(t){const e=t.reduce(((t,e)=>t+e.length),0),n=new Uint8Array(e);let i=0;for(const e of t)n.set(e,i),i+=e.length;return n}(r)}function Fe(t,e){const n="string"==typeof t.data?Be(t.data,e):t.data;return[Ne({type:"attachment",length:n.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),n]}const Ye={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay_event",replay_recording:"replay_recording"};function We(t){return Ye[t]}function qe(t){if(!t||!t.sdk)return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}const He=6e4;const ze="Sentry Logger ",Ke=["debug","info","warn","error","log","assert","trace"];function Ve(t){if(!("console"in de.n2))return t();const e=de.n2.console,n={};Ke.forEach((t=>{const i=e[t]&&e[t].__sentry_original__;t in e&&i&&(n[t]=e[t],e[t]=i)}));try{return t()}finally{Object.keys(n).forEach((t=>{e[t]=n[t]}))}}function Je(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1}};return"undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?Ke.forEach((n=>{e[n]=(...e)=>{t&&Ve((()=>{de.n2.console[n](`${ze}[${n}]:`,...e)}))}})):Ke.forEach((t=>{e[t]=()=>{}})),e}let Xe;Xe="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?(0,de.YO)("logger",Je):Je();const Ze=30;function Qe(t,e,n=function(t){const e=[];function n(t){return e.splice(e.indexOf(t),1)[0]}return{$:e,add:function(i){if(!(void 0===t||e.length<t))return oe(new zt("Not adding Promise because buffer limit was reached."));const r=i();return-1===e.indexOf(r)&&e.push(r),r.then((()=>n(r))).then(null,(()=>n(r).then(null,(()=>{})))),r},drain:function(t){return new le(((n,i)=>{let r=e.length;if(!r)return n(!0);const s=setTimeout((()=>{t&&t>0&&n(!1)}),t);e.forEach((t=>{ae(t).then((()=>{--r||(clearTimeout(s),n(!0))}),i)}))}))}}}(t.bufferSize||Ze)){let i={};return{send:function(r){const s=[];if(je(r,((e,n)=>{const r=We(n);if(function(t,e,n=Date.now()){return function(t,e){return t[e]||t.all||0}(t,e)>n}(i,r)){const i=tn(e,n);t.recordDroppedEvent("ratelimit_backoff",r,i)}else s.push(e)})),0===s.length)return ae();const a=Ue(r[0],s),o=e=>{je(a,((n,i)=>{const r=tn(n,i);t.recordDroppedEvent(e,We(i),r)}))};return n.add((()=>e({body:Ge(a,t.textEncoder)}).then((t=>{void 0!==t.statusCode&&(t.statusCode<200||t.statusCode>=300)&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn(`Sentry responded with status code ${t.statusCode} to sent event.`),i=function(t,{statusCode:e,headers:n},i=Date.now()){const r={...t},s=n&&n["x-sentry-rate-limits"],a=n&&n["retry-after"];if(s)for(const t of s.trim().split(",")){const[e,n]=t.split(":",2),s=parseInt(e,10),a=1e3*(isNaN(s)?60:s);if(n)for(const t of n.split(";"))r[t]=i+a;else r.all=i+a}else a?r.all=i+function(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return 1e3*n;const i=Date.parse(`${t}`);return isNaN(i)?He:i-e}(a,i):429===e&&(r.all=i+6e4);return r}(i,t)}),(t=>{("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.error("Failed while sending event:",t),o("network_error")})))).then((t=>t),(t=>{if(t instanceof zt)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.error("Skipped sending event because buffer is full."),o("queue_overflow"),ae();throw t}))},flush:t=>n.drain(t)}}function tn(t,e){if("event"===e||"transaction"===e)return Array.isArray(t)?t[1]:void 0}const en=(0,de.Rf)();function nn(){if(!("fetch"in en))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(t){return!1}}function rn(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function sn(){const t=de.n2,e=t.crypto||t.msCrypto;if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");const n=e&&e.getRandomValues?()=>e.getRandomValues(new Uint8Array(1))[0]:()=>16*Math.random();return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(t=>(t^(15&n())>>t/4).toString(16)))}function an(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function on(t){const{message:e,event_id:n}=t;if(e)return e;const i=an(t);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||n||"<unknown>":n||"<unknown>"}function ln(t,e,n){const i=t.exception=t.exception||{},r=i.values=i.values||[],s=r[0]=r[0]||{};s.value||(s.value=e||""),s.type||(s.type=n||"Error")}function cn(t,e){const n=an(t);if(!n)return;const i=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...i,...e},e&&"data"in e){const t={...i&&i.data,...e.data};n.mechanism.data=t}}function un(t){if(t&&t.__sentry_captured__)return!0;try{we(t,"__sentry_captured__",!0)}catch(t){}return!1}function hn(t){return Array.isArray(t)?t:[t]}var dn=n(21170),pn=n(72176);function mn(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),t.did||e.did||(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||(0,dn.ph)(),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=32===e.sid.length?e.sid:sn()),void 0!==e.init&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),"number"==typeof e.started&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if("number"==typeof e.duration)t.duration=e.duration;else{const e=t.timestamp-t.started;t.duration=e>=0?e:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),"number"==typeof e.errors&&(t.errors=e.errors),e.status&&(t.status=e.status)}class fn{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={}}static clone(t){const e=new fn;return t&&(e._breadcrumbs=[...t._breadcrumbs],e._tags={...t._tags},e._extra={...t._extra},e._contexts={...t._contexts},e._user=t._user,e._level=t._level,e._span=t._span,e._session=t._session,e._transactionName=t._transactionName,e._fingerprint=t._fingerprint,e._eventProcessors=[...t._eventProcessors],e._requestSession=t._requestSession,e._attachments=[...t._attachments],e._sdkProcessingMetadata={...t._sdkProcessingMetadata}),e}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{},this._session&&mn(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(t){return this._requestSession=t,this}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,e){return this._tags={...this._tags,[t]:e},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,e){return this._extra={...this._extra,[t]:e},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,e){return null===e?delete this._contexts[t]:this._contexts[t]=e,this._notifyScopeListeners(),this}setSpan(t){return this._span=t,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const t=this.getSpan();return t&&t.transaction}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;if("function"==typeof t){const e=t(this);return e instanceof fn?e:this}return t instanceof fn?(this._tags={...this._tags,...t._tags},this._extra={...this._extra,...t._extra},this._contexts={...this._contexts,...t._contexts},t._user&&Object.keys(t._user).length&&(this._user=t._user),t._level&&(this._level=t._level),t._fingerprint&&(this._fingerprint=t._fingerprint),t._requestSession&&(this._requestSession=t._requestSession)):ee(t)&&(this._tags={...this._tags,...t.tags},this._extra={...this._extra,...t.extra},this._contexts={...this._contexts,...t.contexts},t.user&&(this._user=t.user),t.level&&(this._level=t.level),t.fingerprint&&(this._fingerprint=t.fingerprint),t.requestSession&&(this._requestSession=t.requestSession)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this}addBreadcrumb(t,e){const n="number"==typeof e?e:100;if(n<=0)return this;const i={timestamp:(0,dn.yW)(),...t};return this._breadcrumbs=[...this._breadcrumbs,i].slice(-n),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}getAttachments(){return this._attachments}clearAttachments(){return this._attachments=[],this}applyToEvent(t,e={}){if(this._extra&&Object.keys(this._extra).length&&(t.extra={...this._extra,...t.extra}),this._tags&&Object.keys(this._tags).length&&(t.tags={...this._tags,...t.tags}),this._user&&Object.keys(this._user).length&&(t.user={...this._user,...t.user}),this._contexts&&Object.keys(this._contexts).length&&(t.contexts={...this._contexts,...t.contexts}),this._level&&(t.level=this._level),this._transactionName&&(t.transaction=this._transactionName),this._span){t.contexts={trace:this._span.getTraceContext(),...t.contexts};const e=this._span.transaction&&this._span.transaction.name;e&&(t.tags={transaction:e,...t.tags})}return this._applyFingerprint(t),t.breadcrumbs=[...t.breadcrumbs||[],...this._breadcrumbs],t.breadcrumbs=t.breadcrumbs.length>0?t.breadcrumbs:void 0,t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...this._sdkProcessingMetadata},this._notifyEventProcessors([...gn(),...this._eventProcessors],t,e)}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...t},this}_notifyEventProcessors(t,e,n,i=0){return new le(((r,s)=>{const a=t[i];if(null===e||"function"!=typeof a)r(e);else{const o=a({...e},n);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&a.id&&null===o&&Xe.log(`Event processor "${a.id}" dropped event`),ie(o)?o.then((e=>this._notifyEventProcessors(t,e,n,i+1).then(r))).then(null,s):this._notifyEventProcessors(t,o,n,i+1).then(r).then(null,s)}}))}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((t=>{t(this)})),this._notifyingListeners=!1)}_applyFingerprint(t){t.fingerprint=t.fingerprint?hn(t.fingerprint):[],this._fingerprint&&(t.fingerprint=t.fingerprint.concat(this._fingerprint)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}}function gn(){return(0,de.YO)("globalEventProcessors",(()=>[]))}function _n(t){gn().push(t)}const yn=4,vn=100;class bn{__init(){this._stack=[{}]}constructor(t,e=new fn,n=yn){this._version=n,bn.prototype.__init.call(this),this.getStackTop().scope=e,t&&this.bindClient(t)}isOlderThan(t){return this._version<t}bindClient(t){this.getStackTop().client=t,t&&t.setupIntegrations&&t.setupIntegrations()}pushScope(){const t=fn.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:t}),t}popScope(){return!(this.getStack().length<=1||!this.getStack().pop())}withScope(t){const e=this.pushScope();try{t(e)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(t,e){const n=this._lastEventId=e&&e.event_id?e.event_id:sn(),i=new Error("Sentry syntheticException");return this._withClient(((r,s)=>{r.captureException(t,{originalException:t,syntheticException:i,...e,event_id:n},s)})),n}captureMessage(t,e,n){const i=this._lastEventId=n&&n.event_id?n.event_id:sn(),r=new Error(t);return this._withClient(((s,a)=>{s.captureMessage(t,e,{originalException:t,syntheticException:r,...n,event_id:i},a)})),i}captureEvent(t,e){const n=e&&e.event_id?e.event_id:sn();return"transaction"!==t.type&&(this._lastEventId=n),this._withClient(((i,r)=>{i.captureEvent(t,{...e,event_id:n},r)})),n}lastEventId(){return this._lastEventId}addBreadcrumb(t,e){const{scope:n,client:i}=this.getStackTop();if(!n||!i)return;const{beforeBreadcrumb:r=null,maxBreadcrumbs:s=vn}=i.getOptions&&i.getOptions()||{};if(s<=0)return;const a={timestamp:(0,dn.yW)(),...t},o=r?Ve((()=>r(a,e))):a;null!==o&&n.addBreadcrumb(o,s)}setUser(t){const e=this.getScope();e&&e.setUser(t)}setTags(t){const e=this.getScope();e&&e.setTags(t)}setExtras(t){const e=this.getScope();e&&e.setExtras(t)}setTag(t,e){const n=this.getScope();n&&n.setTag(t,e)}setExtra(t,e){const n=this.getScope();n&&n.setExtra(t,e)}setContext(t,e){const n=this.getScope();n&&n.setContext(t,e)}configureScope(t){const{scope:e,client:n}=this.getStackTop();e&&n&&t(e)}run(t){const e=En(this);try{t(this)}finally{En(e)}}getIntegration(t){const e=this.getClient();if(!e)return null;try{return e.getIntegration(t)}catch(e){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn(`Cannot retrieve integration ${t.id} from the current Hub`),null}}startTransaction(t,e){return this._callExtensionMethod("startTransaction",t,e)}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(t=!1){if(t)return this.endSession();this._sendSessionUpdate()}endSession(){const t=this.getStackTop(),e=t&&t.scope,n=e&&e.getSession();n&&function(t,e){let n={};"ok"===t.status&&(n={status:"exited"}),mn(t,n)}(n),this._sendSessionUpdate(),e&&e.setSession()}startSession(t){const{scope:e,client:n}=this.getStackTop(),{release:i,environment:r}=n&&n.getOptions()||{},{userAgent:s}=de.n2.navigator||{},a=function(t){const e=(0,dn.ph)(),n={sid:sn(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(t){return Ne({sid:`${t.sid}`,init:t.init,started:new Date(1e3*t.started).toISOString(),timestamp:new Date(1e3*t.timestamp).toISOString(),status:t.status,errors:t.errors,did:"number"==typeof t.did||"string"==typeof t.did?`${t.did}`:void 0,duration:t.duration,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}(n)};return t&&mn(n,t),n}({release:i,environment:r,...e&&{user:e.getUser()},...s&&{userAgent:s},...t});if(e){const t=e.getSession&&e.getSession();t&&"ok"===t.status&&mn(t,{status:"exited"}),this.endSession(),e.setSession(a)}return a}shouldSendDefaultPii(){const t=this.getClient(),e=t&&t.getOptions();return Boolean(e&&e.sendDefaultPii)}_sendSessionUpdate(){const{scope:t,client:e}=this.getStackTop();if(!t)return;const n=t.getSession();n&&e&&e.captureSession&&e.captureSession(n)}_withClient(t){const{scope:e,client:n}=this.getStackTop();n&&t(n,e)}_callExtensionMethod(t,...e){const n=wn().__SENTRY__;if(n&&n.extensions&&"function"==typeof n.extensions[t])return n.extensions[t].apply(this,e);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn(`Extension method ${t} couldn't be found, doing nothing.`)}}function wn(){return de.n2.__SENTRY__=de.n2.__SENTRY__||{extensions:{},hub:void 0},de.n2}function En(t){const e=wn(),n=kn(e);return Tn(e,t),n}function Sn(){const t=wn();return xn(t)&&!kn(t).isOlderThan(yn)||Tn(t,new bn),(0,pn.KV)()?function(t){try{const e=wn().__SENTRY__,n=e&&e.extensions&&e.extensions.domain&&e.extensions.domain.active;if(!n)return kn(t);if(!xn(n)||kn(n).isOlderThan(yn)){const e=kn(t).getStackTop();Tn(n,new bn(e.client,fn.clone(e.scope)))}return kn(n)}catch(e){return kn(t)}}(t):kn(t)}function xn(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function kn(t){return(0,de.YO)("hub",(()=>new bn),t)}function Tn(t,e){return!!t&&((t.__SENTRY__=t.__SENTRY__||{}).hub=e,!0)}const $n=de.n2;let Nn,In=0;function Rn(){return In>0}function An(t,e={},n){if("function"!=typeof t)return t;try{const e=t.__sentry_wrapped__;if(e)return e;if(Se(t))return t}catch(e){return t}const i=function(){const i=Array.prototype.slice.call(arguments);try{n&&"function"==typeof n&&n.apply(this,arguments);const r=i.map((t=>An(t,e)));return t.apply(this,r)}catch(t){throw In++,setTimeout((()=>{In--})),r=n=>{var r;n.addEventProcessor((t=>(e.mechanism&&(ln(t,void 0,void 0),cn(t,e.mechanism)),t.extra={...t.extra,arguments:i},t))),r=t,Sn().captureException(r,{captureContext:undefined})},Sn().withScope(r),t}var r};try{for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i[e]=t[e])}catch(t){}Ee(i,t),we(t,"__sentry_wrapped__",i);try{Object.getOwnPropertyDescriptor(i,"name").configurable&&Object.defineProperty(i,"name",{get:()=>t.name})}catch(t){}return i}function Cn(t,e=function(){if(Nn)return Nn;if(rn($n.fetch))return Nn=$n.fetch.bind($n);const t=$n.document;let e=$n.fetch;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n);const i=n.contentWindow;i&&i.fetch&&(e=i.fetch),t.head.removeChild(n)}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",t)}return Nn=e.bind($n)}()){return Qe(t,(function(n){const i={body:n.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:n.body.length<=65536,...t.fetchOptions};try{return e(t.url,i).then((t=>({statusCode:t.status,headers:{"x-sentry-rate-limits":t.headers.get("X-Sentry-Rate-Limits"),"retry-after":t.headers.get("Retry-After")}})))}catch(t){return Nn=void 0,oe(t)}}))}const Pn=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/];class On{static __initStatic(){this.id="InboundFilters"}__init(){this.name=On.id}constructor(t={}){this._options=t,On.prototype.__init.call(this)}setupOnce(t,e){const n=t=>{const n=e();if(n){const e=n.getIntegration(On);if(e){const i=n.getClient(),r=i?i.getOptions():{},s=function(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...Pn],ignoreInternal:void 0===t.ignoreInternal||t.ignoreInternal}}(e._options,r);return function(t,e){return e.ignoreInternal&&function(t){try{return"SentryError"===t.exception.values[0].type}catch(t){}return!1}(t)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${on(t)}`),!0):function(t,e){return!(!e||!e.length)&&function(t){if(t.message)return[t.message];if(t.exception)try{const{type:e="",value:n=""}=t.exception.values&&t.exception.values[0]||{};return[`${n}`,`${e}: ${n}`]}catch(e){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.error(`Cannot extract message for event ${on(t)}`),[]}return[]}(t).some((t=>ve(t,e)))}(t,e.ignoreErrors)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${on(t)}`),!0):function(t,e){if(!e||!e.length)return!1;const n=Ln(t);return!!n&&ve(n,e)}(t,e.denyUrls)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${on(t)}.\nUrl: ${Ln(t)}`),!0):!function(t,e){if(!e||!e.length)return!0;const n=Ln(t);return!n||ve(n,e)}(t,e.allowUrls)&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${on(t)}.\nUrl: ${Ln(t)}`),!0)}(t,s)?null:t}}return t};n.id=this.name,t(n)}}function Ln(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch(t){}return e?function(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(e):null}catch(e){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.error(`Cannot extract url for event ${on(t)}`),null}}let Dn;On.__initStatic();class Un{constructor(){Un.prototype.__init.call(this)}static __initStatic(){this.id="FunctionToString"}__init(){this.name=Un.id}setupOnce(){Dn=Function.prototype.toString,Function.prototype.toString=function(...t){const e=Se(this)||this;return Dn.apply(e,t)}}}Un.__initStatic();const Mn=[];function jn(t){const e=t.defaultIntegrations||[],n=t.integrations;let i;e.forEach((t=>{t.isDefaultInstance=!0})),i=Array.isArray(n)?[...e,...n]:"function"==typeof n?hn(n(e)):e;const r=function(t){const e={};return t.forEach((t=>{const{name:n}=t,i=e[n];i&&!i.isDefaultInstance&&t.isDefaultInstance||(e[n]=t)})),Object.values(e)}(i),s=r.findIndex((t=>"Debug"===t.name));if(-1!==s){const[t]=r.splice(s,1);r.push(t)}return r}const Bn=(0,de.Rf)(),Gn={},Fn={};function Yn(t,e){Gn[t]=Gn[t]||[],Gn[t].push(e),function(t){if(!Fn[t])switch(Fn[t]=!0,t){case"console":"console"in Bn&&Ke.forEach((function(t){t in Bn.console&&be(Bn.console,t,(function(e){return function(...n){Wn("console",{args:n,level:t}),e&&e.apply(Bn.console,n)}}))}));break;case"dom":!function(){if(!("document"in Bn))return;const t=Wn.bind(null,"dom"),e=Xn(t,!0);Bn.document.addEventListener("click",e,!1),Bn.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach((e=>{const n=Bn[e]&&Bn[e].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(be(n,"addEventListener",(function(e){return function(n,i,r){if("click"===n||"keypress"==n)try{const i=this,s=i.__sentry_instrumentation_handlers__=i.__sentry_instrumentation_handlers__||{},a=s[n]=s[n]||{refCount:0};if(!a.handler){const i=Xn(t);a.handler=i,e.call(this,n,i,r)}a.refCount++}catch(t){}return e.call(this,n,i,r)}})),be(n,"removeEventListener",(function(t){return function(e,n,i){if("click"===e||"keypress"==e)try{const n=this,r=n.__sentry_instrumentation_handlers__||{},s=r[e];s&&(s.refCount--,s.refCount<=0&&(t.call(this,e,s.handler,i),s.handler=void 0,delete r[e]),0===Object.keys(r).length&&delete n.__sentry_instrumentation_handlers__)}catch(t){}return t.call(this,e,n,i)}})))}))}();break;case"xhr":!function(){if(!("XMLHttpRequest"in Bn))return;const t=XMLHttpRequest.prototype;be(t,"open",(function(t){return function(...e){const n=this,i=e[1],r=n.__sentry_xhr__={method:Qt(e[0])?e[0].toUpperCase():e[0],url:e[1]};Qt(i)&&"POST"===r.method&&i.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const s=function(){if(4===n.readyState){try{r.status_code=n.status}catch(t){}Wn("xhr",{args:e,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:n})}};return"onreadystatechange"in n&&"function"==typeof n.onreadystatechange?be(n,"onreadystatechange",(function(t){return function(...e){return s(),t.apply(n,e)}})):n.addEventListener("readystatechange",s),t.apply(n,e)}})),be(t,"send",(function(t){return function(...e){return this.__sentry_xhr__&&void 0!==e[0]&&(this.__sentry_xhr__.body=e[0]),Wn("xhr",{args:e,startTimestamp:Date.now(),xhr:this}),t.apply(this,e)}}))}();break;case"fetch":(function(){if(!nn())return!1;if(rn(en.fetch))return!0;let t=!1;const e=en.document;if(e&&"function"==typeof e.createElement)try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(t=rn(n.contentWindow.fetch)),e.head.removeChild(n)}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",t)}return t})()&&be(Bn,"fetch",(function(t){return function(...e){const n={args:e,fetchData:{method:qn(e),url:Hn(e)},startTimestamp:Date.now()};return Wn("fetch",{...n}),t.apply(Bn,e).then((t=>(Wn("fetch",{...n,endTimestamp:Date.now(),response:t}),t)),(t=>{throw Wn("fetch",{...n,endTimestamp:Date.now(),error:t}),t}))}}));break;case"history":!function(){if(!function(){const t=en.chrome,e=t&&t.app&&t.app.runtime,n="history"in en&&!!en.history.pushState&&!!en.history.replaceState;return!e&&n}())return;const t=Bn.onpopstate;function e(t){return function(...e){const n=e.length>2?e[2]:void 0;if(n){const t=zn,e=String(n);zn=e,Wn("history",{from:t,to:e})}return t.apply(this,e)}}Bn.onpopstate=function(...e){const n=Bn.location.href,i=zn;if(zn=n,Wn("history",{from:i,to:n}),t)try{return t.apply(this,e)}catch(t){}},be(Bn.history,"pushState",e),be(Bn.history,"replaceState",e)}();break;case"error":Zn=Bn.onerror,Bn.onerror=function(t,e,n,i,r){return Wn("error",{column:i,error:r,line:n,msg:t,url:e}),!!Zn&&Zn.apply(this,arguments)};break;case"unhandledrejection":Qn=Bn.onunhandledrejection,Bn.onunhandledrejection=function(t){return Wn("unhandledrejection",t),!Qn||Qn.apply(this,arguments)};break;default:("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn("unknown instrumentation type:",t)}}(t)}function Wn(t,e){if(t&&Gn[t])for(const n of Gn[t]||[])try{n(e)}catch(e){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.error(`Error while triggering instrumentation handler.\nType: ${t}\nName: ${Pe(n)}\nError:`,e)}}function qn(t=[]){return"Request"in Bn&&re(t[0],Request)&&t[0].method?String(t[0].method).toUpperCase():t[1]&&t[1].method?String(t[1].method).toUpperCase():"GET"}function Hn(t=[]){return"string"==typeof t[0]?t[0]:"Request"in Bn&&re(t[0],Request)?t[0].url:String(t[0])}let zn;const Kn=1e3;let Vn,Jn;function Xn(t,e=!1){return n=>{if(!n||Jn===n)return;if(function(t){if("keypress"!==t.type)return!1;try{const e=t.target;if(!e||!e.tagName)return!0;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable)return!1}catch(t){}return!0}(n))return;const i="keypress"===n.type?"input":n.type;(void 0===Vn||function(t,e){if(!t)return!0;if(t.type!==e.type)return!0;try{if(t.target!==e.target)return!0}catch(t){}return!1}(Jn,n))&&(t({event:n,name:i,global:e}),Jn=n),clearTimeout(Vn),Vn=Bn.setTimeout((()=>{Vn=void 0}),Kn)}}let Zn=null,Qn=null;const ti="7";function ei(t,e={}){const n="string"==typeof e?e:e.tunnel,i="string"!=typeof e&&e._metadata?e._metadata.sdk:void 0;return n||`${function(t){return`${function(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}(t)}${t.projectId}/envelope/`}(t)}?${function(t,e){return n={sentry_key:t.publicKey,sentry_version:ti,...e&&{sentry_client:`${e.name}/${e.version}`}},Object.keys(n).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(n[t])}`)).join("&");var n}(t,i)}`}const ni="Not capturing exception because it's already been captured.";class ii{__init(){this._integrations={}}__init2(){this._integrationsInitialized=!1}__init3(){this._numProcessing=0}__init4(){this._outcomes={}}constructor(t){if(ii.prototype.__init.call(this),ii.prototype.__init2.call(this),ii.prototype.__init3.call(this),ii.prototype.__init4.call(this),this._options=t,t.dsn){this._dsn=function(t){const e="string"==typeof t?function(t){const e=ce.exec(t);if(!e)throw new zt(`Invalid Sentry Dsn: ${t}`);const[n,i,r="",s,a="",o]=e.slice(1);let l="",c=o;const u=c.split("/");if(u.length>1&&(l=u.slice(0,-1).join("/"),c=u.pop()),c){const t=c.match(/^\d+/);t&&(c=t[0])}return he({host:s,pass:r,path:l,projectId:c,port:a,protocol:n,publicKey:i})}(t):he(t);return function(t){if("undefined"!=typeof __SENTRY_DEBUG__&&!__SENTRY_DEBUG__)return;const{port:e,projectId:n,protocol:i}=t;if(["protocol","publicKey","host","projectId"].forEach((e=>{if(!t[e])throw new zt(`Invalid Sentry Dsn: ${e} missing`)})),!n.match(/^\d+$/))throw new zt(`Invalid Sentry Dsn: Invalid projectId ${n}`);if(!function(t){return"http"===t||"https"===t}(i))throw new zt(`Invalid Sentry Dsn: Invalid protocol ${i}`);if(e&&isNaN(parseInt(e,10)))throw new zt(`Invalid Sentry Dsn: Invalid port ${e}`)}(e),e}(t.dsn);const e=ei(this._dsn,t);this._transport=t.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...t.transportOptions,url:e})}else("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn("No DSN provided, client will not do anything.")}captureException(t,e,n){if(un(t))return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.log(ni));let i=e&&e.event_id;return this._process(this.eventFromException(t,e).then((t=>this._captureEvent(t,e,n))).then((t=>{i=t}))),i}captureMessage(t,e,n,i){let r=n&&n.event_id;const s=te(t)?this.eventFromMessage(String(t),e,n):this.eventFromException(t,n);return this._process(s.then((t=>this._captureEvent(t,n,i))).then((t=>{r=t}))),r}captureEvent(t,e,n){if(e&&e.originalException&&un(e.originalException))return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.log(ni));let i=e&&e.event_id;return this._process(this._captureEvent(t,e,n).then((t=>{i=t}))),i}captureSession(t){this._isEnabled()?"string"!=typeof t.release?("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn("Discarded session because of missing or non-string release"):(this.sendSession(t),mn(t,{init:!1})):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn("SDK not enabled, will not capture session.")}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){const e=this._transport;return e?this._isClientDoneProcessing(t).then((n=>e.flush(t).then((t=>n&&t)))):ae(!0)}close(t){return this.flush(t).then((t=>(this.getOptions().enabled=!1,t)))}setupIntegrations(){this._isEnabled()&&!this._integrationsInitialized&&(this._integrations=function(t){const e={};return t.forEach((t=>{e[t.name]=t,-1===Mn.indexOf(t.name)&&(t.setupOnce(_n,Sn),Mn.push(t.name),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.log(`Integration installed: ${t.name}`))})),e}(this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(t){return this._integrations[t]}getIntegration(t){try{return this._integrations[t.id]||null}catch(e){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn(`Cannot retrieve integration ${t.id} from the current Client`),null}}sendEvent(t,e={}){if(this._dsn){let n=function(t,e,n,i){const r=qe(n),s=t.type||"event";!function(t,e){e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]])}(t,n&&n.sdk);const a=function(t,e,n,i){const r=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:(new Date).toISOString(),...e&&{sdk:e},...!!n&&{dsn:ue(i)},..."transaction"===t.type&&r&&{trace:Ne({...r})}}}(t,r,i,e);return delete t.sdkProcessingMetadata,Ue(a,[[{type:s},t]])}(t,this._dsn,this._options._metadata,this._options.tunnel);for(const t of e.attachments||[])n=Me(n,Fe(t,this._options.transportOptions&&this._options.transportOptions.textEncoder));this._sendEnvelope(n)}}sendSession(t){if(this._dsn){const e=function(t,e,n,i){const r=qe(n);return Ue({sent_at:(new Date).toISOString(),...r&&{sdk:r},...!!i&&{dsn:ue(e)}},["aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t]])}(t,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(e)}}recordDroppedEvent(t,e,n){if(this._options.sendClientReports){const n=`${t}:${e}`;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.log(`Adding outcome: "${n}"`),this._outcomes[n]=this._outcomes[n]+1||1}}_updateSessionFromEvent(t,e){let n=!1,i=!1;const r=e.exception&&e.exception.values;if(r){i=!0;for(const t of r){const e=t.mechanism;if(e&&!1===e.handled){n=!0;break}}}const s="ok"===t.status;(s&&0===t.errors||s&&n)&&(mn(t,{...n&&{status:"crashed"},errors:t.errors||Number(i||n)}),this.captureSession(t))}_isClientDoneProcessing(t){return new le((e=>{let n=0;const i=setInterval((()=>{0==this._numProcessing?(clearInterval(i),e(!0)):(n+=1,t&&n>=t&&(clearInterval(i),e(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._dsn}_prepareEvent(t,e,n){return function(t,e,n,i){const{normalizeDepth:r=3,normalizeMaxBreadth:s=1e3}=t,a={...e,event_id:e.event_id||n.event_id||sn(),timestamp:e.timestamp||(0,dn.yW)()};!function(t,e){const{environment:n,release:i,dist:r,maxValueLength:s=250}=e;"environment"in t||(t.environment="environment"in e?n:"production"),void 0===t.release&&void 0!==i&&(t.release=i),void 0===t.dist&&void 0!==r&&(t.dist=r),t.message&&(t.message=_e(t.message,s));const a=t.exception&&t.exception.values&&t.exception.values[0];a&&a.value&&(a.value=_e(a.value,s));const o=t.request;o&&o.url&&(o.url=_e(o.url,s))}(a,t),function(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}(a,t.integrations.map((t=>t.name)));let o=i;n.captureContext&&(o=fn.clone(o).update(n.captureContext));let l=ae(a);if(o){if(o.getAttachments){const t=[...n.attachments||[],...o.getAttachments()];t.length&&(n.attachments=t)}l=o.applyToEvent(a,n)}return l.then((t=>"number"==typeof r&&r>0?function(t,e,n){if(!t)return null;const i={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map((t=>({...t,...t.data&&{data:Oe(t.data,e,n)}})))},...t.user&&{user:Oe(t.user,e,n)},...t.contexts&&{contexts:Oe(t.contexts,e,n)},...t.extra&&{extra:Oe(t.extra,e,n)}};return t.contexts&&t.contexts.trace&&i.contexts&&(i.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(i.contexts.trace.data=Oe(t.contexts.trace.data,e,n))),t.spans&&(i.spans=t.spans.map((t=>(t.data&&(t.data=Oe(t.data,e,n)),t)))),i}(t,r,s):t))}(this.getOptions(),t,e,n)}_captureEvent(t,e={},n){return this._processEvent(t,e,n).then((t=>t.event_id),(t=>{if("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__){const e=t;"log"===e.logLevel?Xe.log(e.message):Xe.warn(e)}}))}_processEvent(t,e,n){const i=this.getOptions(),{sampleRate:r}=i;if(!this._isEnabled())return oe(new zt("SDK not enabled, will not capture event.","log"));const s=si(t),a=ri(t),o=t.type||"error",l=`before send for type \`${o}\``;return a&&"number"==typeof r&&Math.random()>r?(this.recordDroppedEvent("sample_rate","error",t),oe(new zt(`Discarding event because it's not included in the random sample (sampling rate = ${r})`,"log"))):this._prepareEvent(t,e,n).then((n=>{if(null===n)throw this.recordDroppedEvent("event_processor",o,t),new zt("An event processor returned `null`, will not send event.","log");if(e.data&&!0===e.data.__sentry__)return n;const r=function(t,e,n){const{beforeSend:i,beforeSendTransaction:r}=t;return ri(e)&&i?i(e,n):si(e)&&r?r(e,n):e}(i,n,e);return function(t,e){const n=`${e} must return \`null\` or a valid event.`;if(ie(t))return t.then((t=>{if(!ee(t)&&null!==t)throw new zt(n);return t}),(t=>{throw new zt(`${e} rejected with ${t}`)}));if(!ee(t)&&null!==t)throw new zt(n);return t}(r,l)})).then((i=>{if(null===i)throw this.recordDroppedEvent("before_send",t.type||"error",t),new zt(`${l} returned \`null\`, will not send event.`,"log");const r=n&&n.getSession();!s&&r&&this._updateSessionFromEvent(r,i);const a=i.transaction_info;if(s&&a&&i.transaction!==t.transaction){const t="custom";i.transaction_info={...a,source:t,changes:[...a.changes,{source:t,timestamp:i.timestamp,propagations:a.propagations}]}}return this.sendEvent(i,e),i})).then(null,(t=>{if(t instanceof zt)throw t;throw this.captureException(t,{data:{__sentry__:!0},originalException:t}),new zt(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${t}`)}))}_process(t){this._numProcessing++,t.then((t=>(this._numProcessing--,t)),(t=>(this._numProcessing--,t)))}_sendEnvelope(t){this._transport&&this._dsn?this._transport.send(t).then(null,(t=>{("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.error("Error while sending event:",t)})):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.error("Transport disabled")}_clearOutcomes(){const t=this._outcomes;return this._outcomes={},Object.keys(t).map((e=>{const[n,i]=e.split(":");return{reason:n,category:i,quantity:t[e]}}))}}function ri(t){return void 0===t.type}function si(t){return"transaction"===t.type}const ai="7.29.0";function oi(t,e){const n=ci(t,e),i={type:e&&e.name,value:hi(e)};return n.length&&(i.stacktrace={frames:n}),void 0===i.type&&""===i.value&&(i.value="Unrecoverable error caught"),i}function li(t,e){return{exception:{values:[oi(t,e)]}}}function ci(t,e){const n=e.stacktrace||e.stack||"",i=function(t){if(t){if("number"==typeof t.framesToPop)return t.framesToPop;if(ui.test(t.message))return 1}return 0}(e);try{return t(n,i)}catch(t){}return[]}const ui=/Minified React error #\d+;/i;function hi(t){const e=t&&t.message;return e?e.error&&"string"==typeof e.error.message?e.error.message:e:"No error message"}function di(t,e,n,i,r){let s;if(Xt(e)&&e.error)return li(t,e.error);if(Zt(e)||Jt(e,"DOMException")){const r=e;if("stack"in e)s=li(t,e);else{const e=r.name||(Zt(r)?"DOMError":"DOMException"),a=r.message?`${e}: ${r.message}`:e;s=pi(t,a,n,i),ln(s,a)}return"code"in r&&(s.tags={...s.tags,"DOMException.code":`${r.code}`}),s}return Vt(e)?li(t,e):ee(e)||ne(e)?(s=function(t,e,n,i){const r=Sn().getClient(),s=r&&r.getOptions().normalizeDepth,a={exception:{values:[{type:ne(e)?e.constructor.name:i?"UnhandledRejection":"Error",value:`Non-Error ${i?"promise rejection":"exception"} captured with keys: ${$e(e)}`}]},extra:{__serialized__:Le(e,s)}};if(n){const e=ci(t,n);e.length&&(a.exception.values[0].stacktrace={frames:e})}return a}(t,e,n,r),cn(s,{synthetic:!0}),s):(s=pi(t,e,n,i),ln(s,`${e}`,void 0),cn(s,{synthetic:!0}),s)}function pi(t,e,n,i){const r={message:e};if(i&&n){const i=ci(t,n);i.length&&(r.exception={values:[{value:e,stacktrace:{frames:i}}]})}return r}const mi=["fatal","error","warning","log","info","debug"];function fi(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",i=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],relative:e[5]+n+i}}const gi=1024,_i="Breadcrumbs";class yi{static __initStatic(){this.id=_i}__init(){this.name=yi.id}constructor(t){yi.prototype.__init.call(this),this.options={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t}}setupOnce(){var t;this.options.console&&Yn("console",vi),this.options.dom&&Yn("dom",(t=this.options.dom,function(e){let n,i="object"==typeof t?t.serializeAttribute:void 0,r="object"==typeof t&&"number"==typeof t.maxStringLength?t.maxStringLength:void 0;r&&r>gi&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn(`\`dom.maxStringLength\` cannot exceed ${gi}, but a value of ${r} was configured. Sentry will use ${gi} instead.`),r=gi),"string"==typeof i&&(i=[i]);try{n=e.event.target?fe(e.event.target,{keyAttrs:i,maxStringLength:r}):fe(e.event,{keyAttrs:i,maxStringLength:r})}catch(t){n="<unknown>"}0!==n.length&&Sn().addBreadcrumb({category:`ui.${e.name}`,message:n},{event:e.event,name:e.name,global:e.global})})),this.options.xhr&&Yn("xhr",bi),this.options.fetch&&Yn("fetch",wi),this.options.history&&Yn("history",Ei)}addSentryBreadcrumb(t){this.options.sentry&&Sn().addBreadcrumb({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:on(t)},{event:t})}}function vi(t){for(let e=0;e<t.args.length;e++)if("ref=Ref<"===t.args[e]){t.args[e+1]="viewRef";break}const e={category:"console",data:{arguments:t.args,logger:"console"},level:(n=t.level,"warn"===n?"warning":mi.includes(n)?n:"log"),message:ye(t.args," ")};var n;if("assert"===t.level){if(!1!==t.args[0])return;e.message=`Assertion failed: ${ye(t.args.slice(1)," ")||"console.assert"}`,e.data.arguments=t.args.slice(1)}Sn().addBreadcrumb(e,{input:t.args,level:t.level})}function bi(t){if(t.endTimestamp){if(t.xhr.__sentry_own_request__)return;const{method:e,url:n,status_code:i,body:r}=t.xhr.__sentry_xhr__||{};Sn().addBreadcrumb({category:"xhr",data:{method:e,url:n,status_code:i},type:"http"},{xhr:t.xhr,input:r})}}function wi(t){t.endTimestamp&&(t.fetchData.url.match(/sentry_key/)&&"POST"===t.fetchData.method||(t.error?Sn().addBreadcrumb({category:"fetch",data:t.fetchData,level:"error",type:"http"},{data:t.error,input:t.args}):Sn().addBreadcrumb({category:"fetch",data:{...t.fetchData,status_code:t.response.status},type:"http"},{input:t.args,response:t.response})))}function Ei(t){let e=t.from,n=t.to;const i=fi($n.location.href);let r=fi(e);const s=fi(n);r.path||(r=i),i.protocol===s.protocol&&i.host===s.host&&(n=s.relative),i.protocol===r.protocol&&i.host===r.host&&(e=r.relative),Sn().addBreadcrumb({category:"navigation",data:{from:e,to:n}})}yi.__initStatic();class Si extends ii{constructor(t){t._metadata=t._metadata||{},t._metadata.sdk=t._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:"npm:@sentry/browser",version:ai}],version:ai},super(t),t.sendClientReports&&$n.document&&$n.document.addEventListener("visibilitychange",(()=>{"hidden"===$n.document.visibilityState&&this._flushOutcomes()}))}eventFromException(t,e){return function(t,e,n,i){const r=di(t,e,n&&n.syntheticException||void 0,i);return cn(r),r.level="error",n&&n.event_id&&(r.event_id=n.event_id),ae(r)}(this._options.stackParser,t,e,this._options.attachStacktrace)}eventFromMessage(t,e="info",n){return function(t,e,n="info",i,r){const s=pi(t,e,i&&i.syntheticException||void 0,r);return s.level=n,i&&i.event_id&&(s.event_id=i.event_id),ae(s)}(this._options.stackParser,t,e,n,this._options.attachStacktrace)}sendEvent(t,e){!function(t){let e,n=t[0],i=1;for(;i<t.length;){const r=t[i],s=t[i+1];if(i+=2,("optionalAccess"===r||"optionalCall"===r)&&null==n)return;"access"===r||"optionalAccess"===r?(e=n,n=s(n)):"call"!==r&&"optionalCall"!==r||(n=s(((...t)=>n.call(e,...t))),e=void 0)}}([this.getIntegrationById(_i),"optionalAccess",t=>t.addSentryBreadcrumb,"optionalCall",e=>e(t)]),super.sendEvent(t,e)}_prepareEvent(t,e,n){return t.platform=t.platform||"javascript",super._prepareEvent(t,e,n)}_flushOutcomes(){const t=this._clearOutcomes();if(0===t.length)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.log("No outcomes to send"));if(!this._dsn)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.log("No dsn provided, will not send outcomes"));("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.log("Sending outcomes:",t);const e=ei(this._dsn,this._options),n=(i=t,Ue((r=this._options.tunnel&&ue(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:(0,dn.yW)(),discarded_events:i}]]));var i,r;try{"[object Navigator]"===Object.prototype.toString.call($n&&$n.navigator)&&"function"==typeof $n.navigator.sendBeacon&&!this._options.transportOptions?$n.navigator.sendBeacon.bind($n.navigator)(e,Ge(n)):this._sendEnvelope(n)}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.error(t)}}}const xi="?";function ki(t,e,n,i){const r={filename:t,function:e,in_app:!0};return void 0!==n&&(r.lineno=n),void 0!==i&&(r.colno=i),r}const Ti=/^\s*at (?:(.*\).*?|.*?) ?\((?:address at )?)?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,$i=/\((\S*)(?::(\d+))(?::(\d+))\)/,Ni=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension|safari-extension|safari-web-extension|capacitor)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Ii=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Ri=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Ai=Ae([30,t=>{const e=Ti.exec(t);if(e){if(e[2]&&0===e[2].indexOf("eval")){const t=$i.exec(e[2]);t&&(e[2]=t[1],e[3]=t[2],e[4]=t[3])}const[t,n]=Ci(e[1]||xi,e[2]);return ki(n,t,e[3]?+e[3]:void 0,e[4]?+e[4]:void 0)}}],[50,t=>{const e=Ni.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const t=Ii.exec(e[3]);t&&(e[1]=e[1]||"eval",e[3]=t[1],e[4]=t[2],e[5]="")}let t=e[3],n=e[1]||xi;return[n,t]=Ci(n,t),ki(t,n,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}],[40,t=>{const e=Ri.exec(t);return e?ki(e[2],e[1]||xi,+e[3],e[4]?+e[4]:void 0):void 0}]),Ci=(t,e)=>{const n=-1!==t.indexOf("safari-extension"),i=-1!==t.indexOf("safari-web-extension");return n||i?[-1!==t.indexOf("@")?t.split("@")[0]:xi,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},Pi=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];class Oi{static __initStatic(){this.id="TryCatch"}__init(){this.name=Oi.id}constructor(t){Oi.prototype.__init.call(this),this._options={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t}}setupOnce(){this._options.setTimeout&&be($n,"setTimeout",Li),this._options.setInterval&&be($n,"setInterval",Li),this._options.requestAnimationFrame&&be($n,"requestAnimationFrame",Di),this._options.XMLHttpRequest&&"XMLHttpRequest"in $n&&be(XMLHttpRequest.prototype,"send",Ui);const t=this._options.eventTarget;t&&(Array.isArray(t)?t:Pi).forEach(Mi)}}function Li(t){return function(...e){const n=e[0];return e[0]=An(n,{mechanism:{data:{function:Pe(t)},handled:!0,type:"instrument"}}),t.apply(this,e)}}function Di(t){return function(e){return t.apply(this,[An(e,{mechanism:{data:{function:"requestAnimationFrame",handler:Pe(t)},handled:!0,type:"instrument"}})])}}function Ui(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((t=>{t in n&&"function"==typeof n[t]&&be(n,t,(function(e){const n={mechanism:{data:{function:t,handler:Pe(e)},handled:!0,type:"instrument"}},i=Se(e);return i&&(n.mechanism.data.handler=Pe(i)),An(e,n)}))})),t.apply(this,e)}}function Mi(t){const e=$n,n=e[t]&&e[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(be(n,"addEventListener",(function(e){return function(n,i,r){try{"function"==typeof i.handleEvent&&(i.handleEvent=An(i.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Pe(i),target:t},handled:!0,type:"instrument"}}))}catch(t){}return e.apply(this,[n,An(i,{mechanism:{data:{function:"addEventListener",handler:Pe(i),target:t},handled:!0,type:"instrument"}}),r])}})),be(n,"removeEventListener",(function(t){return function(e,n,i){const r=n;try{const n=r&&r.__sentry_wrapped__;n&&t.call(this,e,n,i)}catch(t){}return t.call(this,e,r,i)}})))}Oi.__initStatic();class ji{static __initStatic(){this.id="GlobalHandlers"}__init(){this.name=ji.id}__init2(){this._installFunc={onerror:Bi,onunhandledrejection:Gi}}constructor(t){ji.prototype.__init.call(this),ji.prototype.__init2.call(this),this._options={onerror:!0,onunhandledrejection:!0,...t}}setupOnce(){Error.stackTraceLimit=50;const t=this._options;for(const n in t){const i=this._installFunc[n];i&&t[n]&&(e=n,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.log(`Global Handler attached: ${e}`),i(),this._installFunc[n]=void 0)}var e}}function Bi(){Yn("error",(t=>{const[e,n,i]=Wi();if(!e.getIntegration(ji))return;const{msg:r,url:s,line:a,column:o,error:l}=t;if(Rn()||l&&l.__sentry_own_request__)return;const c=void 0===l&&Qt(r)?function(t,e,n,i){let r=Xt(t)?t.message:t,s="Error";const a=r.match(/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i);a&&(s=a[1],r=a[2]);return Fi({exception:{values:[{type:s,value:r}]}},e,n,i)}(r,s,a,o):Fi(di(n,l||r,void 0,i,!1),s,a,o);c.level="error",Yi(e,l,c,"onerror")}))}function Gi(){Yn("unhandledrejection",(t=>{const[e,n,i]=Wi();if(!e.getIntegration(ji))return;let r=t;try{"reason"in t?r=t.reason:"detail"in t&&"reason"in t.detail&&(r=t.detail.reason)}catch(t){}if(Rn()||r&&r.__sentry_own_request__)return!0;const s=te(r)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(r)}`}]}}:di(n,r,void 0,i,!0);s.level="error",Yi(e,r,s,"onunhandledrejection")}))}function Fi(t,e,n,i){const r=t.exception=t.exception||{},s=r.values=r.values||[],a=s[0]=s[0]||{},o=a.stacktrace=a.stacktrace||{},l=o.frames=o.frames||[],c=isNaN(parseInt(i,10))?void 0:i,u=isNaN(parseInt(n,10))?void 0:n,h=Qt(e)&&e.length>0?e:function(){try{return pe.document.location.href}catch(t){return""}}();return 0===l.length&&l.push({colno:c,filename:h,function:"?",in_app:!0,lineno:u}),t}function Yi(t,e,n,i){cn(n,{handled:!1,type:i}),t.captureEvent(n,{originalException:e})}function Wi(){const t=Sn(),e=t.getClient(),n=e&&e.getOptions()||{stackParser:()=>[],attachStacktrace:!1};return[t,n.stackParser,n.attachStacktrace]}ji.__initStatic();class qi{static __initStatic(){this.id="LinkedErrors"}__init(){this.name=qi.id}constructor(t={}){qi.prototype.__init.call(this),this._key=t.key||"cause",this._limit=t.limit||5}setupOnce(){const t=Sn().getClient();t&&_n(((e,n)=>{const i=Sn().getIntegration(qi);return i?function(t,e,n,i,r){if(!(i.exception&&i.exception.values&&r&&re(r.originalException,Error)))return i;const s=Hi(t,n,r.originalException,e);return i.exception.values=[...s,...i.exception.values],i}(t.getOptions().stackParser,i._key,i._limit,e,n):e}))}}function Hi(t,e,n,i,r=[]){if(!re(n[i],Error)||r.length+1>=e)return r;const s=oi(t,n[i]);return Hi(t,e,n[i],i,[s,...r])}qi.__initStatic();class zi{constructor(){zi.prototype.__init.call(this)}static __initStatic(){this.id="Dedupe"}__init(){this.name=zi.id}setupOnce(t,e){const n=t=>{const n=e().getIntegration(zi);if(n){try{if(function(t,e){return!!e&&(!!function(t,e){const n=t.message,i=e.message;return!(!n&&!i)&&(!(n&&!i||!n&&i)&&(n===i&&(!!Vi(t,e)&&!!Ki(t,e))))}(t,e)||!!function(t,e){const n=Ji(e),i=Ji(t);return!(!n||!i)&&(n.type===i.type&&n.value===i.value&&(!!Vi(t,e)&&!!Ki(t,e)))}(t,e))}(t,n._previousEvent))return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(e){return n._previousEvent=t}return n._previousEvent=t}return t};n.id=this.name,t(n)}}function Ki(t,e){let n=Xi(t),i=Xi(e);if(!n&&!i)return!0;if(n&&!i||!n&&i)return!1;if(i.length!==n.length)return!1;for(let t=0;t<i.length;t++){const e=i[t],r=n[t];if(e.filename!==r.filename||e.lineno!==r.lineno||e.colno!==r.colno||e.function!==r.function)return!1}return!0}function Vi(t,e){let n=t.fingerprint,i=e.fingerprint;if(!n&&!i)return!0;if(n&&!i||!n&&i)return!1;try{return!(n.join("")!==i.join(""))}catch(t){return!1}}function Ji(t){return t.exception&&t.exception.values&&t.exception.values[0]}function Xi(t){const e=t.exception;if(e)try{return e.values[0].stacktrace.frames}catch(t){return}}zi.__initStatic();class Zi{constructor(){Zi.prototype.__init.call(this)}static __initStatic(){this.id="HttpContext"}__init(){this.name=Zi.id}setupOnce(){_n((t=>{if(Sn().getIntegration(Zi)){if(!$n.navigator&&!$n.location&&!$n.document)return t;const e=t.request&&t.request.url||$n.location&&$n.location.href,{referrer:n}=$n.document||{},{userAgent:i}=$n.navigator||{},r={...e&&{url:e},headers:{...t.request&&t.request.headers,...n&&{Referer:n},...i&&{"User-Agent":i}}};return{...t,request:r}}return t}))}}Zi.__initStatic();const Qi=4;function tr(t){return Qe(t,(function(e){return new le(((n,i)=>{const r=new XMLHttpRequest;r.onerror=i,r.onreadystatechange=()=>{r.readyState===Qi&&n({statusCode:r.status,headers:{"x-sentry-rate-limits":r.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":r.getResponseHeader("Retry-After")}})},r.open("POST",t.url);for(const e in t.headers)Object.prototype.hasOwnProperty.call(t.headers,e)&&r.setRequestHeader(e,t.headers[e]);r.send(e.body)}))}))}const er=[new On,new Un,new Oi,new yi,new ji,new qi,new zi,new Zi];function nr(t){t.startSession({ignoreDuration:!0}),t.captureSession()}let ir={};$n.Sentry&&$n.Sentry.Integrations&&(ir=$n.Sentry.Integrations);const rr={...ir,...t,...s};var sr=n(58339),ar=n(9e4),or=n(9375),lr=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(a,o)}l((i=i.apply(t,e||[])).next())}))};const cr=t=>t.replace(/(webpack_require__@)?(moz|chrome)-extension:\/\/[^/]+\//,"~/");function ur(t,e){return Cn(t,((t,e)=>{var n;const i={status:200,headers:{get:t=>""}};return sr.request.xhr(null!==(n=e.method)&&void 0!==n?n:"GET",{url:t,data:e.body}).catch((t=>(i.status=429,i))).then((t=>i))}))}var hr=n(58339),dr=n(9e4);let pr;!function(){lr(this,void 0,void 0,(function*(){var t;(yield sr.settings.getAsync("crashReport"))?or.isDomainMatching(window.location.href,"wakanim.tv")&&or.isFirefox()?ar.info("Crash reports disabled for wakanim.tv"):or.isDomainMatching(window.location.href,"simkl.com")&&or.isFirefox()?ar.info("Crash reports disabled for simkl.com"):(function(t={}){void 0===t.defaultIntegrations&&(t.defaultIntegrations=er),void 0===t.release&&("string"==typeof __SENTRY_RELEASE__&&(t.release=__SENTRY_RELEASE__),$n.SENTRY_RELEASE&&$n.SENTRY_RELEASE.id&&(t.release=$n.SENTRY_RELEASE.id)),void 0===t.autoSessionTracking&&(t.autoSessionTracking=!0),void 0===t.sendClientReports&&(t.sendClientReports=!0);const e={...t,stackParser:(n=t.stackParser||Ai,Array.isArray(n)?Ae(...n):n),integrations:jn(t),transport:t.transport||(nn()?Cn:tr)};var n;!function(t,e){!0===e.debug&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?Xe.enable():console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle."));const n=Sn(),i=n.getScope();i&&i.update(e.initialScope);const r=new t(e);n.bindClient(r)}(Si,e),t.autoSessionTracking&&function(){if(void 0===$n.document)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&Xe.warn("Session tracking in non-browser environment with @sentry/browser is not supported."));const t=Sn();t.captureSession&&(nr(t),Yn("history",(({from:t,to:e})=>{void 0!==t&&t!==e&&nr(Sn())})))}()}({dsn:"https://blood@shark.malsync.moe/1337",tunnel:"https://api.malsync.moe/shark",transport:ur,release:`malsync@${sr.storage.version()}`,integrations:[new rr.Breadcrumbs({console:!1,dom:!1}),new rr.GlobalHandlers({onerror:!1,onunhandledrejection:!1})],environment:"production",autoSessionTracking:!1,ignoreErrors:["SafeError"]}),t=t=>{t.addEventProcessor((t=>lr(this,void 0,void 0,(function*(){return t.culprit&&(t.culprit=cr(t.culprit)),t.exception&&t.exception.values&&t.exception.values[0]&&t.exception.values[0].stacktrace&&t.exception.values[0].stacktrace.frames&&(t.exception.values[0].stacktrace.frames=t.exception.values[0].stacktrace.frames.map((t=>(t.filename=cr(t.filename),t)))),t}))))},Sn().configureScope(t)):ar.info("Crash reports disabled")}))}(),console.log("%cMAL-Sync","font-size: 40px; padding-bottom: 3px; color: white; text-shadow: -1px -1px #2e51a2, 1px -1px #2e51a2, -1px 1px #2e51a2, 1px 1px #2e51a2, 2px 2px #2e51a2, 3px 3px #2e51a2;",`Version: ${hr.storage.version()}`),hr.settings.init().then((()=>{!function(){if(hr.settings.get("userscriptModeButton"))throw"Userscript mode";var t;t=new jt(window.location.href),chrome.runtime.onMessage.addListener((function(e,n,i){return"TabMalUrl"===e.action&&Date.now()-pr<3e3&&(dr.info("miniMAL"),t.getMalUrl().then((e=>{const n={url:e,image:t.getImage(),title:t.getTitle()};e||"KITSU"!==hr.settings.get("syncMode")||(n.url=t.url),i(n)})),!0)})),qt(),$(window).blur((function(){pr=Date.now()}))}()}))})()})();
//# sourceMappingURL=kitsu-script.js.map